# Generate Splunk evals for oshp-validator

https://github.com/oshp/oshp-validator


Using the Venom test suit from OSHP Generate SPL to run the same tests:

https://raw.githubusercontent.com/oshp/oshp-validator/refs/heads/main/tests_suite.yml


````
| eval headercheck.Cache-Control=mvappend('headercheck.Cache-Control', if('headers.cache-control' = "no-store, max-age=0", "headers.cache-control:should_be:no-store, max-age=0=pass", "headers.cache-control:should_be:no-store, max-age=0=fail"))
| eval headercheck.Cache-Control=mvappend('headercheck.Cache-Control', if('status' = "200", "status:should_be:200=pass", "status:should_be:200=fail"))
| eval headercheck.Cache-Control=mvappend('headercheck.Cache-Control', if(isnotnull('headers.cache-control'), "headers.cache-control:should_not_be_empty=pass", "headers.cache-control:should_not_be_empty=fail"))
| eval headercheck.Clear-Site-Data=mvappend('headercheck.Clear-Site-Data', if('headers.clear-site-data' = "\"cache\",\"cookies\",\"storage\"", "headers.clear-site-data:should_be:\"cache\",\"cookies\",\"storage\"=pass", "headers.clear-site-data:should_be:\"cache\",\"cookies\",\"storage\"=fail"))
| eval headercheck.Clear-Site-Data=mvappend('headercheck.Clear-Site-Data', if('status' = "200", "status:should_be:200=pass", "status:should_be:200=fail"))
| eval headercheck.Clear-Site-Data=mvappend('headercheck.Clear-Site-Data', if(isnotnull('headers.clear-site-data'), "headers.clear-site-data:should_not_be_empty=pass", "headers.clear-site-data:should_not_be_empty=fail"))
| eval headercheck.Content-Security-Policy=mvappend('headercheck.Content-Security-Policy', if('status' = "200", "status:should_be:200=pass", "status:should_be:200=fail"))
| eval headercheck.Content-Security-Policy=mvappend('headercheck.Content-Security-Policy', if(isnotnull('headers.content-security-policy'), "headers.content-security-policy:should_not_be_empty=pass", "headers.content-security-policy:should_not_be_empty=fail"))
| eval headercheck.Content-Security-Policy=mvappend('headercheck.Content-Security-Policy', if(NOT like('headers.content-security-policy', "%unsafe%"), "headers.content-security-policy:should_not_contain:unsafe=pass", "headers.content-security-policy:should_not_contain:unsafe=fail"))
| eval headercheck.Cross-Origin-Embedder-Policy=mvappend('headercheck.Cross-Origin-Embedder-Policy', if('headers.cross-origin-embedder-policy' = "require-corp", "headers.cross-origin-embedder-policy:should_be:require-corp=pass", "headers.cross-origin-embedder-policy:should_be:require-corp=fail"))
| eval headercheck.Cross-Origin-Embedder-Policy=mvappend('headercheck.Cross-Origin-Embedder-Policy', if('status' = "200", "status:should_be:200=pass", "status:should_be:200=fail"))
| eval headercheck.Cross-Origin-Embedder-Policy=mvappend('headercheck.Cross-Origin-Embedder-Policy', if(isnotnull('headers.cross-origin-embedder-policy'), "headers.cross-origin-embedder-policy:should_not_be_empty=pass", "headers.cross-origin-embedder-policy:should_not_be_empty=fail"))
| eval headercheck.Cross-Origin-Opener-Policy=mvappend('headercheck.Cross-Origin-Opener-Policy', if('headers.cross-origin-opener-policy' = "same-origin", "headers.cross-origin-opener-policy:should_be:same-origin=pass", "headers.cross-origin-opener-policy:should_be:same-origin=fail"))
| eval headercheck.Cross-Origin-Opener-Policy=mvappend('headercheck.Cross-Origin-Opener-Policy', if('status' = "200", "status:should_be:200=pass", "status:should_be:200=fail"))
| eval headercheck.Cross-Origin-Opener-Policy=mvappend('headercheck.Cross-Origin-Opener-Policy', if(isnotnull('headers.cross-origin-opener-policy'), "headers.cross-origin-opener-policy:should_not_be_empty=pass", "headers.cross-origin-opener-policy:should_not_be_empty=fail"))
| eval headercheck.Cross-Origin-Resource-Policy=mvappend('headercheck.Cross-Origin-Resource-Policy', if('headers.cross-origin-resource-policy' = "same-origin", "headers.cross-origin-resource-policy:should_be:same-origin=pass", "headers.cross-origin-resource-policy:should_be:same-origin=fail"))
| eval headercheck.Cross-Origin-Resource-Policy=mvappend('headercheck.Cross-Origin-Resource-Policy', if('status' = "200", "status:should_be:200=pass", "status:should_be:200=fail"))
| eval headercheck.Cross-Origin-Resource-Policy=mvappend('headercheck.Cross-Origin-Resource-Policy', if(isnotnull('headers.cross-origin-resource-policy'), "headers.cross-origin-resource-policy:should_not_be_empty=pass", "headers.cross-origin-resource-policy:should_not_be_empty=fail"))
| eval headercheck.Expect-CT=mvappend('headercheck.Expect-CT', if('status' = "200", "status:should_be:200=pass", "status:should_be:200=fail"))
| eval headercheck.Expect-CT=mvappend('headercheck.Expect-CT', if(isnull('headers.expect-ct'), "headers.expect-ct:should_be_empty=pass", "headers.expect-ct:should_be_empty=fail"))
| eval headercheck.Feature-Policy=mvappend('headercheck.Feature-Policy', if('status' = "200", "status:should_be:200=pass", "status:should_be:200=fail"))
| eval headercheck.Feature-Policy=mvappend('headercheck.Feature-Policy', if(isnull('headers.feature-policy'), "headers.feature-policy:should_be_empty=pass", "headers.feature-policy:should_be_empty=fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if('status' = "200", "status:should_be:200=pass", "status:should_be:200=fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if(isnotnull('headers.permissions-policy'), "headers.permissions-policy:should_not_be_empty=pass", "headers.permissions-policy:should_not_be_empty=fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if(like('headers.permissions-policy', "%accelerometer=%"), "headers.permissions-policy:should_contain:accelerometer==pass", "headers.permissions-policy:should_contain:accelerometer==fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if(like('headers.permissions-policy', "%autoplay=%"), "headers.permissions-policy:should_contain:autoplay==pass", "headers.permissions-policy:should_contain:autoplay==fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if(like('headers.permissions-policy', "%camera=%"), "headers.permissions-policy:should_contain:camera==pass", "headers.permissions-policy:should_contain:camera==fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if(like('headers.permissions-policy', "%clipboard-read=%"), "headers.permissions-policy:should_contain:clipboard-read==pass", "headers.permissions-policy:should_contain:clipboard-read==fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if(like('headers.permissions-policy', "%clipboard-write=%"), "headers.permissions-policy:should_contain:clipboard-write==pass", "headers.permissions-policy:should_contain:clipboard-write==fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if(like('headers.permissions-policy', "%cross-origin-isolated=%"), "headers.permissions-policy:should_contain:cross-origin-isolated==pass", "headers.permissions-policy:should_contain:cross-origin-isolated==fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if(like('headers.permissions-policy', "%display-capture=%"), "headers.permissions-policy:should_contain:display-capture==pass", "headers.permissions-policy:should_contain:display-capture==fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if(like('headers.permissions-policy', "%encrypted-media=%"), "headers.permissions-policy:should_contain:encrypted-media==pass", "headers.permissions-policy:should_contain:encrypted-media==fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if(like('headers.permissions-policy', "%fullscreen=%"), "headers.permissions-policy:should_contain:fullscreen==pass", "headers.permissions-policy:should_contain:fullscreen==fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if(like('headers.permissions-policy', "%gamepad=%"), "headers.permissions-policy:should_contain:gamepad==pass", "headers.permissions-policy:should_contain:gamepad==fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if(like('headers.permissions-policy', "%geolocation=%"), "headers.permissions-policy:should_contain:geolocation==pass", "headers.permissions-policy:should_contain:geolocation==fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if(like('headers.permissions-policy', "%gyroscope=%"), "headers.permissions-policy:should_contain:gyroscope==pass", "headers.permissions-policy:should_contain:gyroscope==fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if(like('headers.permissions-policy', "%hid=%"), "headers.permissions-policy:should_contain:hid==pass", "headers.permissions-policy:should_contain:hid==fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if(like('headers.permissions-policy', "%idle-detection=%"), "headers.permissions-policy:should_contain:idle-detection==pass", "headers.permissions-policy:should_contain:idle-detection==fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if(like('headers.permissions-policy', "%interest-cohort=%"), "headers.permissions-policy:should_contain:interest-cohort==pass", "headers.permissions-policy:should_contain:interest-cohort==fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if(like('headers.permissions-policy', "%keyboard-map=%"), "headers.permissions-policy:should_contain:keyboard-map==pass", "headers.permissions-policy:should_contain:keyboard-map==fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if(like('headers.permissions-policy', "%magnetometer=%"), "headers.permissions-policy:should_contain:magnetometer==pass", "headers.permissions-policy:should_contain:magnetometer==fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if(like('headers.permissions-policy', "%microphone=%"), "headers.permissions-policy:should_contain:microphone==pass", "headers.permissions-policy:should_contain:microphone==fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if(like('headers.permissions-policy', "%midi=%"), "headers.permissions-policy:should_contain:midi==pass", "headers.permissions-policy:should_contain:midi==fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if(like('headers.permissions-policy', "%payment=%"), "headers.permissions-policy:should_contain:payment==pass", "headers.permissions-policy:should_contain:payment==fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if(like('headers.permissions-policy', "%picture-in-picture=%"), "headers.permissions-policy:should_contain:picture-in-picture==pass", "headers.permissions-policy:should_contain:picture-in-picture==fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if(like('headers.permissions-policy', "%publickey-credentials-get=%"), "headers.permissions-policy:should_contain:publickey-credentials-get==pass", "headers.permissions-policy:should_contain:publickey-credentials-get==fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if(like('headers.permissions-policy', "%screen-wake-lock=%"), "headers.permissions-policy:should_contain:screen-wake-lock==pass", "headers.permissions-policy:should_contain:screen-wake-lock==fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if(like('headers.permissions-policy', "%serial=%"), "headers.permissions-policy:should_contain:serial==pass", "headers.permissions-policy:should_contain:serial==fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if(like('headers.permissions-policy', "%sync-xhr=self%") OR like('headers.permissions-policy', "%sync-xhr=%"), "headers.permissions-policy:should_contain:sync-xhr=self_OR_headers.permissions-policy:should_contain:sync-xhr==pass", "headers.permissions-policy:should_contain:sync-xhr=self_OR_headers.permissions-policy:should_contain:sync-xhr==fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if(like('headers.permissions-policy', "%unload=%"), "headers.permissions-policy:should_contain:unload==pass", "headers.permissions-policy:should_contain:unload==fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if(like('headers.permissions-policy', "%usb=%"), "headers.permissions-policy:should_contain:usb==pass", "headers.permissions-policy:should_contain:usb==fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if(like('headers.permissions-policy', "%web-share=%"), "headers.permissions-policy:should_contain:web-share==pass", "headers.permissions-policy:should_contain:web-share==fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if(like('headers.permissions-policy', "%xr-spatial-tracking=%"), "headers.permissions-policy:should_contain:xr-spatial-tracking==pass", "headers.permissions-policy:should_contain:xr-spatial-tracking==fail"))
| eval headercheck.Public-Key-Pins=mvappend('headercheck.Public-Key-Pins', if('status' = "200", "status:should_be:200=pass", "status:should_be:200=fail"))
| eval headercheck.Public-Key-Pins=mvappend('headercheck.Public-Key-Pins', if(isnull('headers.public-key-pins'), "headers.public-key-pins:should_be_empty=pass", "headers.public-key-pins:should_be_empty=fail"))
| eval headercheck.Referrer-Policy=mvappend('headercheck.Referrer-Policy', if('headers.referrer-policy' = "no-referrer", "headers.referrer-policy:should_be:no-referrer=pass", "headers.referrer-policy:should_be:no-referrer=fail"))
| eval headercheck.Referrer-Policy=mvappend('headercheck.Referrer-Policy', if('status' = "200", "status:should_be:200=pass", "status:should_be:200=fail"))
| eval headercheck.Referrer-Policy=mvappend('headercheck.Referrer-Policy', if(isnotnull('headers.referrer-policy'), "headers.referrer-policy:should_not_be_empty=pass", "headers.referrer-policy:should_not_be_empty=fail"))
| eval headercheck.Strict-Transport-Security=mvappend('headercheck.Strict-Transport-Security', if('headers.strict-transport-security' = "max-age=31536000; includeSubDomains" OR 'headers.strict-transport-security' = "max-age=31536000; includeSubDomains; preload", "headers.strict-transport-security:should_be:max-age=31536000; includeSubDomains_OR_headers.strict-transport-security:should_be:max-age=31536000; includeSubDomains; preload=pass", "headers.strict-transport-security:should_be:max-age=31536000; includeSubDomains_OR_headers.strict-transport-security:should_be:max-age=31536000; includeSubDomains; preload=fail"))
| eval headercheck.Strict-Transport-Security=mvappend('headercheck.Strict-Transport-Security', if('status' = "200", "status:should_be:200=pass", "status:should_be:200=fail"))
| eval headercheck.Strict-Transport-Security=mvappend('headercheck.Strict-Transport-Security', if(isnotnull('headers.strict-transport-security'), "headers.strict-transport-security:should_not_be_empty=pass", "headers.strict-transport-security:should_not_be_empty=fail"))
| eval headercheck.X-Content-Type-Options=mvappend('headercheck.X-Content-Type-Options', if('headers.x-content-type-options' = "nosniff", "headers.x-content-type-options:should_be:nosniff=pass", "headers.x-content-type-options:should_be:nosniff=fail"))
| eval headercheck.X-Content-Type-Options=mvappend('headercheck.X-Content-Type-Options', if('status' = "200", "status:should_be:200=pass", "status:should_be:200=fail"))
| eval headercheck.X-Content-Type-Options=mvappend('headercheck.X-Content-Type-Options', if(isnotnull('headers.x-content-type-options'), "headers.x-content-type-options:should_not_be_empty=pass", "headers.x-content-type-options:should_not_be_empty=fail"))
| eval headercheck.X-DNS-Prefetch-Control=mvappend('headercheck.X-DNS-Prefetch-Control', if('headers.x-dns-prefetch-control' = "off", "headers.x-dns-prefetch-control:should_be:off=pass", "headers.x-dns-prefetch-control:should_be:off=fail"))
| eval headercheck.X-DNS-Prefetch-Control=mvappend('headercheck.X-DNS-Prefetch-Control', if('status' = "200", "status:should_be:200=pass", "status:should_be:200=fail"))
| eval headercheck.X-DNS-Prefetch-Control=mvappend('headercheck.X-DNS-Prefetch-Control', if(isnotnull('headers.x-dns-prefetch-control'), "headers.x-dns-prefetch-control:should_not_be_empty=pass", "headers.x-dns-prefetch-control:should_not_be_empty=fail"))
| eval headercheck.X-Frame-Options=mvappend('headercheck.X-Frame-Options', if('status' = "200", "status:should_be:200=pass", "status:should_be:200=fail"))
| eval headercheck.X-Frame-Options=mvappend('headercheck.X-Frame-Options', if(in('headers.x-frame-options', "deny", "DENY"), "headers.x-frame-options:should_be:deny_OR_DENY=pass", "headers.x-frame-options:should_be:deny_OR_DENY=fail"))
| eval headercheck.X-Frame-Options=mvappend('headercheck.X-Frame-Options', if(isnotnull('headers.x-frame-options'), "headers.x-frame-options:should_not_be_empty=pass", "headers.x-frame-options:should_not_be_empty=fail"))
| eval headercheck.X-Permitted-Cross-Domain-Policies=mvappend('headercheck.X-Permitted-Cross-Domain-Policies', if('headers.x-permitted-cross-domain-policies' = "none", "headers.x-permitted-cross-domain-policies:should_be:none=pass", "headers.x-permitted-cross-domain-policies:should_be:none=fail"))
| eval headercheck.X-Permitted-Cross-Domain-Policies=mvappend('headercheck.X-Permitted-Cross-Domain-Policies', if('status' = "200", "status:should_be:200=pass", "status:should_be:200=fail"))
| eval headercheck.X-Permitted-Cross-Domain-Policies=mvappend('headercheck.X-Permitted-Cross-Domain-Policies', if(isnotnull('headers.x-permitted-cross-domain-policies'), "headers.x-permitted-cross-domain-policies:should_not_be_empty=pass", "headers.x-permitted-cross-domain-policies:should_not_be_empty=fail"))
| eval headercheck.X-XSS-Protection=mvappend('headercheck.X-XSS-Protection', if('status' = "200", "status:should_be:200=pass", "status:should_be:200=fail"))
| eval headercheck.X-XSS-Protection=mvappend('headercheck.X-XSS-Protection', if(isnull('headers.x-xss-protection'), "headers.x-xss-protection:should_be_empty=pass", "headers.x-xss-protection:should_be_empty=fail"))| eval headercheck.Cache-Control=mvappend('headercheck.Cache-Control', if('headers.cache-control' = "no-store, max-age=0", "headers.cache-control:should_be:no-store, max-age=0=pass", "headers.cache-control:should_be:no-store, max-age=0=fail"))
| eval headercheck.Cache-Control=mvappend('headercheck.Cache-Control', if('status' = "200", "status:should_be:200=pass", "status:should_be:200=fail"))
| eval headercheck.Cache-Control=mvappend('headercheck.Cache-Control', if(isnotnull('headers.cache-control'), "headers.cache-control:should_not_be_empty=pass", "headers.cache-control:should_not_be_empty=fail"))
| eval headercheck.Clear-Site-Data=mvappend('headercheck.Clear-Site-Data', if('headers.clear-site-data' = "\"cache\",\"cookies\",\"storage\"", "headers.clear-site-data:should_be:\"cache\",\"cookies\",\"storage\"=pass", "headers.clear-site-data:should_be:\"cache\",\"cookies\",\"storage\"=fail"))
| eval headercheck.Clear-Site-Data=mvappend('headercheck.Clear-Site-Data', if('status' = "200", "status:should_be:200=pass", "status:should_be:200=fail"))
| eval headercheck.Clear-Site-Data=mvappend('headercheck.Clear-Site-Data', if(isnotnull('headers.clear-site-data'), "headers.clear-site-data:should_not_be_empty=pass", "headers.clear-site-data:should_not_be_empty=fail"))
| eval headercheck.Content-Security-Policy=mvappend('headercheck.Content-Security-Policy', if('status' = "200", "status:should_be:200=pass", "status:should_be:200=fail"))
| eval headercheck.Content-Security-Policy=mvappend('headercheck.Content-Security-Policy', if(isnotnull('headers.content-security-policy'), "headers.content-security-policy:should_not_be_empty=pass", "headers.content-security-policy:should_not_be_empty=fail"))
| eval headercheck.Content-Security-Policy=mvappend('headercheck.Content-Security-Policy', if(NOT like('headers.content-security-policy', "%unsafe%"), "headers.content-security-policy:should_not_contain:unsafe=pass", "headers.content-security-policy:should_not_contain:unsafe=fail"))
| eval headercheck.Cross-Origin-Embedder-Policy=mvappend('headercheck.Cross-Origin-Embedder-Policy', if('headers.cross-origin-embedder-policy' = "require-corp", "headers.cross-origin-embedder-policy:should_be:require-corp=pass", "headers.cross-origin-embedder-policy:should_be:require-corp=fail"))
| eval headercheck.Cross-Origin-Embedder-Policy=mvappend('headercheck.Cross-Origin-Embedder-Policy', if('status' = "200", "status:should_be:200=pass", "status:should_be:200=fail"))
| eval headercheck.Cross-Origin-Embedder-Policy=mvappend('headercheck.Cross-Origin-Embedder-Policy', if(isnotnull('headers.cross-origin-embedder-policy'), "headers.cross-origin-embedder-policy:should_not_be_empty=pass", "headers.cross-origin-embedder-policy:should_not_be_empty=fail"))
| eval headercheck.Cross-Origin-Opener-Policy=mvappend('headercheck.Cross-Origin-Opener-Policy', if('headers.cross-origin-opener-policy' = "same-origin", "headers.cross-origin-opener-policy:should_be:same-origin=pass", "headers.cross-origin-opener-policy:should_be:same-origin=fail"))
| eval headercheck.Cross-Origin-Opener-Policy=mvappend('headercheck.Cross-Origin-Opener-Policy', if('status' = "200", "status:should_be:200=pass", "status:should_be:200=fail"))
| eval headercheck.Cross-Origin-Opener-Policy=mvappend('headercheck.Cross-Origin-Opener-Policy', if(isnotnull('headers.cross-origin-opener-policy'), "headers.cross-origin-opener-policy:should_not_be_empty=pass", "headers.cross-origin-opener-policy:should_not_be_empty=fail"))
| eval headercheck.Cross-Origin-Resource-Policy=mvappend('headercheck.Cross-Origin-Resource-Policy', if('headers.cross-origin-resource-policy' = "same-origin", "headers.cross-origin-resource-policy:should_be:same-origin=pass", "headers.cross-origin-resource-policy:should_be:same-origin=fail"))
| eval headercheck.Cross-Origin-Resource-Policy=mvappend('headercheck.Cross-Origin-Resource-Policy', if('status' = "200", "status:should_be:200=pass", "status:should_be:200=fail"))
| eval headercheck.Cross-Origin-Resource-Policy=mvappend('headercheck.Cross-Origin-Resource-Policy', if(isnotnull('headers.cross-origin-resource-policy'), "headers.cross-origin-resource-policy:should_not_be_empty=pass", "headers.cross-origin-resource-policy:should_not_be_empty=fail"))
| eval headercheck.Expect-CT=mvappend('headercheck.Expect-CT', if('status' = "200", "status:should_be:200=pass", "status:should_be:200=fail"))
| eval headercheck.Expect-CT=mvappend('headercheck.Expect-CT', if(isnull('headers.expect-ct'), "headers.expect-ct:should_be_empty=pass", "headers.expect-ct:should_be_empty=fail"))
| eval headercheck.Feature-Policy=mvappend('headercheck.Feature-Policy', if('status' = "200", "status:should_be:200=pass", "status:should_be:200=fail"))
| eval headercheck.Feature-Policy=mvappend('headercheck.Feature-Policy', if(isnull('headers.feature-policy'), "headers.feature-policy:should_be_empty=pass", "headers.feature-policy:should_be_empty=fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if('status' = "200", "status:should_be:200=pass", "status:should_be:200=fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if(isnotnull('headers.permissions-policy'), "headers.permissions-policy:should_not_be_empty=pass", "headers.permissions-policy:should_not_be_empty=fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if(like('headers.permissions-policy', "%accelerometer=%"), "headers.permissions-policy:should_contain:accelerometer==pass", "headers.permissions-policy:should_contain:accelerometer==fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if(like('headers.permissions-policy', "%autoplay=%"), "headers.permissions-policy:should_contain:autoplay==pass", "headers.permissions-policy:should_contain:autoplay==fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if(like('headers.permissions-policy', "%camera=%"), "headers.permissions-policy:should_contain:camera==pass", "headers.permissions-policy:should_contain:camera==fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if(like('headers.permissions-policy', "%clipboard-read=%"), "headers.permissions-policy:should_contain:clipboard-read==pass", "headers.permissions-policy:should_contain:clipboard-read==fail"))

| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if(like('headers.permissions-policy', "%clipboard-write=%"), "headers.permissions-policy:should_contain:clipboard-write==pass", "headers.permissions-policy:should_contain:clipboard-write==fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if(like('headers.permissions-policy', "%cross-origin-isolated=%"), "headers.permissions-policy:should_contain:cross-origin-isolated==pass", "headers.permissions-policy:should_contain:cross-origin-isolated==fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if(like('headers.permissions-policy', "%display-capture=%"), "headers.permissions-policy:should_contain:display-capture==pass", "headers.permissions-policy:should_contain:display-capture==fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if(like('headers.permissions-policy', "%encrypted-media=%"), "headers.permissions-policy:should_contain:encrypted-media==pass", "headers.permissions-policy:should_contain:encrypted-media==fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if(like('headers.permissions-policy', "%fullscreen=%"), "headers.permissions-policy:should_contain:fullscreen==pass", "headers.permissions-policy:should_contain:fullscreen==fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if(like('headers.permissions-policy', "%gamepad=%"), "headers.permissions-policy:should_contain:gamepad==pass", "headers.permissions-policy:should_contain:gamepad==fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if(like('headers.permissions-policy', "%geolocation=%"), "headers.permissions-policy:should_contain:geolocation==pass", "headers.permissions-policy:should_contain:geolocation==fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if(like('headers.permissions-policy', "%gyroscope=%"), "headers.permissions-policy:should_contain:gyroscope==pass", "headers.permissions-policy:should_contain:gyroscope==fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if(like('headers.permissions-policy', "%hid=%"), "headers.permissions-policy:should_contain:hid==pass", "headers.permissions-policy:should_contain:hid==fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if(like('headers.permissions-policy', "%idle-detection=%"), "headers.permissions-policy:should_contain:idle-detection==pass", "headers.permissions-policy:should_contain:idle-detection==fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if(like('headers.permissions-policy', "%interest-cohort=%"), "headers.permissions-policy:should_contain:interest-cohort==pass", "headers.permissions-policy:should_contain:interest-cohort==fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if(like('headers.permissions-policy', "%keyboard-map=%"), "headers.permissions-policy:should_contain:keyboard-map==pass", "headers.permissions-policy:should_contain:keyboard-map==fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if(like('headers.permissions-policy', "%magnetometer=%"), "headers.permissions-policy:should_contain:magnetometer==pass", "headers.permissions-policy:should_contain:magnetometer==fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if(like('headers.permissions-policy', "%microphone=%"), "headers.permissions-policy:should_contain:microphone==pass", "headers.permissions-policy:should_contain:microphone==fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if(like('headers.permissions-policy', "%midi=%"), "headers.permissions-policy:should_contain:midi==pass", "headers.permissions-policy:should_contain:midi==fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if(like('headers.permissions-policy', "%payment=%"), "headers.permissions-policy:should_contain:payment==pass", "headers.permissions-policy:should_contain:payment==fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if(like('headers.permissions-policy', "%picture-in-picture=%"), "headers.permissions-policy:should_contain:picture-in-picture==pass", "headers.permissions-policy:should_contain:picture-in-picture==fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if(like('headers.permissions-policy', "%publickey-credentials-get=%"), "headers.permissions-policy:should_contain:publickey-credentials-get==pass", "headers.permissions-policy:should_contain:publickey-credentials-get==fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if(like('headers.permissions-policy', "%screen-wake-lock=%"), "headers.permissions-policy:should_contain:screen-wake-lock==pass", "headers.permissions-policy:should_contain:screen-wake-lock==fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if(like('headers.permissions-policy', "%serial=%"), "headers.permissions-policy:should_contain:serial==pass", "headers.permissions-policy:should_contain:serial==fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if(like('headers.permissions-policy', "%sync-xhr=self%") OR like('headers.permissions-policy', "%sync-xhr=%"), "headers.permissions-policy:should_contain:sync-xhr=self_OR_headers.permissions-policy:should_contain:sync-xhr==pass", "headers.permissions-policy:should_contain:sync-xhr=self_OR_headers.permissions-policy:should_contain:sync-xhr==fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if(like('headers.permissions-policy', "%unload=%"), "headers.permissions-policy:should_contain:unload==pass", "headers.permissions-policy:should_contain:unload==fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if(like('headers.permissions-policy', "%usb=%"), "headers.permissions-policy:should_contain:usb==pass", "headers.permissions-policy:should_contain:usb==fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if(like('headers.permissions-policy', "%web-share=%"), "headers.permissions-policy:should_contain:web-share==pass", "headers.permissions-policy:should_contain:web-share==fail"))
| eval headercheck.Permissions-Policy=mvappend('headercheck.Permissions-Policy', if(like('headers.permissions-policy', "%xr-spatial-tracking=%"), "headers.permissions-policy:should_contain:xr-spatial-tracking==pass", "headers.permissions-policy:should_contain:xr-spatial-tracking==fail"))
| eval headercheck.Public-Key-Pins=mvappend('headercheck.Public-Key-Pins', if('status' = "200", "status:should_be:200=pass", "status:should_be:200=fail"))
| eval headercheck.Public-Key-Pins=mvappend('headercheck.Public-Key-Pins', if(isnull('headers.public-key-pins'), "headers.public-key-pins:should_be_empty=pass", "headers.public-key-pins:should_be_empty=fail"))
| eval headercheck.Referrer-Policy=mvappend('headercheck.Referrer-Policy', if('headers.referrer-policy' = "no-referrer", "headers.referrer-policy:should_be:no-referrer=pass", "headers.referrer-policy:should_be:no-referrer=fail"))
| eval headercheck.Referrer-Policy=mvappend('headercheck.Referrer-Policy', if('status' = "200", "status:should_be:200=pass", "status:should_be:200=fail"))
| eval headercheck.Referrer-Policy=mvappend('headercheck.Referrer-Policy', if(isnotnull('headers.referrer-policy'), "headers.referrer-policy:should_not_be_empty=pass", "headers.referrer-policy:should_not_be_empty=fail"))
| eval headercheck.Strict-Transport-Security=mvappend('headercheck.Strict-Transport-Security', if('headers.strict-transport-security' = "max-age=31536000; includeSubDomains" OR 'headers.strict-transport-security' = "max-age=31536000; includeSubDomains; preload", "headers.strict-transport-security:should_be:max-age=31536000; includeSubDomains_OR_headers.strict-transport-security:should_be:max-age=31536000; includeSubDomains; preload=pass", "headers.strict-transport-security:should_be:max-age=31536000; includeSubDomains_OR_headers.strict-transport-security:should_be:max-age=31536000; includeSubDomains; preload=fail"))
| eval headercheck.Strict-Transport-Security=mvappend('headercheck.Strict-Transport-Security', if('status' = "200", "status:should_be:200=pass", "status:should_be:200=fail"))
| eval headercheck.Strict-Transport-Security=mvappend('headercheck.Strict-Transport-Security', if(isnotnull('headers.strict-transport-security'), "headers.strict-transport-security:should_not_be_empty=pass", "headers.strict-transport-security:should_not_be_empty=fail"))
| eval headercheck.X-Content-Type-Options=mvappend('headercheck.X-Content-Type-Options', if('headers.x-content-type-options' = "nosniff", "headers.x-content-type-options:should_be:nosniff=pass", "headers.x-content-type-options:should_be:nosniff=fail"))
| eval headercheck.X-Content-Type-Options=mvappend('headercheck.X-Content-Type-Options', if('status' = "200", "status:should_be:200=pass", "status:should_be:200=fail"))
| eval headercheck.X-Content-Type-Options=mvappend('headercheck.X-Content-Type-Options', if(isnotnull('headers.x-content-type-options'), "headers.x-content-type-options:should_not_be_empty=pass", "headers.x-content-type-options:should_not_be_empty=fail"))
| eval headercheck.X-DNS-Prefetch-Control=mvappend('headercheck.X-DNS-Prefetch-Control', if('headers.x-dns-prefetch-control' = "off", "headers.x-dns-prefetch-control:should_be:off=pass", "headers.x-dns-prefetch-control:should_be:off=fail"))
| eval headercheck.X-DNS-Prefetch-Control=mvappend('headercheck.X-DNS-Prefetch-Control', if('status' = "200", "status:should_be:200=pass", "status:should_be:200=fail"))
| eval headercheck.X-DNS-Prefetch-Control=mvappend('headercheck.X-DNS-Prefetch-Control', if(isnotnull('headers.x-dns-prefetch-control'), "headers.x-dns-prefetch-control:should_not_be_empty=pass", "headers.x-dns-prefetch-control:should_not_be_empty=fail"))
| eval headercheck.X-Frame-Options=mvappend('headercheck.X-Frame-Options', if('status' = "200", "status:should_be:200=pass", "status:should_be:200=fail"))
| eval headercheck.X-Frame-Options=mvappend('headercheck.X-Frame-Options', if(in('headers.x-frame-options', "deny", "DENY"), "headers.x-frame-options:should_be:deny_OR_DENY=pass", "headers.x-frame-options:should_be:deny_OR_DENY=fail"))
| eval headercheck.X-Frame-Options=mvappend('headercheck.X-Frame-Options', if(isnotnull('headers.x-frame-options'), "headers.x-frame-options:should_not_be_empty=pass", "headers.x-frame-options:should_not_be_empty=fail"))
| eval headercheck.X-Permitted-Cross-Domain-Policies=mvappend('headercheck.X-Permitted-Cross-Domain-Policies', if('headers.x-permitted-cross-domain-policies' = "none", "headers.x-permitted-cross-domain-policies:should_be:none=pass", "headers.x-permitted-cross-domain-policies:should_be:none=fail"))
| eval headercheck.X-Permitted-Cross-Domain-Policies=mvappend('headercheck.X-Permitted-Cross-Domain-Policies', if('status' = "200", "status:should_be:200=pass", "status:should_be:200=fail"))
| eval headercheck.X-Permitted-Cross-Domain-Policies=mvappend('headercheck.X-Permitted-Cross-Domain-Policies', if(isnotnull('headers.x-permitted-cross-domain-policies'), "headers.x-permitted-cross-domain-policies:should_not_be_empty=pass", "headers.x-permitted-cross-domain-policies:should_not_be_empty=fail"))
| eval headercheck.X-XSS-Protection=mvappend('headercheck.X-XSS-Protection', if('status' = "200", "status:should_be:200=pass", "status:should_be:200=fail"))
| eval headercheck.X-XSS-Protection=mvappend('headercheck.X-XSS-Protection', if(isnull('headers.x-xss-protection'), "headers.x-xss-protection:should_be_empty=pass", "headers.x-xss-protection:should_be_empty=fail"))


