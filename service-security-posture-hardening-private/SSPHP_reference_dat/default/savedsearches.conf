# target/..\service-security-posture-hardening-private\SSPHP_reference_dat/default\savedsearches.conf.d\default.conf

[default]
action.cryptolert.param.debug = 1
action.email = 0
action.email.show_password = 1
action.rss = 0
action.summary_index = 0
alert.track = 0
action.webhook.enable_allowlist = 1
action.email.useNSSubject = 1
auto_summarize = 0
counttype = always
# All searches are disabled by default due to Victoria Experiance pushing apps to all Search Heads.
# Reenable need searches through the UI after install the app for the first time
disabled = 1
dispatchAs = owner
dispatch.max_count = 500000
dispatch.time_format = %FT%T.%Q%:z
enableSched = 0
is_visible = 1
max_concurrent = 1
run_on_startup = 0
request.ui_dispatch_app = SSPHP
request.ui_dispatch_view = search
schedule_as = auto
schedule_priority = default
schedule_window = auto
workload_pool = standard_perf

# target/..\service-security-posture-hardening-private\SSPHP_reference_dat/default\savedsearches.conf.d\ssphp_create_github_repo_service_map_csv.conf

[ssphp_create_github_repo_service_map_csv]
cron_schedule = */30 * * * *
dispatch.earliest_time = 0
dispatch.latest_time = now
enableSched = 1
search = \
`github_index`\
\
| eval ssphp_org='organization.login',\
       ssphp_repo='repository.name'```,\
       ssphp_repo='repository.full_name' ```\
| dedup ssphp_org, ssphp_repo\
\
``` mark RSD repos ```\
| eval ownership=case(ssphp_org="DFE-Digital" AND ssphp_repo="terraform-azurerm-key-vault-tfvars","Schools and School Performance~~~Regional Service Delivery~~~Terraform Key Vault module",\
                      ssphp_org="DFE-Digital" AND ssphp_repo="terraform-azurerm-container-apps-hosting","Schools and School Performance~~~Regional Service Delivery~~~Terraform Container Apps module",\
                      ssphp_org="DFE-Digital" AND ssphp_repo="API-SIP-SharePointOnline","Schools and School Performance~~~Regional Service Delivery~~~SharePoint API",\
                      ssphp_org="DFE-Digital" AND ssphp_repo="prepare-academy-transfers","Schools and School Performance~~~Regional Service Delivery~~~Prepare Academy Transfers",\
                      ssphp_org="DFE-Digital" AND ssphp_repo="prepare-academy-conversions","Schools and School Performance~~~Regional Service Delivery~~~Prepare Academy Conversions",\
                      ssphp_org="DFE-Digital" AND ssphp_repo="amsd-casework","Schools and School Performance~~~Regional Service Delivery~~~Concerns Casework",\
                      ssphp_org="DFE-Digital" AND ssphp_repo="dfe-complete-conversions-transfers-and-changes","Schools and School Performance~~~Regional Service Delivery~~~Complete, Conversions, Transfers and Changes",\
                      ssphp_org="DFE-Digital" AND ssphp_repo="Dfe.Academies.External","Schools and School Performance~~~Regional Service Delivery~~~Apply to Become",\
                      ssphp_org="DFE-Digital" AND ssphp_repo="trams-data-api","Schools and School Performance~~~Regional Service Delivery~~~Academies API",\
\
                      1==1,"unknown~~~unknown~~~unknown")\
\
| rex field=ownership "(?<ssphp_level_1_display_name>[^~]*)~~~(?<ssphp_level_2_display_name>[^~]*)~~~(?<ssphp_service_team>[^~]*)"\
\
| table ssphp_level_1_display_name, ssphp_level_2_display_name, ssphp_org, ssphp_repo, ssphp_service_team\
| sort 0 ssphp_level_1_display_name, ssphp_level_2_display_name, ssphp_org, ssphp_repo, ssphp_service_team\
\
| outputlookup createinapp=t append=f ssphp_github_repo_service_map.csv\



