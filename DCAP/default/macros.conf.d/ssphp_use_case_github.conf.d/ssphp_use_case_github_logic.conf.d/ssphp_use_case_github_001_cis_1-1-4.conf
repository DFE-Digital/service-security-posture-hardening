[ssphp_use_case_github_001_cis_1-1-4{{environment}}]
definition = """

| fillnull value="false" require_last_push_approval, parameters_require_last_push_approval
| makemv ssphp.score.non_compliant_fields
| eval ssphp.score.non_compliant_fields=if(lower('require_last_push_approval')="true" OR lower('parameters_require_last_push_approval')="true",
                                            'ssphp.score.non_compliant_fields',
                                            mvappend('ssphp.score.non_compliant_fields',"require_last_push_approval","parameters_require_last_push_approval"))

| eval ssphp.score.numerator=coalesce(mvcount('ssphp.score.non_compliant_fields'),"0"),
       ssphp.score.denominator="2",
       ssphp.score.score=floor(('ssphp.score.denominator'-'ssphp.score.numerator')*100/'ssphp.score.denominator')


"""

args = 
iseval = 0

