[ssphp_use_case_ado_001_cis_1-1-4{{environment}}]
cron_schedule = 10 6 * * *
dispatch.earliest_time = 0
dispatch.latest_time = now
enableSched = 1
search = """

`ssphp_use_case_ado_data{{environment}}("ado_001_1-1-4","fa4e907d-c16b-4a4c-9dfa-4906e5d171dd")`


| eval org=mvindex(split('repo_policy_owner',"::"),0),
       project_id=mvindex(split('repo_policy_owner',"::"),1)
| rename repo_policy_repos as repo_id

| eval policy_approval_success=if(like(coalesce('policy_settings_requireVoteOnEachIteration',"false").
                                       coalesce('policy_settings_requireVoteOnLastIteration',"false").
                                       coalesce('policy_settings_resetOnSourcePush',"false").
                                       coalesce('policy_settings_resetRejectionsOnSourcePush',"false"),"%true%"),"true","false")

| fillnull value="-" policy_settings_requireVoteOnEachIteration, policy_settings_requireVoteOnLastIteration, policy_settings_resetOnSourcePush, policy_settings_resetRejectionsOnSourcePush

| lookup ssphp_ado_repo_owner.csv organisation as org, project_id, repo_id OUTPUT portfolio as ssphp.service.portfolio, service_line as ssphp.service.service_line, product as ssphp.service.product

| table org, project_name, project_id, ```project_state, project_visibility,``` repo_name, repo_id, ```repo_isDisabled, repo_isInMaintenance,```
        policy_settings_requireVoteOnEachIteration,
        policy_settings_requireVoteOnLastIteration,
        policy_settings_resetOnSourcePush,
        policy_settings_resetRejectionsOnSourcePush,
        policy_approval_success,
        ssphp.service.portfolio, ssphp.service.service_line, ssphp.service.product

"""
