[ssphp_use_case_ado_001_cis_1-1-1{{environment}}]
cron_schedule = 10 6 * * *
dispatch.earliest_time = 0
dispatch.latest_time = now
enableSched = 1
search = """

`ssphp_use_case_ado_001{{environment}}("fa4e907d-c16b-4a4c-9dfa-4906e5d171dd")`
        
| table org, 
        project_id, project_name, project_state, project_visibility, 
        repo_id, repo_name, repo_defaultBranch, type.displayName, revision, settings.scope{}.matchKind, settings.scope{}.refName, settings.scope{}.repositoryId, settings.minimumApproverCount
        
| stats max(eval(if('type.displayName'="Minimum number of reviewers" AND 
                    (('settings.scope{}.matchKind'="DefaultBranch") OR
                    ('settings.scope{}.matchKind'="Exact" AND 'settings.scope{}.refName'='repo_defaultBranch') OR
                    ('settings.scope{}.matchKind'="Prefix" AND like(replace('repo_defaultBranch','settings.scope{}.refName',""),"/%"))),
                    'settings.minimumApproverCount',null()))) as reviewers 
        by org, project_name, repo_name
        
| fillnull value=0 reviewers
| search reviewers<2

"""
