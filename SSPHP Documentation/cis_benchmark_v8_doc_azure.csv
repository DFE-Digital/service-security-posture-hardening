"ssphp.cis_benchmark.control.number", "ssphp.use_case.foundational_system", "ssphp.use_case.id", "ssphp.use_case.savedsearch", "ssphp.use_case.title", "ssphp.cis_benchmark.control.title", "ssphp.cis_benchmark.control.profile_applicability", "ssphp.cis_benchmark.control.level", "ssphp.cis_benchmark.control.description", "ssphp.cis_benchmark.control.rationale", "ssphp.cis_benchmark.control.impact", "ssphp.cis_benchmark.control.group", "ssphp.cis_benchmark.controls.v8", "ssphp.cis_benchmark.controls.ig1", "ssphp.cis_benchmark.controls.ig2", "ssphp.cis_benchmark.controls.ig3", "ssphp.use_case.framework.ig_1", "ssphp.use_case.framework.ig_2", "ssphp.use_case.framework.ig_3", "ssphp.cis_benchmark.document.name", "ssphp.cis_benchmark.document.version", "ssphp.cis_benchmark.document.date", "ssphp.cis_benchmark.version", "ssphp.metadata.last_updated_by", "ssphp.metadata.last_updated_date"
"1.1.1", "AZURE", "azure_001_cis_1-1-1", "ssphp_use_case_azure_001_cis_1-1-1", "AZURE 001 [CIS 1.1.1]", "Ensure Security Defaults is enabled on Azure Active Directory", "Level 1", "L1", "Security defaults in Azure Active Directory (Azure AD) make it easier to be secure and help protect your organization. Security defaults contain preconfigured security settings for common attacks. Security defaults is available to everyone. The goal is to ensure that all organizations have a basic level of security enabled at no extra cost. You may turn on security defaults in the Azure portal.", "Security defaults provide secure default settings that we manage on behalf of organizations to keep customers safe until they are ready to manage their ow n identity security settings. For example, doing the following: - Requiring all users and admins to register for MFA. - Challenging users with MFA- when necessary, based on factors such as location, device, role, and task. - Disabling authentication from legacy authentication clients, which can't do MFA.", "This recommendation should be implemented initially and then may be overridden by other service/product specific CIS Benchmarks. Administrators should also be aware that certain configurations in Azure A ctive Directory may impact other Microsoft services such as Microsoft 365.", "Identity and Access Management", "4.1 Establish and Maintain a Secure Configuration Process", "TRUE", "TRUE", "TRUE", "4.1", "4.1", "4.1", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"1.1.2", "AZURE", "azure_001_cis_1-1-2", "ssphp_use_case_azure_001_cis_1-1-2", "AZURE 001 [CIS 1.1.2]", "Ensure that 'Multi-Factor Auth Status' is 'Enabled' for all Privileged Users", "Level 1", "L1", "Enable multi-factor authentication for all roles, groups, and users that have write access or permissions to Azure resources. These include custom created objects or built-in roles such as; - Service Co-Administrators - Subscription Owners - Contributors", "Multi-factor authentication requires an individual to present a minimum of two separate forms of authentication before access is granted. Multi-factor authentication provides additional assurance that the individ ual attempting to gain access is who they claim to be. With multi-factor authentication, an attacker would need to compromise at least two different authentication mechanisms, increasing the difficulty of compromise and thus reducing the risk.", "User s would require two forms of authentication before any access is granted. Additional administrative time will be required for managing dual forms of authentication when enabling multi-factor authentication.", "Identity and Access Management", "6.3 Require MFA for Externally -Exposed Applications, 6.4 Require MFA for Remote Network Access, 6.5 Require MFA for Administrative Access", "TRUE", "TRUE", "TRUE", "6.4, 6.5", "6.3, 6.4, 6.5", "6.3, 6.4, 6.5", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"1.1.3", "AZURE", "azure_001_cis_1-1-3", "ssphp_use_case_azure_001_cis_1-1-3", "AZURE 001 [CIS 1.1.3]", "Ensure that 'Multi-Factor Auth Status' is 'Enabled' for all Non-Privileged Users", "Level 2", "L2", "Enable multi-factor authentication for all non-privileged users.", "Multi-factor authentication requires an individual to present a minimum of two separate forms of authentication before access is granted. Multi-factor authentication provides additional assurance that the individual attempting to gain access is who they cl aim to be. With multi-factor authentication, an attacker would need to compromise at least two different authentication mechanisms, increasing the difficulty of compromise and thus reducing the risk.", "Users would require two forms of authentication before any access is granted. Also, this requires an overhead for managing dual forms of authentication.", "Identity and Access Management", "6.3 Require MFA for Externally -Exposed Applications, 6.4 Require MFA for Remote Network Access", "TRUE", "TRUE", "TRUE", "6.4", "6.3, 6.4", "6.3, 6.4", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"1.1.4", "AZURE", "azure_001_cis_1-1-4", "ssphp_use_case_azure_001_cis_1-1-4", "AZURE 001 [CIS 1.1.4]", "Ensure that 'Allow users to remember multi-factor authentication on devices they trust' is Disabled", "Level 1", "L1", "Do not allow users to remember multi-factor authentication on devices.", "Remembering Multi-Factor Authentication (MFA) for devices and browsers allows users to have the option to bypass MFA for a set number of days after performing a successful sign-in using MFA. This can enhance usability by minimizing the number of times a user may need to perform two-step verification on the same device. However, if an account or device is compromised, remembering MFA for trusted devices may affect security. Hence, it is recommended that users not be allowed to bypass MFA.", "For every login attempt , the user will be required to perform multi-factor authentication.", "Identity and Access Management", "6.3 Require MFA for Externally -Exposed Applications, 6.4 Require MFA for Remote Network Access", "TRUE", "TRUE", "TRUE", "6.4", "6.3, 6.4", "6.3, 6.4", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"1.2.1", "AZURE", "azure_001_cis_1-2-1", "ssphp_use_case_azure_001_cis_1-2-1", "AZURE 001 [CIS 1.2.1]", "Ensure Trusted Locations Are Defined", "Level 1", "L1", "Azure Active Directory Conditional Access allows an organization to configure Named locations and configure whether t hose locations are trusted or untrusted. These settings provide organizations the means to specify Geographical locations for use in conditional access policies, or define actual IP addresses and IP ranges and whether or not those IP addresses and/or range s are trusted by the organization.", "Defining trusted source IP addresses or ranges helps organizations create and enforce Conditional Access policies around those trusted or untrusted IP addresses and ranges. Users authenticating from trusted IP addresses and/or ranges may have less access restrictions or access requirements when compared to users that try to authenticate to Azure Active Directory from untrusted locations or untrusted source IP addresses/ranges.", "When configuring Named loca tions , the organization can create locations using Geographical location data or by defining source IP addresses or ranges. Configuring Named locations using a Country location does not provide the organization the ability to mark those locations as truste d, and any Conditional Access policy relying on those Countries location setting will not be able to use the All trusted locations setting within the Conditional Access policy. They instead will have to rely on the Select locations setting. This may add ad ditional resource requirements when configuring, and will require thorough organizational testing. In general, Conditional Access policies may completely prevent users from authenticating to Azure Active Directory, and thorough testing is recommended. To avoid complete lockout, a 'Break Glass' account with full Global Administrator rights is recommended in the event all other administrators are locked out of authenticating to Azure Active Directory. This 'Break Glass' account should be excluded from Conditi onal Access Policies and should be configured with the longest pass phrase feasible. This account should only be used in the event of an emergency and complete administrator lockout.", "Identity and Access Management", "6.7 Centralize Access Control, 12.2 Establish and Maintain a Secure Network Architecture", "FALSE", "TRUE", "TRUE", "-", "6.7, 12.2", "6.7, 12.2", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"1.2.2", "AZURE", "azure_001_cis_1-2-2", "ssphp_use_case_azure_001_cis_1-2-2", "AZURE 001 [CIS 1.2.2]", "Ensure that an exclusionary Geographic Access Policy is considered", "Level 1", "L1", "CAUTION : If these policies are created without first auditing and testing the result, misconfiguration can potentially lock out administrators or create undesired access issues. Conditional Access Policies can be used to block access from geographic locations that are deemed out-of-scope for your organization or application. The scope and variables for this policy should be carefu lly examined and defined.", "Conditional Access, when used as a deny list for the tenant or subscription, is able to prevent ingress or egress of traffic to countries that are outside of the scope of interest (e.g.: customers, suppliers) or jurisdi ction of an organization. This is an effective way to prevent unnecessary and long-lasting exposure to international threats such as APTs.", "Azure AD Premium is required. Limiting access geographically will deny access to users that are traveling or working remotely in a different part of the world. A point-to-site or site to site tunnel such as a VPN is recommended to address exceptions to geo graphic access policies.", "Identity and Access Management", "6.7 Centralize Access Control", "FALSE", "TRUE", "TRUE", "-", "6.7", "6.7", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"1.2.3", "AZURE", "azure_001_cis_1-2-3", "ssphp_use_case_azure_001_cis_1-2-3", "AZURE 001 [CIS 1.2.3]", "Ensure that A Multi-factor Authentication Policy Exists for Administrative Groups", "Level 1", "L1", "For designated users, they will be prompted to use their multi-factor authentication (MFA) process on login.", "Enabling multi-factor authentication is a recommended setting to limit the use of Administrative accounts to authenticated personnel.", "There is an increased cost, as Conditional Access policies require Azure AD Premium. Similarly, MFA may re quire additional overhead to maintain. There is also a potential scenario in which the multi-factor authentication method can be lost, and administrative users are no longer able to log in. For this scenario, there should be an emergency access account. Pl ease see References for creating this.", "Identity and Access Management", "6.3 Require MFA for Externally -Exposed Applications, 6.4 Require MFA for Remote Network Access, 6.5 Require MFA for Administrative Access, 6.7 Centralize Access Control", "TRUE", "TRUE", "TRUE", "6.4, 6.5", "6.3, 6.4, 6.5, 6.7", "6.3, 6.4, 6.5, 6.7", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"1.2.4", "AZURE", "azure_001_cis_1-2-4", "ssphp_use_case_azure_001_cis_1-2-4", "AZURE 001 [CIS 1.2.4]", "Ensure that A Multi-factor Authentication Policy Exists for All Users", "Level 1", "L1", "For designated users, they will be prompted to use their multi-factor authentication (MFA) process on logins.", "Enabling multi-factor authentication is a recommended setting to limit the potential of accounts being compromised and limiting access to authenticated personnel.", "There is an increased cost, as Conditional Access policies require Azure AD Premium. Similarly, this may require additional overhead to maintain if users lose access to their MFA.", "Identity and Access Management", "6.3 Require MFA for Externally -Exposed Applications, 6.4 Require MFA for Remote Network Access, 6.7 Centralize Access Control", "TRUE", "TRUE", "TRUE", "6.4", "6.3, 6.4, 6.7", "6.3, 6.4, 6.7", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"1.2.5", "AZURE", "azure_001_cis_1-2-5", "ssphp_use_case_azure_001_cis_1-2-5", "AZURE 001 [CIS 1.2.5]", "Ensure Multi-factor Authentication is Required for Risky Sign-ins", "Level 1", "L1", "For designated users, they will be prompted to use their multi-factor authentication (MFA) process on login.", "Enabling multi-factor authentication is a recommended setting to limit the potential of accounts being compromised and limiting access to authenticated personnel.", "There is an increased cost, as Conditional Access policies require Azure AD Pre mium. Similarly, they may require additional overhead to maintain if users lose access to their MFA.", "Identity and Access Management", "6.3 Require MFA for Externall y-Exposed Applications, 6.4 Require MFA for Remote Network Access, 6.7 Centralize Access Control", "TRUE", "TRUE", "TRUE", "6.4", "6.3, 6.4, 6.7", "6.3, 6.4, 6.7", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"1.2.6", "AZURE", "azure_001_cis_1-2-6", "ssphp_use_case_azure_001_cis_1-2-6", "AZURE 001 [CIS 1.2.6]", "Ensure Multi-factor Authentication is Required for Azure Management", "Level 1", "L1", "For designated users, they will be prompted to use their multi-factor authentication (MFA) process on logins.", "Enabl ing multi-factor authentication is a recommended setting to limit the use of Administrative actions and to prevent intruders from changing settings.", "There is an increased cost, as Conditional Access policies require Azure AD Premium. Similarly, the y may require additional overhead to maintain if users lose access to their MFA.", "Identity and Access Management", "6.3 Require MFA for Externally -Exposed Applications, 6.4 Require MFA for Remote Network Access, 6.5 Require MFA for Administrative Access, 6.7 Centralize Access Control", "TRUE", "TRUE", "TRUE", "6.4, 6.5", "6.3, 6.4, 6.5, 6.7", "6.3, 6.4, 6.5, 6.7", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"1.3", "AZURE", "azure_001_cis_1-3", "ssphp_use_case_azure_001_cis_1-3", "AZURE 001 [CIS 1.3]", "Ensure that 'Users can create Azure AD Tenants' is set to 'No'", "Level 1", "L1", "Require administrators or appropriatel y delegated users to create new tenants.", "It is recommended to only allow an administrator to create new tenants. This prevent users from creating new Azure AD or Azure AD B2C tenants and ensures that only authorized users are able to do so.", "Enforcing this setting will ensure that only aut horized users are able to create new tenants.", "Identity and Access Management", "-", "FALSE", "FALSE", "FALSE", "-", "-", "-", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"1.4", "AZURE", "azure_001_cis_1-4", "ssphp_use_case_azure_001_cis_1-4", "AZURE 001 [CIS 1.4]", "Ensure Access Review is Set Up for External Users in Azure AD Privileged Identity Management", "Level 2", "L2", "This recommendation extends guest access review by utilizing the Azure AD Privileged Identity Management feature provided in Azure AD Premium P2. Azure AD is extended to include Azure AD B2B collaboration, allowing you to invite people from outside your or ganization to be guest users in your cloud account and sign in with their own work, school, or social identities. Guest users allow you to share your company's applications and services with users from any other organization, while maintaining control over your own corporate data. Work with external partners, large or small, even if they don't have Azure AD or an IT department. A simple invitation and redemption process lets partners use their own credentials to access your company's resources a a guest use r.", "Guest users in the Azure AD are generally required for collaboration purposes in Office 365, and may also be required for Azure functions in enterprises with multiple Azure tenants. Guest users should be reviewed on a regular basis, at least annually. Guest users should not be granted administrative roles where possible. Guest users are typically added outside your employee on-boarding/off-boarding process and could potentially be overlooked indefinitely, leading to a potential vulnerability. Guest users should be reviewed on a monthly basis to ensure that inactive and unneeded accounts are removed.", "Until you have a business need to provide guest access to any user, avoid creating guest users. If guest accounts are being used, they shou ld be removed when no longer required.", "Identity and Access Management", "5.1 Establish and Maintain an Inventory of Accounts, 5.3 Disable Dormant Accounts, 6.2 Establish an Access Revoking Process, 6.8 Define and Maintain Role -Based Access Control", "TRUE", "TRUE", "TRUE", "5.1, 5.3, 6.2", "5.1, 5.3, 6.2", "5.1, 5.3, 6.2, 6.8", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"1.5", "AZURE", "azure_001_cis_1-5", "ssphp_use_case_azure_001_cis_1-5", "AZURE 001 [CIS 1.5]", "Ensure Guest Users Are Reviewed on a Regular Basis", "Level 1", "L1", "Azure AD is extended to include Azure AD B2B collaboration, allowing you to invite people from outside your organization to be guest users in you r cloud account and sign in with their own work, school, or social identities. Guest users allow you to share your company's applications and services with users from any other organization, while maintaining control over your own corporate data. Work with external partners, large or small, even if they don't have Azure AD or an IT department. A simple invitation and redemption process lets partners use their own credentials to access your company's resources as a guest user. Guest users in every subscripti on should be review on a regular basis to ensure that inactive and unneeded accounts are removed.", "Guest users in the Azure AD are generally required for collaboration purposes in Office 365, and may also be required for Azure functions in enterp rises with multiple Azure tenants. Guest users are typically added outside your employee on-boarding/off-boarding process and could potentially be overlooked indefinitely, leading to a potential vulnerability. To prevent this, guest users should be reviewe d on a regular basis. During this audit, guest users should also be determined to not have administrative privileges.", "Before removing guest users, determine their use and scope. Like removing any user, there may be unforeseen consequences to system s if it is deleted.", "Identity and Access Management", "5.1 Establish and Maintain an In ventory of Accounts, 5.3 Disable Dormant Accounts, 6.2 Establish an Access Revoking Process, 6.8 Define and Maintain Role -Based Access Control", "TRUE", "TRUE", "TRUE", "5.1, 5.3, 6.2", "5.1, 5.3, 6.2", "5.1, 5.3, 6.2, 6.8", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"1.6", "AZURE", "azure_001_cis_1-6", "ssphp_use_case_azure_001_cis_1-6", "AZURE 001 [CIS 1.6]", "Ensure That 'Number of methods required to reset' is set to '2'", "Level 1", "L1", "Ensures that two alternate forms of identification are provided before allowing a password reset.", "A Self-service Password Reset (SSPR) through Azure Multi-factor Authentication (MFA) ensures the user's identity is confirmed using two separate me thods of identification. With multiple methods set, an attacker would have to compromise both methods before they could maliciously reset a user's password.", "There may be administrative overhead, as users who lose access to their secondary authentic ation methods will need an administrator with permissions to remove it. There will also need to be organization-wide security policies and training to teach administrators to verify the identity of the requesting user so that social engineering can not ren der this setting useless.", "Identity and Access Management", "6.3 Require MFA for Externally -Exposed Applications, 6.4 Require MFA for Remote Network Access", "TRUE", "TRUE", "TRUE", "6.4", "6.3, 6.4", "6.3, 6.4", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"1.7", "AZURE", "azure_001_cis_1-7", "ssphp_use_case_azure_001_cis_1-7", "AZURE 001 [CIS 1.7]", "Ensure that a Custom Bad Password List is set to 'Enforce' for your Organization", "Level 1", "L1", "Microsoft Azure provides a Global Banned Password policy that applies to Azure administrative and normal user accounts. This is not applied to user accounts that are synced from an on-premise Active Directory unless Azure AD Connect is used and you enable EnforceCloudPasswordPolicyForPasswordSyncedUsers. Please see the list in default values on the specifics of this policy. To further password security, it is recommended to further define a custom banned password policy.", "Enabling this gives your organization further customization on what secure passwords are allowed. Setting a bad password list enables your organization to fine-tune its password policy further, depending on your needs. Removing easy-to-guess passwords increases the security of acc ess to your Azure resources.", "Increasing needed password complexity might increase overhead on administration of user accounts. Licensing requirement for Global Banned Password List and Custom Banned Password list requires Azure AD Premium P1 or P2. On-premises Active Directory Domain Services users that are not synchronized to Azure AD also benefit from Azure AD Password Protection based on existing licensing for synchronized users.", "Identity and Access Management", "5.2 Use Unique Passwords, 6.7 Centralize Access Control", "TRUE", "TRUE", "TRUE", "5.2", "5.2, 6.7", "5.2, 6.7", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"1.8", "AZURE", "azure_001_cis_1-8", "ssphp_use_case_azure_001_cis_1-8", "AZURE 001 [CIS 1.8]", "Ensure that 'Number of days before users are asked to re-confirm their authentication information' is not set to '0'", "Level 1", "L1", "Ensure that the number of days before user s are asked to re-confirm their authentication information is not set to 0.", "This setting is necessary if you have setup 'Require users to register when signing in option'. If authentication re-confirmation is disabled, registered users will neve r be prompted to re-confirm their existing authentication information. If the authentication information for a user changes, such as a phone number or email, then the password reset information for that user reverts to the previously registered authenticat ion information.", "Users will be prompted for their multifactor authentication at the duration set here.", "Identity and Access Management", "6.2 Establish an Access Revoking Process", "TRUE", "TRUE", "TRUE", "6.2", "6.2", "6.2", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"1.9", "AZURE", "azure_001_cis_1-9", "ssphp_use_case_azure_001_cis_1-9", "AZURE 001 [CIS 1.9]", "Ensure that 'Notify users on password resets?' is set to 'Yes'", "Level 1", "L1", "Ensure that users are notified on their primary and secondar y emails on password resets.", "User notification on password reset is a proactive way of confirming password reset activity. It helps the user to recognize unauthorized password reset activities.", "Users will receive emails alerting them to password changes to both their primary and secondary emails.", "Identity and Access Management", "6.7 Centralize Access Control", "FALSE", "TRUE", "TRUE", "-", "6.7", "6.7", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"1.10", "AZURE", "azure_001_cis_1-10", "ssphp_use_case_azure_001_cis_1-10", "AZURE 001 [CIS 1.10]", "Ensure That 'Notify all admins when other admins reset their password?' is set to 'Yes'", "Level 1", "L1", "Ensure that all Global Administrators are notified if any other administrator resets their password.", "Global Administrator accounts are sensitive. Any password reset activity notification, when sent to all Global Administrators, ensures that all Global administrators can passively confirm if such a reset is a common pattern within their group. For exa mple, if all Global Administrators change their password every 30 days, any password reset activity before that may require administrator(s) to evaluate any unusual activity and confirm its origin.", "All Global Administrators will receive a notificat ion from Azure every time a password is reset. This is useful for auditing procedures to confirm that there are no out of the ordinary password resets for Global Administrators. There is additional overhead, however, in the time required for Global Adminis trators to audit the notifications. This setting is only useful if all Global Administrators pay attention to the notifications, and audit each one.", "Identity and Access Management", "5.4 Restrict Administrator Privileges to Dedicated Administrator Accounts, 6.7 Centralize Access Control", "TRUE", "TRUE", "TRUE", "5.4", "5.4, 6.7", "5.4, 6.7", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"1.11", "AZURE", "azure_001_cis_1-11", "ssphp_use_case_azure_001_cis_1-11", "AZURE 001 [CIS 1.11]", "Ensure `User consent for applications` is set to `Do not allow user consent`", "Level 1", "L1", "Require administrators to provide consent for applications before use.", "If Azure Active Directory is running as an identity provider for third-party applications, permissions and consent should be limited to administrators or pre-approved. Malicious applications may attempt to exfiltrate data or abuse privileged user accounts.", "Enforcing this setting may create additional requests that administrators need to review.", "Identity and Access Management", "2.3 Address Unauthorized Software, 6.1 Establish an Access Granting Process, 6.7 Centralize Access Control", "TRUE", "TRUE", "TRUE", "2.3, 6.1", "2.3, 6.1, 6.7", "2.3, 6.1, 6.7", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"1.12", "AZURE", "azure_001_cis_1-12", "ssphp_use_case_azure_001_cis_1-12", "AZURE 001 [CIS 1.12]", "Ensure 'User consent for applications' Is Set To 'Allow for Verified Publishers'", "Level 2", "L2", "Allow users to provide consent for selected permissions when a request is coming from a verified publisher.", "If Azure Active Directory is running as an identity provider for third-party applications, permissions and consent should be limited to a dministrators or pre-approved. Malicious applications may attempt to exfiltrate data or abuse privileged user accounts.", "Enforcing this setting may create additional requests that administrators need to review.", "Identity and Access Management", "2.3 Address Unauthorized Software, 2.5 Allowlist Authorized Software, 6.1 Establish an Access Granting Process, 6.7 Centralize Access Control", "TRUE", "TRUE", "TRUE", "2.3, 6.1", "2.3, 2.5, 6.1, 6.7", "2.3, 2.5, 6.1, 6.7", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"1.13", "AZURE", "azure_001_cis_1-13", "ssphp_use_case_azure_001_cis_1-13", "AZURE 001 [CIS 1.13]", "Ensure that 'Users can add gallery apps to My Apps' is set to 'No'", "Level 1", "L1", "Require administrators to provide consent for the apps before use.", "Unless Azure Active Directory is running as an identity provider for third-party applications, do not allow users to use their identity outside of your cloud environment. User profiles contain private information such as phone numbers and email addresses which could then be sold off to other third parties without requiring any further consent from the user.", "Can cause additional requests to administrators that need to be fulfilled quite often.", "Identity and Access Management", "2.3 Address Unauthorized Software, 2.4 Utilize Automated Software Inventory Tools", "TRUE", "TRUE", "TRUE", "2.3", "2.3, 2.4", "2.3, 2.4", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"1.14", "AZURE", "azure_001_cis_1-14", "ssphp_use_case_azure_001_cis_1-14", "AZURE 001 [CIS 1.14]", "Ensure That 'Users Can Register Applications' Is Set to 'No'", "Level 1", "L1", "Require administrators or appropriately delegated users to register third-party applications.", "It is r ecommended to only allow an administrator to register custom-developed applications. This ensures that the application undergoes a formal security review and approval process prior to exposing Azure Active Directory data. Certain users like developers or o ther high-request users may also be delegated permissions to prevent them from waiting on an administrative user. Your organization should review your policies and decide your needs.", "Enforcing this setting will create additional requests for approval that will need to be addressed by an administrator. If permissions are delegated, a user may approve a malevolent third party application, potentially giving it access to your data.", "Identity and Access Management", "2.3 Address Unauthorized Software, 2.4 Utilize Automated Software Inventory Tools, 6.7 Centralize Access Control", "TRUE", "TRUE", "TRUE", "2.3", "2.3, 2.4, 6.7", "2.3, 2.4, 6.7", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"1.15", "AZURE", "azure_001_cis_1-15", "ssphp_use_case_azure_001_cis_1-15", "AZURE 001 [CIS 1.15]", "Ensure That 'Guest users access restrictions' is set to 'Gue st user access is restricted to properties and memberships of their own directory objects'", "Level 1", "L1", "Limit guest user permissions.", "Limiting guest access ensures that guest accounts do not have permission for certain directory tasks, such as enumerating users, groups or other directory resources, and cannot be assigned to administrative roles in your directory. Guest access has three levels of restriction. 1. Guest users have the same access as members (most inclusive), 2. Guest users have limited access to properties and memberships of directory objects (default value), 3. Guest user access is restricted to properties and memberships of their o wn directory objects (most restrictive). The recommended option is the 3rd, most restrictive: 'Guest user access is restricted to their own directory object'.", "This may create additional requests for permissions to access resources that administrato rs will need to approve.", "Identity and Access Management", "3.3 Configure Data Access Control Lists, 3.7 Establish and Maintain a Data Classification Scheme, 6.7 Centralize Access Control, 6.8 Define and Maintain Role -Based Access Control", "TRUE", "TRUE", "TRUE", "3.3", "3.3, 3.7, 6.7", "3.3, 3.7, 6.7, 6.8", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"1.16", "AZURE", "azure_001_cis_1-16", "ssphp_use_case_azure_001_cis_1-16", "AZURE 001 [CIS 1.16]", "Ensure that 'Guest invite restrictions' is set to "Only users assigned to specific admin roles can invite guest users"", "Level 2", "L2", "Restrict invitations to users with specific administrative roles only.", "Restricting invitations to users with specific administrator roles ensures that only authorized accounts have access to cloud resources. This helps to maintain 'Need to Know' permissions and prevents inadvertent access to data. By default the setting Guest invite restrictions is set to Anyone in the organization can invite guest users including guests and non-admins . This would allow anyone within the organization to invite guests and non-admins to the tenant, posing a security risk.", "With the option of Only users assigned to specific admin roles can invite guest users selected, users with specific admin roles will be in charge of sending invitations to the external users, requiring additional overhead by them to manage user accounts. This will mean coordinating with other departments as they are onboarding new users.", "Identity and Access Management", "6.1 Establish an Access Granting Process, 6.8 Define and Maintain Role -Based Access Control", "TRUE", "TRUE", "TRUE", "6.1", "6.1", "6.1, 6.8", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"1.17", "AZURE", "azure_001_cis_1-17", "ssphp_use_case_azure_001_cis_1-17", "AZURE 001 [CIS 1.17]", "Ensure That 'Restrict access to Azure AD administration portal' is Set to 'Yes'", "Level 1", "L1", "Restrict access to the Azure AD administration portal to administrators only. NOTE : This only affects access to the Azure AD administrator's web portal. This setting does not prohibit privileged users from using other methods such as Rest API or Powershell to obtain sensitive information from Azure AD.", "The Azure AD administrative portal has sensitive data an d permission settings. All non-administrators should be prohibited from accessing any Azure AD data in the administration portal to avoid exposure.", "All administrative tasks will need to be done by Administrators, causing additional overhead in mana gement of users and resources.", "Identity and Access Management", "5.4 Restrict Administrator Privileges to Dedicated Administrator Accounts, 6.8 Define and Maintain Role -Based Access Control", "TRUE", "TRUE", "TRUE", "5.4", "5.4", "5.4, 6.8", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"1.18", "AZURE", "azure_001_cis_1-18", "ssphp_use_case_azure_001_cis_1-18", "AZURE 001 [CIS 1.18]", "Ensure that 'Restrict user ability to access groups features in the Access Pane' is Set to 'Yes'", "Level 2", "L2", "Restricts group creation to administrators with permissions only.", "Self-service group ma nagement enables users to create and manage security groups or Office 365 groups in Azure Active Directory (Azure AD). Unless a business requires this day-to-day delegation for some users, self-service group management should be disabled.", "Setting to Yes could create administrative overhead by customers seeking certain group memberships that will have to be manually managed by administrators with appropriate permissions.", "Identity and Access Management", "6.8 Define and Maintain Role -Based Access Control", "FALSE", "FALSE", "TRUE", "-", "-", "6.8", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"1.19", "AZURE", "azure_001_cis_1-19", "ssphp_use_case_azure_001_cis_1-19", "AZURE 001 [CIS 1.19]", "Ensure that 'Users can create security groups in Azure portals, API or PowerShell' is set to 'No'", "Level 2", "L2", "Restrict security group creation to administrators only.", "When creating security groups is enabled, all users in the directory are allowed to create new security groups and add members to those groups. Unless a business requires this day-to-day delegation, security group creation should be restricted to administrators only.", "Enabling this setting could create a number of requests that would need to be managed by an administrator.", "Identity and Access Management", "6.8 Define and Maintain Role -Based Access Control", "FALSE", "FALSE", "TRUE", "-", "-", "6.8", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"1.20", "AZURE", "azure_001_cis_1-20", "ssphp_use_case_azure_001_cis_1-20", "AZURE 001 [CIS 1.20]", "Ensure that 'Owners can manage group membership requests in the Access Panel' is set to 'No'", "Level 2", "L2", "Restrict security group management to administrators only.", "Restricting security group manag ement to administrators only prohibits users from making changes to security groups. This ensures that security groups are appropriately managed and their management is not delegated to non-administrators.", "Group Membership for user accounts will ne ed to be handled by Admins and cause administrative overhead.", "Identity and Access Management", "6.8 Define and Maintain Role -Based Access Control", "FALSE", "FALSE", "TRUE", "-", "-", "6.8", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"1.21", "AZURE", "azure_001_cis_1-21", "ssphp_use_case_azure_001_cis_1-21", "AZURE 001 [CIS 1.21]", "Ensure that 'Users can create Microsoft 365 groups in Azure portals, API or PowerShell' is set to 'No'", "Level 2", "L2", "Restrict Microsoft 365 group creation to administrators only.", "Restricting Microsoft 365 group creation to administrators only ensures that creation of Microsoft 365 groups is controlled by the administrator. Appropriate groups should be created and managed by the administrator and group creation rights should not be delegated to any other user.", "Enabling this setting could create a number of requests that would need to be managed by an administrator.", "Identity and Access Management", "6.8 Define and Maintain Role -Based Access Control", "FALSE", "FALSE", "TRUE", "-", "-", "6.8", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"1.22", "AZURE", "azure_001_cis_1-22", "ssphp_use_case_azure_001_cis_1-22", "AZURE 001 [CIS 1.22]", "Ensure that 'Require Multi-Factor Authentication to register or join devices with Azure AD' is set to 'Yes'", "Level 1", "L1", "Joining or registering devices to the active directory should require Multi-factor authentication.", "Multi-factor authentication is recommended when adding devices to Azure AD. When set to Yes, users who are adding devices from the internet must first use the second method of authentication before their device is successfully added to the directory. This ensures that rogue devices are not added to the domain using a compromised user account. Note: Some Microsoft documentation suggests to use conditional access policies for joining a domain from certain whitelisted networks or devices. Even with these in place, using Multi-Factor Authentication is still recommended, as it creates a process for re view before joining the domain.", "A slight impact of additional overhead, as Administrators will now have to approve every access to the domain.", "Identity and Access Management", "6.3 Require MFA for Externally -Exposed Applications, 6.4 Require MFA for Remote Network Access", "TRUE", "TRUE", "TRUE", "6.4", "6.3, 6.4", "6.3, 6.4", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"1.23", "AZURE", "azure_001_cis_1-23", "ssphp_use_case_azure_001_cis_1-23", "AZURE 001 [CIS 1.23]", "Ensure That No Custom Subscription Administrator Roles Exist", "Level 1", "L1", "The principle of least privilege should be followed and only necessary privileges should be assigned instead of allowing full admin istrative access.", "Classic subscription admin roles offer basic access management and include Account Administrator, Service Administrator, and Co-Administrators. It is recommended the least necessary permissions be given initially. Permissions can be added as needed by the account holder. This ensures the account holder cannot perform actions which were not intended.", "Subscriptions will need to be handled by Administrators with permissions.", "Identity and Access Management", "5.4 Restrict Administrator Privileges to D edicated Administrator Accounts, 6.8 Define and Maintain Role -Based Access Control", "TRUE", "TRUE", "TRUE", "5.4", "5.4", "5.4, 6.8", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"1.24", "AZURE", "azure_001_cis_1-24", "ssphp_use_case_azure_001_cis_1-24", "AZURE 001 [CIS 1.24]", "Ensure a Custom Role is Assigned Permissions for Administering Resource Locks", "Level 2", "L2", "Resource locking is a powerful protection mechanism that can prevent inadvertent modification/deletion of resources within Azure subscriptions/Resource Groups and is a recommended NIST configuration.", "Given the resource lock functionality is outs ide of standard Role Based Access Control(RBAC), it would be prudent to create a resource lock administrator role to prevent inadvertent unlocking of resources.", "By adding this role, specific permissions may be granted for managing just resource locks rather than needing to provide the wide Owner or User Access Administrator role, reducing the risk of the user being able to do unintentional damage.", "Identity and Access Management", "3.3 Configure Data Access Control Lists, 6.8 Define and Maintain Role -Based Access Control", "TRUE", "TRUE", "TRUE", "3.3", "3.3", "3.3, 6.8", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"1.25", "AZURE", "azure_001_cis_1-25", "ssphp_use_case_azure_001_cis_1-25", "AZURE 001 [CIS 1.25]", "Ensure That 'Subscription Entering AAD Directory' and 'Subscription Leaving AAD Directory' Is Set To 'Permit No One'", "Level 2", "L2", "Users who are set as subscription owners are able to make administrative chang es to the subscriptions and move them into and out of Azure Active Directories.", "Permissions to move subscriptions in and out of Azure Active Directory must only be given to appropriate administrative personnel. A subscription that is moved into an Azure Active Directory may be within a folder to which other users have elevated permissions. This prevents loss of data or unapproved changes of the objects within by potential bad actors.", "Subscriptions will need to have these settings turned o ff to be moved.", "Identity and Access Management", "5.4 Restrict Administrator Privileges to Dedicated Administrator Accounts, 6.1 Establish an Access Granting Process, 6.2 Establish an Access Revoking Process", "TRUE", "TRUE", "TRUE", "5.4, 6.1, 6.2", "5.4, 6.1, 6.2", "5.4, 6.1, 6.2", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"2.1.1", "AZURE", "azure_002_cis_2-1-1", "ssphp_use_case_azure_002_cis_2-1-1", "AZURE 002 [CIS 2.1.1]", "Ensure That Mi crosoft Defender for Servers Is Set to 'On'", "Level 2", "L2", "Turning on Microsoft Defender for Servers enables threat detection for Servers, providing threat intelligence, anomaly detection, and behavior analytics in the Microsoft Defender for Cloud.", "Enabling Microsoft Defender for Servers allows for grea ter defense-in-depth, with threat detection provided by the Microsoft Security Response Center (MSRC).", "Turning on Microsoft Defender for Servers in Microsoft Defender for Cloud incurs an additional cost per resource.", "Microsoft Defender", "7.5 Perform Automated Vulnerability Scans of Internal Enterprise Assets, 10.1 Deploy and Maintain Anti -Malware Software", "TRUE", "TRUE", "TRUE", "10.1", "7.5, 10.1", "7.5, 10.1", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"2.1.2", "AZURE", "azure_002_cis_2-1-2", "ssphp_use_case_azure_002_cis_2-1-2", "AZURE 002 [CIS 2.1.2]", "Ensure That Microsoft Defender for App Services Is Set To 'On'", "Level 2", "L2", "Turning on Microsoft Defender for App Service enables threat detection for App Service, providing threat intelligence, anomaly detection, and behavior analytics in the Microsoft Defender for Cloud.", "Enabling Microsoft Defender for App Service all ows for greater defense-in-depth, with threat detection provided by the Microsoft Security Response Center (MSRC).", "Turning on Microsoft Defender for App Service incurs an additional cost per resource.", "Microsoft Defender", "7.5 Perform Automated Vulnerability Scans of Internal Enterprise Assets, 7.6 Perform Automated Vulnerabil ity Scans of Externally -Exposed Enterprise Assets, 16.11 Leverage Vetted Modules or Services for Application Security Components", "FALSE", "TRUE", "TRUE", "-", "7.5, 7.6, 16.11", "7.5, 7.6, 16.11", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"2.1.3", "AZURE", "azure_002_cis_2-1-3", "ssphp_use_case_azure_002_cis_2-1-3", "AZURE 002 [CIS 2.1.3]", "Ensure That Microsoft Defender for Databases Is Set To 'On'", "Level 2", "L2", "Turning on Microsoft Defender for Databases enables threat detection for the instances running your database software. This provides threat intelligence, anomaly detection, and behavior analytics in the Azure Microsoft Defender for Cloud. Instead of being enabled on services like Platform as a Service (PaaS), thi s implementation will run within your instances as Infrastructure as a Service (IaaS) on the Operating Systems hosting your databases.", "Enabling Microsoft Defender for Azure SQL Databases allows your organization more granular control of the infrastructure running your database software. Instead of waiting on Microsoft release updates or other similar processes, you can manage them yoursel f. Threat detection is provided by the Microsoft Security Response Center (MSRC).", "Running Defender on Infrastructure as a service (IaaS) may incur increased costs associated with running the service and the instance it is on. Similarly, you will ne ed qualified personnel to maintain the operating system and software updates. If it is not maintained, security patches will not be applied and it may be open to vulnerabilities.", "Microsoft Defender", "7.5 Perform Automated Vulnerability Scans of Internal Enterprise Assets, 16.11 Leverage Vetted Modules or Services for Application Security Components", "FALSE", "TRUE", "TRUE", "-", "7.5, 16.11", "7.5, 16.11", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"2.1.4", "AZURE", "azure_002_cis_2-1-4", "ssphp_use_case_azure_002_cis_2-1-4", "AZURE 002 [CIS 2.1.4]", "Ensure That Microsoft Defender for Azure SQL Databases Is Set To 'On'", "Level 2", "L2", "Turning on Microsoft Defender for Azure SQL Databases enables threat detection for Azure SQL database servers, providing thr eat intelligence, anomaly detection, and behavior analytics in the Microsoft Defender for Cloud.", "Enabling Microsoft Defender for Azure SQL Databases allows for greater defense-in-depth, with threat detection provided by the Microsoft Security Re sponse Center (MSRC).", "Turning on Microsoft Defender for Azure SQL Databases incurs an additional cost per resource.", "Microsoft Defender", "7.5 Perform Automated Vulnerability Scans of Internal Enterprise Assets, 16.11 Leverage Vetted Modules or Services for Application Security Components", "FALSE", "TRUE", "TRUE", "-", "7.5, 16.11", "7.5, 16.11", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"2.1.5", "AZURE", "azure_002_cis_2-1-5", "ssphp_use_case_azure_002_cis_2-1-5", "AZURE 002 [CIS 2.1.5]", "Ensure That Microsoft Defender for SQL Servers on Machines Is Set To 'On'", "Level 2", "L2", "Turning on Microsoft Defender for SQL servers on machines enables threat detection for SQL servers on machines, providin g threat intelligence, anomaly detection, and behavior analytics in the Microsoft Defender for Cloud.", "Enabling Microsoft Defender for SQL servers on machines allows for greater defense-in-depth, with threat detection provided by the Microsoft Se curity Response Center (MSRC).", "Turning on Microsoft Defender for SQL servers on machines incurs an additional cost per resource.", "Microsoft Defender", "7.5 Perform Automated Vulnerability Scans of Internal Enterprise Assets, 16.11 Leverage Vetted Modules or Services for Application Security Components", "FALSE", "TRUE", "TRUE", "-", "7.5, 16.11", "7.5, 16.11", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"2.1.6", "AZURE", "azure_002_cis_2-1-6", "ssphp_use_case_azure_002_cis_2-1-6", "AZURE 002 [CIS 2.1.6]", "Ensure That Microsoft Defender for Open-Source Relational Databases Is Set To 'On'", "Level 2", "L2", "Turning on Microsoft Defender for Open-source relational databases enables threat detection for Open-source rel ational databases, providing threat intelligence, anomaly detection, and behavior analytics in the Microsoft Defender for Cloud.", "Enabling Microsoft Defender for Open-source relational databases allows for greater defense-in-depth, with threat de tection provided by the Microsoft Security Response Center (MSRC).", "Turning on Microsoft Defender for Open-source relational databases incurs an additional cost per resource.", "Microsoft Defender", "7.5 Perform Automated Vulnerability Scans of Internal Enterprise Assets, 16.11 Leverage Vetted Modules or Services for Application Security Components", "FALSE", "TRUE", "TRUE", "-", "7.5, 16.11", "7.5, 16.11", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"2.1.7", "AZURE", "azure_002_cis_2-1-7", "ssphp_use_case_azure_002_cis_2-1-7", "AZURE 002 [CIS 2.1.7]", "Ensure That Microsoft Defender for Storage Is Set To 'On'", "Level 2", "L2", "Turning on Microsoft Defender for Storage enables threat detection for Storage, providing threat intelligence, anomaly detection, and be havior analytics in the Microsoft Defender for Cloud.", "Enabling Microsoft Defender for Storage allows for greater defense-in-depth, with threat detection provided by the Microsoft Security Response Center (MSRC).", "Turning on Microsoft Defe nder for Storage incurs an additional cost per resource.", "Microsoft Defender", "7.5 Perform Automated Vulnerability Scans of Internal Enterprise Assets", "FALSE", "TRUE", "TRUE", "-", "7.5", "7.5", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"2.1.8", "AZURE", "azure_002_cis_2-1-8", "ssphp_use_case_azure_002_cis_2-1-8", "AZURE 002 [CIS 2.1.8]", "Ensure That Microsoft Defender for Containers Is Set To 'On'", "Level 2", "L2", "Turning on Microsoft Defender for Containers enables threat detection for Container Registries including Kubernetes, providing threat intelligence, anomaly detection, and behavior analytics in the Microsoft Defender for Cloud.", "Enabling Microsoft Defender for Container Registries allows for greater defense-in-depth, with threat detection provided by the Microsoft Security Response Center (MSRC).", "Turning on Microsoft Defender for Containers incurs an additional cost per resource.", "Microsoft Defender", "7.5 Perform Automated Vulnerability Scans of Internal Enterprise Assets", "FALSE", "TRUE", "TRUE", "-", "7.5", "7.5", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"2.1.9", "AZURE", "azure_002_cis_2-1-9", "ssphp_use_case_azure_002_cis_2-1-9", "AZURE 002 [CIS 2.1.9]", "Ensure That Microsoft Defender for Azure Cosmos DB Is Set To 'On'", "Level 2", "L2", "Microsoft Defender for Azure Cosmos DB scans all incoming network requests for threats to your Azure Cosmos DB resources.", "In scanning Azure Cosmos DB requests within a subscription, requests are compared to a heuristic list of potential security threats. These threats could be a result of a security breach within your services, thus scanning for them could prevent a pote ntial security threat from being introduced.", "Enabling Microsoft Defender for Azure Cosmos DB requires enabling Microsoft Defender for your subscription. Both will incur additional charges.", "Microsoft Defender", "7.5 Perform Automated Vulnerability Scans of Internal Enterprise Assets, 16.11 Leverage Vetted Modules or Services for Application Security Components", "FALSE", "TRUE", "TRUE", "-", "7.5, 16.11", "7.5, 16.11", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"2.1.10", "AZURE", "azure_002_cis_2-1-10", "ssphp_use_case_azure_002_cis_2-1-10", "AZURE 002 [CIS 2.1.10]", "Ensure That Microsoft Defender for Key Vault Is Set To 'On'", "Level 2", "L2", "Turning on Microsoft Defender for Key Vault enables threat detection for Key Vault, providing threat intelligence, anomaly detection, and behavior analytics in the Microsoft Defender for Cloud.", "Enabling Microsoft Defender for Key Vault allows for greater defense-in-depth, with threat detection provided by the Microsoft Security Response Center (MSRC).", "Turning on Micro soft Defender for Key Vault incurs an additional cost per resource.", "Microsoft Defender", "7.5 Perform Automated Vulnerability Scans of Internal Enterprise Assets", "FALSE", "TRUE", "TRUE", "-", "7.5", "7.5", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"2.1.11", "AZURE", "azure_002_cis_2-1-11", "ssphp_use_case_azure_002_cis_2-1-11", "AZURE 002 [CIS 2.1.11]", "Ensure That Microsoft Defender for DNS Is Set To 'On'", "Level 2", "L2", "Microsoft Defender for DNS scans all network traffic exiting from within a subscription.", "DNS lookups within a subscription are scanned and compared to a dynamic list of websites that might be potential security threats. These threats could be a result of a security breach within your services, thus scanning for them could prevent a potential security threat from being introduced.", "Enabling Microsoft Defender for DNS requires enabling Microsoft Defender for your subscription. Both will incu r additional charges, with Defender for DNS being a small amount per million queries.", "Microsoft Defender", "4.9 Configure Trusted DNS Servers on Enterprise Assets, 7.5 Perform Automated Vulnerability Scans of Inte rnal Enterprise Assets, 13.6 Collect Network Traffic Flow Logs", "FALSE", "TRUE", "TRUE", "-", "4.9, 7.5, 13.6", "4.9, 7.5, 13.6", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"2.1.12", "AZURE", "azure_002_cis_2-1-12", "ssphp_use_case_azure_002_cis_2-1-12", "AZURE 002 [CIS 2.1.12]", "Ensure That Microsoft Defender for Resource Manager Is Set To 'On'", "Level 2", "L2", "Microsoft Defender for Resource Manager scans incoming administrative requests to change your infrastructure from both CLI and the Azure portal.", "Scanning resource requests lets you be alerted every time there is suspicious activity in order to p revent a security threat from being introduced.", "Enabling Microsoft Defender for Resource Manager requires enabling Microsoft Defender for your subscription. Both will incur additional charges.", "Microsoft Defender", "5.4 Restrict Administrator Privileges to Dedicated Administrator Accounts, 7.5 Perform Automated Vulnerability Scans of Internal Enterprise Assets", "TRUE", "TRUE", "TRUE", "5.4", "5.4, 7.5", "5.4, 7.5", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"2.1.13", "AZURE", "azure_002_cis_2-1-13", "ssphp_use_case_azure_002_cis_2-1-13", "AZURE 002 [CIS 2.1.13]", "Ensure that Microsoft Defender Recommendation for 'Apply system updates' status is 'Completed'", "Level 1", "L1", "Ensure that the latest OS patches for all virtual machines are applied.", "Windows and Lin ux virtual machines should be kept updated to: - Address a specific bug or flaw - Improve an OS or application's general stability - Fix a security vulnerability The Azure Security Center retrieves a list of available security and critical updates from Windows U pdate or Windows Server Update Services (WSUS), depending on which service is configured on a Windows VM. The security center also checks for the latest updates in Linux systems. If a VM is missing a system update, the security center will recommend system updates be applied.", "Running Microsoft Defender for Cloud incurs additional charges for each resource monitored. Please see attached reference for exact charges per hour.", "Microsoft Defender", "7.3 Perform Automated Operating System Patch Management", "TRUE", "TRUE", "TRUE", "7.3", "7.3", "7.3", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"2.1.14", "AZURE", "azure_002_cis_2-1-14", "ssphp_use_case_azure_002_cis_2-1-14", "AZURE 002 [CIS 2.1.14]", "Ensure Any of the ASC Default Policy Settings are Not Set to 'Disabled'", "Level 1", "L1", "None of the settings offered by ASC Default policy should be set to effect Disabled .", "A security policy defines the desired configuration of your workloads and helps ensure compliance with company or regulatory security requirements. ASC Default policy is associated with every subscription by default. ASC default policy assignment is a set of security recommendations based on best practices. Enabling recommendations in ASC default policy ensures that Azure security center provides the ability to m onitor all of the supported recommendations and optionally allow automated action for a few of the supported recommendations.", "", "Microsoft Defender", "4.1 Establish and Maintain a Secure Configuration Process, 4.2 Establish and Maintain a Secure Configuration Process for Network Infrastructure, 13.11 Tune Security Event Alerting Thresholds", "TRUE", "TRUE", "TRUE", "4.1, 4.2", "4.1, 4.2", "4.1, 4.2, 13.11", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"2.1.15", "AZURE", "azure_002_cis_2-1-15", "ssphp_use_case_azure_002_cis_2-1-15", "AZURE 002 [CIS 2.1.15]", "Ensure that Auto provisioning of 'Log Analytics agent for Azure VMs' is Set to 'On'", "Level 1", "L1", "Enable automatic provisioning of the monitoring agent to collect security data.", "When Log Analytics agent for Azure VMs is turned on, Microsoft Defender for Cloud provisions the Microsoft Monitoring Agen t on all existing supported Azure virtual machines and any new ones that are created. The Microsoft Monitoring Agent scans for various security-related configurations and events such as system updates, OS vulnerabilities, endpoint protection, and provides alerts.", "", "Microsoft Defender", "7.5 Perform Automated Vulnerability Scans of Internal Enterprise Assets, 7.6 Perform Automated Vulnerability Scans of Externally -Exposed Enterprise Assets", "FALSE", "TRUE", "TRUE", "-", "7.5, 7.6", "7.5, 7.6", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"2.1.16", "AZURE", "azure_002_cis_2-1-16", "ssphp_use_case_azure_002_cis_2-1-16", "AZURE 002 [CIS 2.1.16]", "Ensure that Auto provisioning of 'Vulnerability assessment for machines' is Set to 'On'", "Level 2", "L2", "Enable automatic provisioning of vulnerability assessment for machines on both Azure and hybrid (Arc enab led) machines.", "Vulnerability assessment for machines scans for various security-related configurations and events such as system updates, OS vulnerabilities, and endpoint protection, then produces alerts on threat and vulnerability findings.", "Additional licensing is required and configuration of Azure Arc introduces complexity beyond this recommendation.", "Microsoft Defender", "7.5 Perform Automated Vulnerability Scans of Internal Enterprise Assets, 7.6 Perform Automated Vulnerability Scans of Externally -Exposed Enterprise Assets", "FALSE", "TRUE", "TRUE", "-", "7.5, 7.6", "7.5, 7.6", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"2.1.17", "AZURE", "azure_002_cis_2-1-17", "ssphp_use_case_azure_002_cis_2-1-17", "AZURE 002 [CIS 2.1.17]", "Ensure that Auto provisioning of 'Microsoft Defender for Containers components' is Set to 'On'", "Level 2", "L2", "Enable automatic provisioning of the Microsoft Defender for Containers components.", "As w ith any compute resource, Container environments require hardening and run-time protection to ensure safe operations and detection of threats and vulnerabilities.", "Microsoft Defender for Containers will require additional licensing.", "Microsoft Defender", "7.5 Perform Automated Vulnerability Scans of Internal Enterprise Assets, 7.6 Perform Automated Vulnerability Scans of Externally -Exposed Enterprise Assets", "FALSE", "TRUE", "TRUE", "-", "7.5, 7.6", "7.5, 7.6", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"2.1.18", "AZURE", "azure_002_cis_2-1-18", "ssphp_use_case_azure_002_cis_2-1-18", "AZURE 002 [CIS 2.1.18]", "Ensure That 'All users with the following roles' is set to 'Owner'", "Level 1", "L1", "Enable security alert emails to subscription owners.", "Enabling security alert emails to subscri ption owners ensures that they receive security alert emails from Microsoft. This ensures that they are aware of any potential security issues and can mitigate the risk in a timely fashion.", "", "Microsoft Defender", "17.2 Establish and Maint ain Contact Information for Reporting Security Incidents", "TRUE", "TRUE", "TRUE", "17.2", "17.2", "17.2", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"2.1.19", "AZURE", "azure_002_cis_2-1-19", "ssphp_use_case_azure_002_cis_2-1-19", "AZURE 002 [CIS 2.1.19]", "Ensure 'Additional email addresses' is Configured with a Security Contact Email", "Level 1", "L1", "Microsoft Defender for Cloud emails the subscription owners whenever a high-severity alert is triggered for their subscription. You should provide a security contact email address as an additional email address.", "Microsoft Defender for Cloud emai ls the Subscription Owner to notify them about security alerts. Adding your Security Contact's email address to the 'Additional email addresses' field ensures that your organization's Security Team is included in these alerts. This ensures that the proper people are aware of any potential compromise in order to mitigate the risk in a timely fashion.", "", "Microsoft Defender", "17.2 Establish and Maintain Contact Information for Reporting Security Incidents", "TRUE", "TRUE", "TRUE", "17.2", "17.2", "17.2", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"2.1.20", "AZURE", "azure_002_cis_2-1-20", "ssphp_use_case_azure_002_cis_2-1-20", "AZURE 002 [CIS 2.1.20]", "Ensure That 'Notify about alerts with the following severity' is Set to 'High'", "Level 1", "L1", "Enables emailing security alerts to the subscription owner or other designated security contact.", "Enabling security alert emails ensures that security alert emails are received from Microsoft. This ensures that the right people are aware of any p otential security issues and are able to mitigate the risk.", "", "Microsoft Defender", "13.11 Tune Security Event Alerting Thresholds", "FALSE", "FALSE", "TRUE", "-", "-", "13.11", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"2.1.21", "AZURE", "azure_002_cis_2-1-21", "ssphp_use_case_azure_002_cis_2-1-21", "AZURE 002 [CIS 2.1.21]", "Ensure that Microsoft Defender for Cloud Apps integration with Microsoft Defender for Cloud is Selected", "Level 2", "L2", "This integration setting enables Microsoft Defender for Cloud Apps (formerly 'Microsoft Cloud App Security' or 'MCAS'- see additional info) to communicate with Microsoft Defender for Cloud.", "Microsoft Defender for Cloud offers an additional laye r of protection by using Azure Resource Manager events, which is considered to be the control plane for Azure. By analyzing the Azure Resource Manager records, Microsoft Defender for Cloud detects unusual or potentially harmful operations in the Azure subs cription environment. Several of the preceding analytics are powered by Microsoft Defender for Cloud Apps. To benefit from these analytics, subscription must have a Cloud App Security license. Microsoft Defender for Cloud Apps works only with Standard Tier subscriptions.", "Microsoft Defender for Cloud Apps works with Standard pricing tier Subscription. Choosing the Standard pricing tier of Microsoft Defender for Cloud incurs an additional cost per resource.", "Microsoft Defender", "7.5 Perform Automated Vulnerability Scans of Internal Enterprise Assets, 7.6 Perform Automated Vulnerability Scans of Externally -Exposed Enterprise Assets, 13.10 Perform Application Layer Filtering, 16.11 Leverage Vetted Modules or Services for Application Security Components", "FALSE", "TRUE", "TRUE", "-", "7.5, 7.6, 16.11", "7.5, 7.6, 13.10, 16.11", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"2.1.22", "AZURE", "azure_002_cis_2-1-22", "ssphp_use_case_azure_002_cis_2-1-22", "AZURE 002 [CIS 2.1.22]", "Ensure that Microsoft Defender for Endpoint integration with Microsoft Defender for Cloud is selected", "Level 2", "L2", "This integration setting enables Microsoft Defender for Endpoint (formerly 'Advanced Threat Protection' or 'ATP' or 'WDATP'- see additional info) to communicate with Microsoft Defender for Cloud. IMPORTANT: When enabling integration between DfE & DfC it needs to be taken into account that this will have some side effects that may be undesirable . 1. For server 2019 & above if defender is installed (default for these server SKU's) this will trigger a deployment of the new unified agent and link to any of the extended configuration in the Defender portal. 2. If the new unified agent is required for serve r SKU's of Win 2016 or Linux and lower there is additional integration that needs to be switched on and agents need to be aligned.", "Microsoft Defender for Endpoint integration brings comprehensive Endpoint Detection and Response (EDR) capabilitie s within Microsoft Defender for Cloud. This integration helps to spot abnormalities, as well as detect and respond to advanced attacks on endpoints monitored by Microsoft Defender for Cloud. MDE works only with Standard Tier subscriptions.", "Microsof t Defender for Endpoint works with Standard pricing tier Subscription. Choosing the Standard pricing tier of Microsoft Defender for Cloud incurs an additional cost per resource.", "Microsoft Defender", "7.5 Perform Automated Vulnerability Scans of Internal Enterprise Assets, 10.1 Deploy and Maintain Anti -Malware Software, 10.6 Centrally Manage Anti -Malware Software, 13.2 Deploy a Host -Based Intrusion Detection Solution", "TRUE", "TRUE", "TRUE", "10.1", "7.5, 10.1, 10.6, 13.2", "7.5, 10.1, 10.6, 13.2", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"2.2.1", "AZURE", "azure_002_cis_2-2-1", "ssphp_use_case_azure_002_cis_2-2-1", "AZURE 002 [CIS 2.2.1]", "Ensure That Microsoft Defender for IoT Hub Is Set To 'On'", "Level 2", "L2", "Microsoft Defender for IoT acts as a central security hub for IoT devices within your organization.", "IoT devices are very rarely patched and can be potential attack vectors for enterprise networks. Updating their network configuration to use a ce ntral security hub allows for detection of these breaches.", "Enabling Microsoft Defender for IoT will incur additional charges dependent on the level of usage.", "Microsoft Defender", "7.5 Perform Automated Vulnerability Scans of Internal Enterprise Assets, 13.6 Collect Network Traffic Flo w Logs", "FALSE", "TRUE", "TRUE", "-", "7.5, 13.6", "7.5, 13.6", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"3.1", "AZURE", "azure_003_cis_3-1", "ssphp_use_case_azure_003_cis_3-1", "AZURE 003 [CIS 3.1]", "Ensure that 'Secure transfer required' is set to 'Enabled'", "Level 1", "L1", "Enable data encryption in transit.", "The secure transfer option enhances the security of a storage account by only allowing requests to the storage account by a secure connection. For example, when calling REST APIs to access storage accounts, the connection must use HTTPS. Any requests using HTTP will be rejected when 'secure transfer required' is enabled. When using the Azure files service, connection without encryptio n will fail, including scenarios using SMB 2.1, SMB 3.0 without encryption, and some flavors of the Linux SMB client. Because Azure storage doesn't support HTTPS for custom domain names, this option is not applied when using a custom domain name.", "", "Storage Accounts", "3.10 Encrypt Sensitive Data in Transit", "FALSE", "TRUE", "TRUE", "-", "3.10", "3.10", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"3.2", "AZURE", "azure_003_cis_3-2", "ssphp_use_case_azure_003_cis_3-2", "AZURE 003 [CIS 3.2]", "En sure that 'Enable Infrastructure Encryption' for Each Storage Account in Azure Storage is Set to 'enabled'", "Level 2", "L2", "Enabling encryption at the hardware level on top of the default software encryption for Storage Accounts accessing Azure storage solutions.", "Azure Storage automatically encrypts all data in a storage account at the network level using 256-bit AES encryption, which is one of the strongest, FIPS 140-2-compliant block ciphers available. Customers who require higher levels of assurance that their d ata is secure can also enable 256-bit AES encryption at the Azure Storage infrastructure level for double encryption. Double encryption of Azure Storage data protects against a scenario where one of the encryption algorithms or keys may be compromised. Similarly, data is encrypted even before network transmission and in all backups. In this scenario, the additional layer of encryption continues to protect your data. For the most secure implementation of key based encryption, it is recommended to use a Custo mer Managed asymmetric RSA 2048 Key in Azure Key Vault.", "The read and write speeds to the storage will be impacted if both default encryption and Infrastructure Encryption are checked, as a secondary form of encryption requires more resource overhea d for the cryptography of information. This performance impact should be considered in an analysis for justifying use of the feature in your environment. Customer-managed keys are recommended for the most secure implementation, leading to overhead of key m anagement. The key will also need to be backed up in a secure location, as loss of the key will mean loss of the information in the storage.", "Storage Accounts", "3.11 Encrypt Sensitive Data at Rest", "FALSE", "TRUE", "TRUE", "-", "3.11", "3.11", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"3.3", "AZURE", "azure_003_cis_3-3", "ssphp_use_case_azure_003_cis_3-3", "AZURE 003 [CIS 3.3]", "Ensure that 'Enable key rotation reminders' is enabled for each Storage Account", "Level 1", "L1", "Access Keys authenticate application access requests to data contained in Storage Accounts. A periodic rotation of t hese keys is recommended to ensure that potentially compromised keys cannot result in a long-term exploitable credential. The 'Rotation Reminder' is an automatic reminder feature for a manual procedure.", "Reminders such as those generated by this recommendation will help maintain a regular and healthy cadence for activities which improve the overall efficacy of a security program. Cryptographic key rotation periods will vary depending on your organization's security requirements and the type of dat a which is being stored in the Storage Account. For example, PCI DSS mandates that cryptographic keys be replaced or rotated 'regularly,' and advises that keys for static data stores be rotated every 'few months.' For the purposes of this recommendation, 9 0 days will prescribed for the reminder. Review and adjustment of the 90 day period is recommended, and may even be necessary. Your organization's security requirements should dictate the appropriate setting.", "This recommendation only creates a peri odic reminder to regenerate access keys. Regenerating access keys can affect services in Azure as well as the organization's applications that are dependent on the storage account. All clients that use the access key to access the storage account must be u pdated to use the new key.", "Storage Accounts", "4.1 Establish and Maintain a Secure Configuration Process, 13.11 Tune Security Event Alerting Thresholds", "TRUE", "TRUE", "TRUE", "4.1", "4.1", "4.1, 13.11", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"3.4", "AZURE", "azure_003_cis_3-4", "ssphp_use_case_azure_003_cis_3-4", "AZURE 003 [CIS 3.4]", "Ensure that Storage Account Access Keys are Periodically Regenerated", "Level 1", "L1", "For increased security, regenerate storage account access keys periodically.", "When a storage account is created, Azur e generates two 512-bit storage access keys which are used for authentication when the storage account is accessed. Rotating these keys periodically ensures that any inadvertent access or exposure does not result from the compromise of these keys. Cryptogr aphic key rotation periods will vary depending on your organization's security requirements and the type of data which is being stored in the Storage Account. For example, PCI DSS mandates that cryptographic keys be replaced or rotated 'regularly,' and adv ises that keys for static data stores be rotated every 'few months.' For the purposes of this recommendation, 90 days will prescribed for the reminder. Review and adjustment of the 90 day period is recommended, and may even be necessary. Your organization' s security requirements should dictate the appropriate setting.", "Regenerating access keys can affect services in Azure as well as the organization's applications that are dependent on the storage account. All clients who use the access key to access the storage account must be updated to use the new key.", "Storage Accounts", "4.6 Securely Manage Enterprise Assets and Software, 6.2 Establish an Access Revoking Process", "TRUE", "TRUE", "TRUE", "4.6, 6.2", "4.6, 6.2", "4.6, 6.2", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"3.5", "AZURE", "azure_003_cis_3-5", "ssphp_use_case_azure_003_cis_3-5", "AZURE 003 [CIS 3.5]", "Ensure Storage Logging is Enabled for Queue Service for 'Read', 'Write', and 'Delete' requests", "Level 2", "L2", "The Storage Queue service stores messages that may be read by any client who has access to the sto rage account. A queue can contain an unlimited number of messages, each of which can be up to 64KB in size using version 2011-08-18 or newer. Storage Logging happens server-side and allows details for both successful and failed requests to be recorded in t he storage account. These logs allow users to see the details of read, write, and delete operations against the queues. Storage Logging log entries contain the following information about individual requests: Timing information such as start time, end-to-end latency, and server latency, authentication details, concurrency information, and the sizes of the request and response messages.", "Storage Analytics logs contain detailed information about successful and failed requests to a storage service. T his information can be used to monitor individual requests and to diagnose issues with a storage service. Requests are logged on a best-effort basis. Storage Analytics logging is not enabled by default for your storage account.", "Enabling this settin g can have a high impact on the cost of the log analytics service and data storage used by logging more data per each request. Do not enable this without determining your need for this level of logging, and do not forget to check in on data usage and proje cted cost. Some users have seen their logging costs increase from $10 per month to $10,000 per month.", "Storage Accounts", "8.5 Collect Detailed Audit Logs", "FALSE", "TRUE", "TRUE", "-", "8.5", "8.5", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"3.6", "AZURE", "azure_003_cis_3-6", "ssphp_use_case_azure_003_cis_3-6", "AZURE 003 [CIS 3.6]", "Ensure that Shared Access Signature Tokens Expire Within an Hour", "Level 1", "L1", "Expire shared access signature tokens within an hour.", "A shared access signature (SAS) i s a URI that grants restricted access rights to Azure Storage resources. A shared access signature can be provided to clients who should not be trusted with the storage account key but for whom it may be necessary to delegate access to certain storage acco unt resources. Providing a shared access signature URI to these clients allows them access to a resource for a specified period of time. This time should be set as low as possible and preferably no longer than an hour.", "", "Storage Accounts", "6.2 Establish an Access Revoking Process", "TRUE", "TRUE", "TRUE", "6.2", "6.2", "6.2", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"3.7", "AZURE", "azure_003_cis_3-7", "ssphp_use_case_azure_003_cis_3-7", "AZURE 003 [CIS 3.7]", "Ensure that 'Public access level' is disabled for storage accounts with blob containers", "Level 1", "L1", "Disallowing public access for a storage account overrides the public access settings for individual containers in that storage account.", "The default configuration for a storage account permits a user with appropriate permissions to configure publ ic (anonymous) access to containers and blobs in a storage account. Keep in mind that public access to a container is always turned off by default and must be explicitly configured to permit anonymous requests. It grants read-only access to these resources without sharing the account key, and without requiring a shared access signature. It is recommended not to provide anonymous access to blob containers until, and unless, it is strongly desired. A shared access signature token or Azure AD RBAC should be us ed for providing controlled and timed access to blob containers. If no anonymous access is needed on any container in the storage account, it's recommended to set allowBlobPublicAccess false at the account level, which forbids any container to accept anony mous access in the future.", "Access will have to be managed using shared access signatures or via Azure AD RBAC.", "Storage Accounts", "3.3 Configure Data Access Control Lists", "TRUE", "TRUE", "TRUE", "3.3", "3.3", "3.3", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"3.8", "AZURE", "azure_003_cis_3-8", "ssphp_use_case_azure_003_cis_3-8", "AZURE 003 [CIS 3.8]", "Ensure Default Network Access Rule for Storage Accounts is Set to Deny", "Level 1", "L1", "Restricting default network access helps to provide a new layer of security, since storage accounts accept connections fro m clients on any network. To limit access to selected networks, the default action must be changed.", "Storage accounts should be configured to deny access to traffic from all networks (including internet traffic). Access can be granted to traffic from specific Azure Virtual networks, allowing a secure network boundary for specific applications to be built. Access can also be granted to public internet IP address ranges to enable connections from specific internet or on-premises clients. When networ k rules are configured, only applications from allowed networks can access a storage account. When calling from an allowed network, applications continue to require proper authorization (a valid access key or SAS token) to access the storage account.", "All allowed networks will need to be whitelisted on each specific network, creating administrative overhead. This may result in loss of network connectivity, so do not turn on for critical resources during business hours.", "Storage Accounts", "12.2 Establish and Maintain a Secure Network Architecture", "FALSE", "TRUE", "TRUE", "-", "12.2", "12.2", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"3.9", "AZURE", "azure_003_cis_3-9", "ssphp_use_case_azure_003_cis_3-9", "AZURE 003 [CIS 3.9]", "Ensure 'Allow Azure services on the trusted services list to access this storage account' is Enabled for Storage Account Access", "Level 2", "L2", "Some Azure services that interact with storage accounts operate from networks that can't be granted access through network rules. To help this type of service work as intended, allow the set of trusted Azure services to bypass the network rules. These services will then use strong authentication to access the storage account. If the Allow trusted Azure services exception is enabled, the following services are granted access to the storage account: Azure Backup, Azure Site Recovery, Azure DevTest Labs, Azure Event Grid, Azure Event Hubs, Azure Networking, Azure Monitor, and Azure SQL Data Warehouse (when registered in the subscription).", "Turning on firewall rules for storage account will block access to incoming requests for data, including from other Azure services. We can re-enable this functionality by enabling 'Trusted Azure Services' through networking exceptions.", "This creates authentication credentials for services that need access to storage resources so that services will no longer need to communicate via network request. There may be a temporary loss of communication as you set each Storage Account. It is recomm ended to not do this on mission-critical resources during business hours.", "Storage Accounts", "3.3 Configure Data Access Control Lists, 13.5 Manage Access Control for Remote Assets", "TRUE", "TRUE", "TRUE", "3.3", "3.3, 13.5", "3.3, 13.5", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"3.10", "AZURE", "azure_003_cis_3-10", "ssphp_use_case_azure_003_cis_3-10", "AZURE 003 [CIS 3.10]", "Ensure Private Endpoints are used to access Storage Accounts", "Level 1", "L1", "Use private endpoints for your Azure Storage accounts to allow clients and services to securely access data located over a network via an encrypted Private Link. To do this, the private endpoint uses an IP address from the VNet for each service. Network traffic between disparate services securely traverses encrypted over the VNet. This VNet can also link addressing space, extending yo ur network and accessing resources on it. Similarly, it can be a tunnel through public networks to connect remote infrastructures together. This creates further security through segmenting network traffic and preventing outside sources from accessing it.", "Securing traffic between services through encryption protects the data from easy interception and reading.", "There is no cost in deploying VNets between Azure resources. If improperly implemented, it may result in loss of critical network t raffic.", "Storage Accounts", "12.2 Establish and Maintain a Secure Network Architecture", "FALSE", "TRUE", "TRUE", "-", "12.2", "12.2", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"3.11", "AZURE", "azure_003_cis_3-11", "ssphp_use_case_azure_003_cis_3-11", "AZURE 003 [CIS 3.11]", "Ensure Soft Delete is Enabled for Azure Containers and Blob Storage", "Level 1", "L1", "The Azure Storage blobs contain data like ePHI or Financial, which can be secret or personal. Data that is erroneously modified or deleted by an application or other storage account user will cause data loss or unavailability. It is recommended that both A zure Containers with attached Blob Storage and standalone containers with Blob Storage be made recoverable by enabling the soft delete configuration. This is to save and recover data when blobs or blob snapshots are deleted.", "Containers and Blob Storage data can be incorrectly deleted. An attacker/malicious user may do this deliberately in order to cause disruption. Deleting an Azure Storage blob causes immediate data loss. Enabling this configuration for Azure storage ensures that even if blobs/d ata were deleted from the storage account, Blobs/data objects are recoverable for a particular time which is set in the 'Retention policies,' ranging from 7 days to 365 days.", "Additional storage costs may be incurred as snapshots are retained.", "Storage Accounts", "11.1 Establish and Maintain a Data Recovery Process", "TRUE", "TRUE", "TRUE", "11.1", "11.1", "11.1", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"3.12", "AZURE", "azure_003_cis_3-12", "ssphp_use_case_azure_003_cis_3-12", "AZURE 003 [CIS 3.12]", "Ensure Storage for Critical Data are Encrypted with Customer Managed Keys", "Level 2", "L2", "Enable sensitive data encryption at rest using Customer Managed Keys rather than Microsoft Managed keys.", "By default, data in the storage account is encrypted using Microsoft Managed Keys at rest. All Azure Storage resources are encrypted, includ ing blobs, disks, files, queues, and tables. All object metadata is also encrypted. If you want to control and manage this encryption key yourself, however, you can specify a customer-managed key. That key is used to protect and control access to the key t hat encrypts your data. You can also choose to automatically update the key version used for Azure Storage encryption whenever a new version is available in the associated Key Vault.", "If the key expires by setting the 'activation date' and 'expirati on date', the user must rotate the key manually. Using Customer Managed Keys may also incur additional man-hour requirements to create, store, manage, and protect the keys as needed.", "Storage Accounts", "3.11 Encrypt Sensitive Data at Rest", "FALSE", "TRUE", "TRUE", "-", "3.11", "3.11", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"3.13", "AZURE", "azure_003_cis_3-13", "ssphp_use_case_azure_003_cis_3-13", "AZURE 003 [CIS 3.13]", "Ensure Storage logging is Enabled for Blob Service for 'Read', 'Write', and 'Delete' requests", "Level 2", "L2", "The Storage Blob service provides scalable, cost-efficient object storage in the cloud. Storage Logging happens server-side and allows details for both successful and failed requests to be recorded in the storage account. These logs allow users to see the details of read, write, and delete operations against the blobs. Storage Logging log entries contain the following information about individual requests: timing information such as start time, end-to-end latency, and server latency; authentication details; concurrency information; and the sizes of the request and response messages.", "Storage Analytics logs contain detailed information about successful and failed requests to a storage service. This information can be used to monitor each individual request to a storage service for increased security or diagnostics. Requests are logged on a best-effort basis. Storage Analytics logging is not enabled by default for your storage account.", "Being a level 2, enabling this setting can have a high imp act on the cost of data storage used for logging more data per each request. Do not enable this without determining your need for this level of logging or forget to check in on data usage and projected cost.", "Storage Accounts", "8.5 Collect Detailed Audit Logs", "FALSE", "TRUE", "TRUE", "-", "8.5", "8.5", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"3.14", "AZURE", "azure_003_cis_3-14", "ssphp_use_case_azure_003_cis_3-14", "AZURE 003 [CIS 3.14]", "Ensure Storage Logging is Enabled for Table Service for 'Read', 'Write', and 'Delete' Requests", "Level 2", "L2", "Azure Table storage is a service that stores structured NoSQL data in the cloud, providing a key/attribute store with a schema-less design. Storage Logging happens server-side and allows details for both successful and failed requests to be recorded in the storage account. These logs allow users to see the details of read, write, and delete operations against the tables. Storage Logging log entries contain the following information about individual requests: timing information such as start time, end-to-end latency, and server latency; authentication details; concurrency information; and the sizes of the request and response messages.", "Storage Analytics logs contain detailed information about successful and failed requests to a storage service. Thi s information can be used to monitor each individual request to a storage service for increased security or diagnostics. Requests are logged on a best-effort basis. Storage Analytics logging is not enabled by default for your storage account.", "Being a level 2, enabling this setting can have a high impact on the cost of data storage used for logging more data per each request. Do not enable this without determining your need for this level of logging or forget to check in on data usage and projected cost.", "Storage Accounts", "8.5 Collect Detailed Audit Logs", "FALSE", "TRUE", "TRUE", "-", "8.5", "8.5", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"3.15", "AZURE", "azure_003_cis_3-15", "ssphp_use_case_azure_003_cis_3-15", "AZURE 003 [CIS 3.15]", "Ensure the "Minimum TLS version" for storage accounts is set to "Version 1.2"", "Level 1", "L1", "In some cases, Azure Storage sets the minimum TLS version to be version 1.0 by default. TLS 1.0 is a legacy version and has known vulnerabilities. This minimum TLS version can be configured to be later protocols such as TLS 1.2.", "TLS 1.0 has know n vulnerabilities and has been replaced by later versions of the TLS protocol. Continued use of this legacy protocol affects the security of data in transit.", "When set to TLS 1.2 all requests must leverage this version of the protocol. Applications leveraging legacy versions of the protocol will fail.", "Storage Accounts", "3.10 Encrypt Sensitive Data in Transit", "FALSE", "TRUE", "TRUE", "-", "3.10", "3.10", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"4.1.1", "AZURE", "azure_004_cis_4-1-1", "ssphp_use_case_azure_004_cis_4-1-1", "AZURE 004 [CIS 4.1.1]", "Ensure that 'Auditing' is set to 'On'", "Level 1", "L1", "Enable auditing on SQL Servers.", "The Azure platform allows a SQL server to be created as a service. Ena bling auditing at the server level ensures that all existing and newly created databases on the SQL server instance are audited. Auditing policy applied on the SQL database does not override auditing policy and settings applied on the particular SQL server where the database is hosted. Auditing tracks database events and writes them to an audit log in the Azure storage account. It also helps to maintain regulatory compliance, understand database activity, and gain insight into discrepancies and anomalies th at could indicate business concerns or suspected security violations.", "", "Database Services", "8.5 Collect Detailed Audit Logs", "FALSE", "TRUE", "TRUE", "-", "8.5", "8.5", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"4.1.2", "AZURE", "azure_004_cis_4-1-2", "ssphp_use_case_azure_004_cis_4-1-2", "AZURE 004 [CIS 4.1.2]", "Ensure no Azure SQL Databases allow ingress from 0.0.0.0/0 (ANY IP)", "Level 1", "L1", "Ensure that no SQL Databases allow ingress from 0.0.0.0/0 (ANY IP).", "Azure SQL Server includes a firewall to block access to unauthorized connections. More granular IP addresses can be defined by referencing the range of addresses available from specific datacenters. By default, for a SQL server, a Firewall exists with StartIp of 0.0.0.0 and EndIP of 0.0.0.0 allowing access to all the Azure services. Additionally, a custom rule can be set up with StartIp of 0.0.0.0 and EndIP of 255.255.255.255 all owing access from ANY IP over the Internet. In order to reduce the potential attack surface for a SQL server, firewall rules should be defined with more granular IP addresses by referencing the range of addresses available from specific datacenters.", "Disabling Allow Azure services and resources to access this server will break all connections to SQL server and Hosted Databases unless custom IP specific rules are added in Firewall Policy.", "Database Services", "3.3 Configure Data Access Control Lists", "TRUE", "TRUE", "TRUE", "3.3", "3.3", "3.3", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"4.1.3", "AZURE", "azure_004_cis_4-1-3", "ssphp_use_case_azure_004_cis_4-1-3", "AZURE 004 [CIS 4.1.3]", "Ensure SQL server's Transparent Data Encryption (TDE) protector is encrypted with Customer-managed key", "Level 2", "L2", "Transparent Data Encryption (TDE) with Customer-managed key support provides increased transparency and control over the TDE Protector, increased security with an HSM-backed external service, and promotion of separation of duties. With TDE, data is encrypt ed at rest with a symmetric key (called the database encryption key) stored in the database or data warehouse distribution. To protect this data encryption key (DEK) in the past, only a certificate that the Azure SQL Service managed could be used. Now, wit h Customer-managed key support for TDE, the DEK can be protected with an asymmetric key that is stored in the Azure Key Vault. The Azure Key Vault is a highly available and scalable cloud-based key store which offers central key management, leverages FIPS 140-2 Level 2 validated hardware security modules (HSMs), and allows separation of management of keys and data for additional security. Based on business needs or criticality of data/databases hosted on a SQL server, it is recommended that the TDE protecto r is encrypted by a key that is managed by the data owner (Customer-managed key).", "Customer-managed key support for Transparent Data Encryption (TDE) allows user control of TDE encryption keys and restricts who can access them and when. Azure Key Vault, Azure's cloud-based external key management system, is the first key management service where TDE has integrated support for Customer-managed keys. With Customer-managed key support, the database encryption key is protected by an asymmetric key sto red in the Key Vault. The asymmetric key is set at the server level and inherited by all databases under that server.", "Once TDE protector is encrypted with a Customer-managed key, it transfers entire responsibility of respective key management on to you, and hence you should be more careful about doing any operations on the particular key in order to keep data from corresponding SQL server and Databases hosted accessible. When deploying Customer Managed Keys, it is prudent to ensure that you also dep loy an automated toolset for managing these keys (this should include discovery and key rotation), and Keys should be stored in an HSM or hardware backed keystore, such as Azure Key Vault. Page 241 As far as toolsets go, check with your cryptographic key provider, as they may well provide one as an add-on to their service.", "Database Services", "3.11 Encrypt Sensitive Data at Rest", "FALSE", "TRUE", "TRUE", "-", "3.11", "3.11", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"4.1.4", "AZURE", "azure_004_cis_4-1-4", "ssphp_use_case_azure_004_cis_4-1-4", "AZURE 004 [CIS 4.1.4]", "Ensure that Azure Active Directory Admin is Configured for SQL Servers", "Level 1", "L1", "Use Azure Active Directory Authentication for authentication with SQL Database to manage credentials in a single place.", "Azure Active Directory authentication is a mechanism to connect to Microsoft Azure SQL Database and SQL Data Warehouse by using identities in Azure Active Directory (Azure AD). With Azure AD authentication, identities of database users and other Microsoft services can be managed in one central location. Central ID management provides a single place to manage database users and simplifies permission management. - It provides an alternative to SQL Server authentication. - Helps stop the proliferation of user iden tities across database servers. - Allows password rotation in a single place. - Customers can manage database permissions using external (AAD) groups. - It can eliminate storing passwords by enabling integrated Windows authentication and other forms of authentic ation supported by Azure Active Directory. - Azure AD authentication uses contained database users to authenticate identities at the database level. - Azure AD supports token-based authentication for applications connecting to SQL Database. - Azure AD authentica tion supports ADFS (domain federation) or native user/password authentication for a local Azure Active Directory without domain synchronization. - Azure AD supports connections from SQL Server Management Studio that use Active Directory Universal Authenticat ion, which includes Multi-Factor Authentication (MFA). MFA includes strong authentication with a range of easy verification options  phone call, text message, smart cards with pin, or mobile app notification.", "This will create administrative overhe ad with user account and permission management. For further security on these administrative accounts, you may want to consider higher tiers of AAD which support features like Multi Factor Authentication, that will cost more.", "Database Services", "5.6 Centralize Account Management", "FALSE", "TRUE", "TRUE", "-", "5.6", "5.6", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"4.1.5", "AZURE", "azure_004_cis_4-1-5", "ssphp_use_case_azure_004_cis_4-1-5", "AZURE 004 [CIS 4.1.5]", "Ensure that 'Data encryption' is set to 'On' on a SQL Database", "Level 1", "L1", "Enable Transparent Data Encryption on every SQL server.", "Azure SQL Database transparent data encryption helps protect against the threat of malicious activity by performing real-time encryption and decryption of the database, associated backups, and transaction log files at rest without requiring changes to the application.", "", "Database Services", "3.11 Encrypt Sensitive Data at Rest", "FALSE", "TRUE", "TRUE", "-", "3.11", "3.11", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"4.1.6", "AZURE", "azure_004_cis_4-1-6", "ssphp_use_case_azure_004_cis_4-1-6", "AZURE 004 [CIS 4.1.6]", "Ensure that 'Auditing' Retention is 'greater than 90 days'", "Level 1", "L1", "SQL Server Audit Retention should be configured to be greater than 90 days.", "Audit Logs can be used to check for anomalies and give insight into suspected breaches or misuse of information and access.", "", "Database Services", "8.3 Ensure Adequate Audit Log Storage", "TRUE", "TRUE", "TRUE", "8.3", "8.3", "8.3", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"4.2.1", "AZURE", "azure_004_cis_4-2-1", "ssphp_use_case_azure_004_cis_4-2-1", "AZURE 004 [CIS 4.2.1]", "Ensure that Microsoft Defender for SQL is set to 'On' f or critical SQL Servers", "Level 2", "L2", "Enable 'Microsoft Defender for SQL' on critical SQL Servers.", "Microsoft Defender for SQL is a unified package for advanced SQL security capabilities. Microsoft Def ender is available for Azure SQL Database, Azure SQL Managed Instance, and Azure Synapse Analytics. It includes functionality for discovering and classifying sensitive data, surfacing and mitigating potential database vulnerabilities, and detecting anomalo us activities that could indicate a threat to your database. It provides a single go-to location for enabling and managing these capabilities.", "Microsoft Defender for SQL is a paid feature and will incur additional cost for each SQL server.", "Database Services", "7.5 Perform Automated Vulnerability Scans of Internal Enterprise Assets, 7.6 Perform Automated Vulnerability Scans of Externally -Exposed Enterprise Assets", "FALSE", "TRUE", "TRUE", "-", "7.5, 7.6", "7.5, 7.6", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"4.2.2", "AZURE", "azure_004_cis_4-2-2", "ssphp_use_case_azure_004_cis_4-2-2", "AZURE 004 [CIS 4.2.2]", "Ensure that Vulnerability Assessment (VA) is enabled on a SQL server by setting a Storage Account", "Level 2", "L2", "Enable Vulnerabil ity Assessment (VA) service scans for critical SQL servers and corresponding SQL databases.", "Enabling Microsoft Defender for SQL server does not enables Vulnerability Assessment capability for individual SQL databases unless storage account is se t to store the scanning data and reports. The Vulnerability Assessment service scans databases for known security vulnerabilities and highlights deviations from best practices, such as misconfigurations, excessive permissions, and unprotected sensitive dat a. Results of the scan include actionable steps to resolve each issue and provide customized remediation scripts where applicable. Additionally, an assessment report can be customized by setting an acceptable baseline for permission configurations, feature configurations, and database settings.", "Enabling the Microsoft Defender for SQL features will incur additional costs for each SQL server.", "Database Services", "7.5 Perform Automated Vulnerability Scans of Internal Enterprise Assets, 7.6 Perform Automated Vulnerability Scans of Externally -Exposed Enterprise Assets", "FALSE", "TRUE", "TRUE", "-", "7.5, 7.6", "7.5, 7.6", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"4.2.3", "AZURE", "azure_004_cis_4-2-3", "ssphp_use_case_azure_004_cis_4-2-3", "AZURE 004 [CIS 4.2.3]", "Ensure that Vulnerability Assessment (VA) setting 'Periodic recurring scans' is set to 'on' for each SQL server", "Level 2", "L2", "Enable Vulnerability Assessment (VA) Periodic recurring scans for critical SQL servers and corresponding SQL databases.", "VA setting 'Periodic recurring scans' schedules periodic (weekly) vulnerability scanning for the SQL server and corresponding Databases. Periodic and regular vulnerability scanning provides risk visibilit y based on updated known vulnerability signatures and best practices.", "Enabling the Azure Defender for SQL feature will incur additional costs for each SQL server.", "Database Services", "7.5 Perform Automated Vulnerability Scans of Internal Enterprise Assets, 7.6 Perform Automated Vulnerability Scans of Externally -Exposed Enterprise Assets", "FALSE", "TRUE", "TRUE", "-", "7.5, 7.6", "7.5, 7.6", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"4.2.4", "AZURE", "azure_004_cis_4-2-4", "ssphp_use_case_azure_004_cis_4-2-4", "AZURE 004 [CIS 4.2.4]", "Ensure that Vulnerability Assessment (VA) setting 'Send scan reports to' is configured for a SQL server", "Level 2", "L2", "Configure 'Send scan reports to' with email addresses of concerned data owners/stakehol ders for a critical SQL servers.", "Vulnerability Assessment (VA) scan reports and alerts will be sent to email addresses configured at 'Send scan reports to'. This may help in reducing time required for identifying risks and taking corrective meas ures.", "Enabling the Microsoft Defender for SQL features will incur additional costs for each SQL server.", "Database Services", "7.5 Perform Automated Vulnerability Scans of Internal Enterprise Assets, 7.6 Perform Automated Vulnerabil ity Scans of Externally -Exposed Enterprise Assets", "FALSE", "TRUE", "TRUE", "-", "7.5, 7.6", "7.5, 7.6", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"4.2.5", "AZURE", "azure_004_cis_4-2-5", "ssphp_use_case_azure_004_cis_4-2-5", "AZURE 004 [CIS 4.2.5]", "Ensure that Vulnerability Assessmen t (VA) setting 'Also send email notifications to admins and subscription owners' is set for each SQL Server", "Level 1", "L1", "Enable Vulnerability Assessment (VA) setting 'Also send email notifications to admins and subscription owners'.", "VA scan reports and alerts will be sent to admins and subscription owners by enabling setting 'Also send email notifications to admin s and subscription owners'. This may help in reducing time required for identifying risks and taking corrective measures.", "Enabling the Microsoft Defender for SQL features will incur additional costs for each SQL server.", "Database Services", "7.5 Perform Automated Vulnerability Scans of Internal Enterprise Assets, 7.6 Perform Automated Vulnerability Scans of Externally -Exposed Enterprise Assets", "FALSE", "TRUE", "TRUE", "-", "7.5, 7.6", "7.5, 7.6", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"4.3.1", "AZURE", "azure_004_cis_4-3-1", "ssphp_use_case_azure_004_cis_4-3-1", "AZURE 004 [CIS 4.3.1]", "Ensure 'Enforce SSL connection' is set to 'ENABLED' for PostgreSQL Database Server", "Level 1", "L1", "Enable SSL connection on PostgreSQL Servers.", "SSL connectivity helps to provide a new layer of security by connecting database server to client applications using Secure Sockets Layer (SSL). Enforcing SSL connections between database server and client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and application.", "", "Database Services", "3.10 Encrypt Sensitive Data in Transit", "FALSE", "TRUE", "TRUE", "-", "3.10", "3.10", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"4.3.2", "AZURE", "azure_004_cis_4-3-2", "ssphp_use_case_azure_004_cis_4-3-2", "AZURE 004 [CIS 4.3.2]", "Ensure Server Parameter 'log_checkpoints' is set to 'ON' for PostgreSQL Database Server", "Level 1", "L1", "Enable log_checkpoints on PostgreSQL Servers .", "Enabling log_checkpoints helps the PostgreSQL Database to Log each checkpoint in turn generates query and error logs. However, access to transaction logs is not supported. Query and error logs can be used to identify, troubleshoot, and repair configuration errors and sub-optimal p erformance.", "", "Database Services", "8.2 Collect Audit Logs", "TRUE", "TRUE", "TRUE", "8.2", "8.2", "8.2", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"4.3.3", "AZURE", "azure_004_cis_4-3-3", "ssphp_use_case_azure_004_cis_4-3-3", "AZURE 004 [CIS 4.3.3]", "Ensure server parameter 'log_connections' is set to 'ON' for Postgr eSQL Database Server", "Level 1", "L1", "Enable log_connections on PostgreSQL Servers .", "Enabling log_connections helps PostgreSQL Database to log attempted connection to the server, as well as successful completion of client authentication. Log data can be used to identify, troubleshoot, and repair configuration errors and suboptimal performance.", "", "Database Services", "8.2 Collect Audit Logs", "TRUE", "TRUE", "TRUE", "8.2", "8.2", "8.2", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"4.3.4", "AZURE", "azure_004_cis_4-3-4", "ssphp_use_case_azure_004_cis_4-3-4", "AZURE 004 [CIS 4.3.4]", "Ensure server parameter 'log_disconnections' is set to 'ON' for PostgreSQL Database Server", "Level 1", "L1", "Enable log_disconnections on PostgreSQL Servers .", "Enabling log_disconnections helps Postgr eSQL Database to Logs end of a session , including duration, which in turn generates query and error logs. Query and error logs can be used to identify, troubleshoot, and repair configuration errors and sub-optimal performance.", "Enabling this setting will enable a log of all disconnections. If this is enabled for a high traffic server, the log may grow exponentially.", "Database Services", "8.2 Collect Audit Logs", "TRUE", "TRUE", "TRUE", "8.2", "8.2", "8.2", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"4.3.5", "AZURE", "azure_004_cis_4-3-5", "ssphp_use_case_azure_004_cis_4-3-5", "AZURE 004 [CIS 4.3.5]", "Ensure server parameter 'connection_throttling' is set to 'ON' for PostgreSQL Database Server", "Level 1", "L1", "Enable connection_throttling on PostgreSQL Servers .", "Enabling connection_throttling helps the PostgreSQL Database to Set the verbosity of logged messages . This in turn generates query and error logs with respect to concurrent connections that could lead to a successful Denial of Service (DoS) attack by exhausting connection resources. A syst em can also fail or be degraded by an overload of legitimate users. Query and error logs can be used to identify, troubleshoot, and repair configuration errors and sub-optimal performance.", "", "Database Services", "8.2 Collect Audit Logs", "TRUE", "TRUE", "TRUE", "8.2", "8.2", "8.2", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"4.3.6", "AZURE", "azure_004_cis_4-3-6", "ssphp_use_case_azure_004_cis_4-3-6", "AZURE 004 [CIS 4.3.6]", "Ensure Server Parameter 'log_retention_days' is greater than 3 days for PostgreSQL Database Server", "Level 1", "L1", "Ensure log_retention_days on PostgreSQL Servers is set to an appropriate value.", "Configuring log_retention_days determines the duration in days that Azure Database for PostgreSQL retains log files. Query and error logs can be used to identify, troubleshoot, and repair configuration errors and sub-optimal performance.", "Configuring this setting will result in l ogs being retained for the specified number of days. If this is configured on a high traffic server, the log may grow quickly to occupy a large amount of disk space. In this case you may want to set this to a lower number.", "Database Services", "8.3 Ensure Adequate Audit Log Storage", "TRUE", "TRUE", "TRUE", "8.3", "8.3", "8.3", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"4.3.7", "AZURE", "azure_004_cis_4-3-7", "ssphp_use_case_azure_004_cis_4-3-7", "AZURE 004 [CIS 4.3.7]", "Ensure 'Allow access to Azure services' for PostgreSQL Database Server is disabled", "Level 1", "L1", "Disable access from Azure services to PostgreSQL Database Server.", "If access from Azure services i s enabled, the server's firewall will accept connections from all Azure resources, including resources not in your subscription. This is usually not a desired configuration. Instead, set up firewall rules to allow access from specific network ranges or VNE T rules to allow access from specific virtual networks.", "", "Database Services", "4.4 Implement and Manage a Firewall on Servers", "TRUE", "TRUE", "TRUE", "4.4", "4.4", "4.4", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"4.3.8", "AZURE", "azure_004_cis_4-3-8", "ssphp_use_case_azure_004_cis_4-3-8", "AZURE 004 [CIS 4.3.8]", "Ensure 'Infrastructure double encryption' for PostgreSQL Database Server is 'Enabled'", "Level 1", "L1", "Azure Database for PostgreSQL servers should be created with 'infrastructure double encryption' en abled.", "If Double Encryption is enabled, another layer of encryption is implemented at the hardware level before the storage or network level. Information will be encrypted before it is even accessed, preventing both interception of data in motio n if the network layer encryption is broken and data at rest in system resources such as memory or processor cache. Encryption will also be in place for any backups taken of the database, so the key will secure access the data in all forms. For the most se cure implementation of key based encryption, it is recommended to use a Customer Managed asymmetric RSA 2048 Key in Azure Key Vault.", "The read and write speeds to the database will be impacted if both default encryption and Infrastructure Encryption are checked, as a secondary form of encryption requires more resource overhead for the cryptography of information. This cost is justified for information security. Customer managed keys are recommended for the most secure implementation, leading to overh ead of key management. The key will also need to be backed up in a secure location, as loss of the key will mean loss of the information in the database.", "Database Services", "3.11 Encrypt Sensitive Data at Rest", "FALSE", "TRUE", "TRUE", "-", "3.11", "3.11", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"4.4.1", "AZURE", "azure_004_cis_4-4-1", "ssphp_use_case_azure_004_cis_4-4-1", "AZURE 004 [CIS 4.4.1]", "Ensure 'Enforce SSL connection' is set to 'Enabled' for Standard MySQL Database Server", "Level 1", "L1", "Enable SSL connection on MYSQL Servers.", "SSL connectivity helps to provide a new layer of security by connecting database server to client applications using Secure Sockets Layer (SSL). Enforcing SSL connections between database server and client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and application.", "", "Database Services", "3.10 Encrypt Sensitive Data in Transit", "FALSE", "TRUE", "TRUE", "-", "3.10", "3.10", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"4.4.2", "AZURE", "azure_004_cis_4-4-2", "ssphp_use_case_azure_004_cis_4-4-2", "AZURE 004 [CIS 4.4.2]", "Ensure 'TLS Version' is set to 'TLSV1.2' for MySQL flexible Database Server", "Level 1", "L1", "Ensure TLS version on MySQL flexible servers is set to the default value.", "TLS connectivity helps to prov ide a new layer of security by connecting database server to client applications using Transport Layer Security (TLS). Enforcing TLS connections between database server and client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and application.", "", "Database Services", "3.10 Encrypt Sensitive Data in Transit", "FALSE", "TRUE", "TRUE", "-", "3.10", "3.10", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"4.4.3", "AZURE", "azure_004_cis_4-4-3", "ssphp_use_case_azure_004_cis_4-4-3", "AZURE 004 [CIS 4.4.3]", "Ensure server parameter 'audit_log_enabled' is set to 'ON' for MySQL Database Server", "Level 2", "L2", "Enable audit_log_enabled on MySQL Servers.", "Enabling audit_log_enabled helps MySQL Database to log items such as connection attempts to the server, DDL/DML access, and more. Log data can be used to identify, troubleshoot, and repair configuration errors and suboptimal performance.", "There are further costs incurred for storage of logs. For high traffic databases these logs will be significant. Determine your organization's needs before enabling.", "Database Services", "8.2 Collect Audit Logs", "TRUE", "TRUE", "TRUE", "8.2", "8.2", "8.2", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"4.4.4", "AZURE", "azure_004_cis_4-4-4", "ssphp_use_case_azure_004_cis_4-4-4", "AZURE 004 [CIS 4.4.4]", "Ensure server parameter 'audit_log_events' has 'CONNECTION' set for MySQL Database Server", "Level 2", "L2", "Set audit_log _enabled to include CONNECTION on MySQL Servers.", "Enabling CONNECTION helps MySQL Database to log items such as successful and failed connection attempts to the server. Log data can be used to identify, troubleshoot, and repair configuration errors and suboptimal performance.", "There are further cos ts incurred for storage of logs. For high traffic databases these logs will be significant. Determine your organization's needs before enabling.", "Database Services", "8.2 Collect Audit Logs", "TRUE", "TRUE", "TRUE", "8.2", "8.2", "8.2", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"4.5.1", "AZURE", "azure_004_cis_4-5-1", "ssphp_use_case_azure_004_cis_4-5-1", "AZURE 004 [CIS 4.5.1]", "Ensure That 'Firewalls & Networks' Is Limited to Use Selected Networks Instead of All Networks", "Level 2", "L2", "Limiting your Cosmos DB to only communicate on whitelisted networks lowers its attack footprint.", "Selecting certain networks for your Cosmos DB to communicate restricts the number of networks including the internet that can interact with what is stored within the database.", "Failure to whitelist the correct networks will result in a connection loss.", "Database Services", "4.4 Implement and Manage a Firewall on Servers, 12.2 Establish and Maintain a Secure Network Architecture", "TRUE", "TRUE", "TRUE", "4.4", "4.4, 12.2", "4.4, 12.2", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"4.5.2", "AZURE", "azure_004_cis_4-5-2", "ssphp_use_case_azure_004_cis_4-5-2", "AZURE 004 [CIS 4.5.2]", "Ensure That Private Endpoints A re Used Where Possible", "Level 2", "L2", "Private endpoints limit network traffic to approved sources.", "For sensitive data, private endpoints allow granular control of which services can communicate with Cosmo s DB and ensure that this network traffic is private. You set this up on a case by case basis for each service you wish to be connected.", "Only whitelisted services will have access to communicate with the Cosmos DB.", "Database Services", "12.2 Establish and Maintain a Secure Network Architecture", "FALSE", "TRUE", "TRUE", "-", "12.2", "12.2", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"4.5.3", "AZURE", "azure_004_cis_4-5-3", "ssphp_use_case_azure_004_cis_4-5-3", "AZURE 004 [CIS 4.5.3]", "Use Azure Active Directory (AAD) Client Authentication and Azure RBAC where possible.", "Level 1", "L1", "Cosmos DB can use tokens or AAD for client authentication which in turn will use Azure RBAC for authorization. Using AAD is significantly more secure because AAD handles the credentials and allows for MFA and centralized management, and the Azure RBAC better integrated with the rest of Azure.", "AAD client authentication is considerably more secure than token-based authentication because the tokens must be persistent at the client. AAD does not require this.", "", "Database Services", "-", "FALSE", "FALSE", "FALSE", "-", "-", "-", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"5.1.1", "AZURE", "azure_005_cis_5-1-1", "ssphp_use_case_azure_005_cis_5-1-1", "AZURE 005 [CIS 5.1.1]", "Ensure that a 'Diagnostic Setting' exists", "Level 1", "L1", "Enable Diagnostic settings for exporting activity logs. Diagnostic settings are available for each individual resource within a subscription. Settings should be configured for all appropriate resources for your environment.", "A diagnostic setting controls how a diagnostic log is exported. By default, logs are retained only for 90 days. Diagnos tic settings should be defined so that logs can be exported and stored for a longer duration in order to analyze security activities within an Azure subscription.", "", "Logging and Monitoring", "8.9 Centralize Audit Logs", "FALSE", "TRUE", "TRUE", "-", "8.9", "8.9", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"5.1.2", "AZURE", "azure_005_cis_5-1-2", "ssphp_use_case_azure_005_cis_5-1-2", "AZURE 005 [CIS 5.1.2]", "Ensure Diagnostic Setting captures appropriate categories", "Level 1", "L1", "Prerequisite : A Diagnostic Setting must exist. If a Diagnostic Setting does not exist, the navigation and options within this recomme ndation will not be available. Please review the recommendation at the beginning of this subsection titled: 'Ensure that a 'Diagnostic Setting' exists.' The diagnostic setting should be configured to log the appropriate activities from the control/manageme nt plane.", "A diagnostic setting controls how the diagnostic log is exported. Capturing the diagnostic setting categories for appropriate control/management plane activities allows proper alerting.", "", "Logging and Monitoring", "8.5 Collect Detailed Audit Logs", "FALSE", "TRUE", "TRUE", "-", "8.5", "8.5", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"5.1.3", "AZURE", "azure_005_cis_5-1-3", "ssphp_use_case_azure_005_cis_5-1-3", "AZURE 005 [CIS 5.1.3]", "Ensure the Storage Container Storing the Activity Logs is not Publicly Accessible", "Level 1", "L1", "The storage account container containing the activity log export should not be publicly accessible.", "Allowing public access to activity log content may aid an adversary in identifying weaknesses in the affected account's use or configuration.", "Configuring container Access policy to private will remove access from the container for everyone except owners of the storage account. Access policy needs to be set explicitly in order to allow access to other desired users.", "Logging and Monitoring", "3.3 Configure Data Access Control Lists", "TRUE", "TRUE", "TRUE", "3.3", "3.3", "3.3", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"5.1.4", "AZURE", "azure_005_cis_5-1-4", "ssphp_use_case_azure_005_cis_5-1-4", "AZURE 005 [CIS 5.1.4]", "Ensure the storage account containing the container with activity logs is encrypted with Customer Managed Key", "Level 2", "L2", "Storage accounts with the activity log exports can be configured to use Customer Managed Keys (CMK).", "Configuring the storage account with the activity log export container to use CMKs provides additional confidentiality controls on log data, as a given user must have read permission on the corresponding storage account and m ust be granted decrypt permission by the CMK.", "NOTE: You must have your key vault setup to utilize this. All Audit Logs will be encrypted with a key you provide. You will need to set up customer managed keys separately, and you will select which key to use via the instructions here. You will be responsible for the lifecycle of the keys, and will need to manually replace them at your own determined intervals to keep the data secure.", "Logging and Monitoring", "3.11 Encrypt S ensitive Data at Rest", "FALSE", "TRUE", "TRUE", "-", "3.11", "3.11", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"5.1.5", "AZURE", "azure_005_cis_5-1-5", "ssphp_use_case_azure_005_cis_5-1-5", "AZURE 005 [CIS 5.1.5]", "Ensure that logging for Azure Key Vault is 'Enabled'", "Level 1", "L1", "Enable AuditEvent logging for key vault instances to ensure interactions with key vaults are logged and available.", "Monitoring how and when key vaults are accessed, and by whom, enables an audit trail of interactions with confidential information , keys, and certificates managed by Azure Keyvault. Enabling logging for Key Vault saves information in an Azure storage account which the user provides. This creates a new container named insights-logs-auditevent automatically for the specified storage ac count. This same storage account can be used for collecting logs for multiple key vaults.", "", "Logging and Monitoring", "8.5 Collect Detailed Audit Logs", "FALSE", "TRUE", "TRUE", "-", "8.5", "8.5", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"5.1.6", "AZURE", "azure_005_cis_5-1-6", "ssphp_use_case_azure_005_cis_5-1-6", "AZURE 005 [CIS 5.1.6]", "Ensure that Network Security Group Flow logs are captured and sent to Log Analytics", "Level 2", "L2", "Ensure that network flow logs are capture d and fed into a central log analytics workspace.", "Network Flow Logs provide valuable insight into the flow of traffic around your network and feed into both Azure Monitor and Azure Sentinel (if in use), permitting the generation of visual flow diagrams to aid with analyzing for lateral movement, etc.", "The impact of configuring NSG Flow logs is primarily one of cost and configuration. If deployed, it will create storage accounts that hold minimal amounts of data on a 5-day lifecycle before feeding to Log Analytics Workspace. This will increase the am ount of data stored and used by Azure Monitor.", "Logging and Monitoring", "13.6 Collect Network Traffic Flow Logs", "FALSE", "TRUE", "TRUE", "-", "13.6", "13.6", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"5.1.7", "AZURE", "azure_005_cis_5-1-7", "ssphp_use_case_azure_005_cis_5-1-7", "AZURE 005 [CIS 5.1.7]", "Ensure that logging for Azure AppService 'HTTP logs' is enabled", "Level 2", "L2", "Enable AppServiceHTTPLogs diagnostic lo g category for Azure App Service instances to ensure all http requests are captured and centrally logged.", "Capturing web requests can be important supporting information for security analysts performing monitoring and incident response activities . Once logging, these logs can be ingested into SIEM or other central aggregation point for the organization.", "Log consumption and processing will incur additional cost.", "Logging and Monitoring", "8.7 Collect URL Request Audit Logs", "FALSE", "TRUE", "TRUE", "-", "8.7", "8.7", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"5.2.1", "AZURE", "azure_005_cis_5-2-1", "ssphp_use_case_azure_005_cis_5-2-1", "AZURE 005 [CIS 5.2.1]", "Ensure that Activity Log Alert exis ts for Create Policy Assignment", "Level 1", "L1", "Create an activity log alert for the Create Policy Assignment event.", "Monitoring for create policy assignment events gives insight into changes done in 'Azure policy- assignments' and can reduce the time it takes to detect unsolicited changes.", "", "Logging and Monitoring", "8.5 Collect Detailed Audit Logs", "FALSE", "TRUE", "TRUE", "-", "8.5", "8.5", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"5.2.2", "AZURE", "azure_005_cis_5-2-2", "ssphp_use_case_azure_005_cis_5-2-2", "AZURE 005 [CIS 5.2.2]", "Ensure that Activity Log Alert exists for D elete Policy Assignment", "Level 1", "L1", "Create an activity log alert for the Delete Policy Assignment event.", "Monitoring for delete policy assignment events gives insight into changes done in 'azure policy- assignments' and can reduce the time it takes to detect unsolicited changes.", "", "Logging and Monitoring", "8.5 Collect Detailed Audit Logs", "FALSE", "TRUE", "TRUE", "-", "8.5", "8.5", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"5.2.3", "AZURE", "azure_005_cis_5-2-3", "ssphp_use_case_azure_005_cis_5-2-3", "AZURE 005 [CIS 5.2.3]", "Ensure that Activity Log Alert exists for Create or Update Network Secur ity Group", "Level 1", "L1", "Create an Activity Log Alert for the Create or Update Network Security Group event.", "Monitoring for Create or Update Network Security Group events gives insight into network acc ess changes and may reduce the time it takes to detect suspicious activity.", "", "Logging and Monitoring", "8.5 Collect Detailed Audit Logs", "FALSE", "TRUE", "TRUE", "-", "8.5", "8.5", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"5.2.4", "AZURE", "azure_005_cis_5-2-4", "ssphp_use_case_azure_005_cis_5-2-4", "AZURE 005 [CIS 5.2.4]", "Ensure that Activity Log Alert exists for Delete Network Security Group", "Level 1", "L1", "Create an activity log alert for the Delete Network Security Group event.", "Monitoring for 'Delete Network Security Group' events gives insight into network access changes and may reduce the time it takes to detect suspicious activity.", "", "Logging and Monitoring", "8.5 Collect Detailed Audit Logs", "FALSE", "TRUE", "TRUE", "-", "8.5", "8.5", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"5.2.5", "AZURE", "azure_005_cis_5-2-5", "ssphp_use_case_azure_005_cis_5-2-5", "AZURE 005 [CIS 5.2.5]", "Ensure that Activity Log Alert exists for Create or Update Security Solution", "Level 1", "L1", "Create an activity log alert for the Create or Update Security Solution event.", "Monitoring for Create or Update Security Solution events gives insight into changes to the active security solutions and may reduce the time it takes to detect suspic ious activity.", "", "Logging and Monitoring", "8.5 Collect Detailed Audit Logs", "FALSE", "TRUE", "TRUE", "-", "8.5", "8.5", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"5.2.6", "AZURE", "azure_005_cis_5-2-6", "ssphp_use_case_azure_005_cis_5-2-6", "AZURE 005 [CIS 5.2.6]", "Ensure that Activity Log Alert exists for Delete Security Solution", "Level 1", "L1", "Create an activity log alert for the Delete Security Solution event.", "Monitoring for Delete Security Solution events gives insight into changes to the active security solutions and may reduce the time it takes to detect suspicious activity.", "", "Logging and Monitoring", "8.5 Collect Detailed Audit Logs", "FALSE", "TRUE", "TRUE", "-", "8.5", "8.5", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"5.2.7", "AZURE", "azure_005_cis_5-2-7", "ssphp_use_case_azure_005_cis_5-2-7", "AZURE 005 [CIS 5.2.7]", "Ensure that Activity Log Alert exists for Create or Update SQL Server Firewall Rule", "Level 1", "L1", "Create an activity log alert for the Create or Update SQL Server Firewall Rule event.", "Monitoring for Create or Update SQL Server Firewall Rule events gives insight into network access changes and may reduce the time it takes to detect suspicious activity.", "There will be a substantial increase in log size if there are a large number of administ rative actions on a server.", "Logging and Monitoring", "8.5 Collect Detailed Audit Logs", "FALSE", "TRUE", "TRUE", "-", "8.5", "8.5", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"5.2.8", "AZURE", "azure_005_cis_5-2-8", "ssphp_use_case_azure_005_cis_5-2-8", "AZURE 005 [CIS 5.2.8]", "Ensure that Activity Log Alert exists for Delete SQL Server Firewall Rule", "Level 1", "L1", "Create an activity log alert for the 'Delete SQL Server Firewall Rule.'", "Monitoring for Delete SQL Server F irewall Rule events gives insight into SQL network access changes and may reduce the time it takes to detect suspicious activity.", "There will be a substantial increase in log size if there are a large number of administrative actions on a server.", "Logging and Monitoring", "8.5 Collect Detailed Audit Logs", "FALSE", "TRUE", "TRUE", "-", "8.5", "8.5", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"5.2.9", "AZURE", "azure_005_cis_5-2-9", "ssphp_use_case_azure_005_cis_5-2-9", "AZURE 005 [CIS 5.2.9]", "Ensure that Activity Log Alert exists for Create or Update Public IP Address rule", "Level 1", "L1", "Create an activity log alert for the Create or Update Public IP Addresses rule.", "Monitoring for Cre ate or Update Public IP Address events gives insight into network access changes and may reduce the time it takes to detect suspicious activity.", "There will be a substantial increase in log size if there are a large number of administrative actions on a server.", "Logging and Monitoring", "8.5 Collect Detailed Audit Logs", "FALSE", "TRUE", "TRUE", "-", "8.5", "8.5", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"5.2.10", "AZURE", "azure_005_cis_5-2-10", "ssphp_use_case_azure_005_cis_5-2-10", "AZURE 005 [CIS 5.2.10]", "Ensure that Activity Log Alert exists for Delete Public IP Address rule", "Level 1", "L1", "Create an activity log alert for the Delete Public IP Address rule.", "Monitoring for Delete Public IP Address events gives insight into network access changes and may reduce the time it takes to detect suspicious activity.", "There will be a substantial increase in log size if there are a large number of administrative actions on a server.", "Logging and Monitoring", "8.5 Collect Detailed Audit Logs", "FALSE", "TRUE", "TRUE", "-", "8.5", "8.5", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"5.3.1", "AZURE", "azure_005_cis_5-3-1", "ssphp_use_case_azure_005_cis_5-3-1", "AZURE 005 [CIS 5.3.1]", "Ensure Application Insights are Configured", "Level 2", "L2", "Application Insights within Azure act as an Application Performance Monitoring solution providing valuable data into how well an application performs and additional information when performing incident response. The types of log data collected include application metrics, telemetry data, and application trace logging data providing organizations with detailed infor mation about application activity and application transactions. Both data sets help organizations adopt a proactive and retroactive means to handle security and performance related metrics within their modern applications.", "Configuring Applicatio n Insights provides additional data not found elsewhere within Azure as part of a much larger logging and monitoring program within an organization's Information Security practice. The types and contents of these logs will act as both a potential cost savi ng measure (application performance) and a means to potentially confirm the source of a potential incident (trace logging). Metrics and Telemetry data provide organizations with a proactive approach to cost savings by monitoring an application's performanc e, while the trace logging data provides necessary details in a reactive incident response scenario by helping organizations identify the potential source of an incident within their application.", "Because Application Insights relies on a Log Analyti cs Workspace, an organization will incur additional expenses when using this service.", "Logging and Monitoring", "-", "FALSE", "FALSE", "FALSE", "-", "-", "-", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"5.4", "AZURE", "azure_005_cis_5-4", "ssphp_use_case_azure_005_cis_5-4", "AZURE 005 [CIS 5.4]", "Ensure that Azure Monitor Resource Logging is Enabled for All Services that Support it", "Level 1", "L1", "Resour ce Logs capture activity to the data access plane while the Activity log is a subscription-level log for the control plane. Resource-level diagnostic logs provide insight into operations that were performed within that resource itself; for example, reading or updating a secret from a Key Vault. Currently, 95 Azure resources support Azure Monitoring (See the more information section for a complete list), including Network Security Groups, Load Balancers, Key Vault, AD, Logic Apps, and CosmosDB. The content o f these logs varies by resource type. A number of back-end services were not configured to log and store Resource Logs for certain activities or for a sufficient length. It is crucial that monitoring is correctly configured to log all relevant activities a nd retain those logs for a sufficient length of time. Given that the mean time to detection in an enterprise is 240 days, a minimum retention period of two years is recommended.", "A lack of monitoring reduces the visibility into the data plane, and therefore an organization's ability to detect reconnaissance, authorization attempts or other malicious activity. Unlike Activity Logs, Resource Logs are not enabled by default. Specifica lly, without monitoring it would be impossible to tell which entities had accessed a data store that was breached. In addition, alerts for failed attempts to access APIs for Web Services or Databases are only possible when logging is enabled.", "Costs for monitoring varies with Log Volume. Not every resource needs to have logging enabled. It is important to determine the security classification of the data being processed by the given resource and adjust the logging based on which events need to be tra cked. This is typically determined by governance and compliance requirements.", "Logging and Monitoring", "8.5 Collect Detailed Audit Logs, 8.9 Centralize Audit Logs", "FALSE", "TRUE", "TRUE", "-", "8.5, 8.9", "8.5, 8.9", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"5.5", "AZURE", "azure_005_cis_5-5", "ssphp_use_case_azure_005_cis_5-5", "AZURE 005 [CIS 5.5]", "Ensure that SKU Basic/Consumption is not used on artifacts that need to be monitored (Particularly for Production Workloads)", "Level 2", "L2", "The use of Basic or Free SKUs in Azure whilst cost effective have significant limitations in terms of what can be monitored and what support can be realized from Microsoft. Typically, these SKU's do not have a service SLA and Microsoft will usually refuse to provide support for them. Consequently Basic/Free SKUs should never be used for production workloads.", "Typically, production workloads need to be monitored and should have an SLA with Microsoft, using Basic SKUs for any deployed product will mean that that these capabilities do not exist. The following resource types should use standard SKUs as a minimum. - Public IP Addresses - Network Load Balancers - REDIS Cache - SQL PaaS Databases - VPN Gateways", "The impact of enforcing Standard SKU's is twofold 1. There will be a cost increase 2. The monitoring and service level agreements will be available and will support the production service. All resources should be either tagged or in separate Management Groups/Su bscriptions", "Logging and Monitoring", "-", "FALSE", "FALSE", "FALSE", "-", "-", "-", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"6.1", "AZURE", "azure_006_cis_6-1", "ssphp_use_case_azure_006_cis_6-1", "AZURE 006 [CIS 6.1]", "Ensure that RDP access from the Internet is evaluated and restricted", "Level 1", "L1", "Network security groups sho uld be periodically evaluated for port misconfigurations. Where certain ports and protocols may be exposed to the Internet, they should be evaluated for necessity and restricted wherever they are not explicitly required.", "The potential security p roblem with using RDP over the Internet is that attackers can use various brute force techniques to gain access to Azure Virtual Machines. Once the attackers gain access, they can use a virtual machine as a launch point for compromising other machines on a n Azure Virtual Network or even attack networked devices outside of Azure.", "", "Networking", "4.4 Implement and Manage a Firewall on Servers, 4.5 Implement and Manage a Firewall on End -User Devices, 13.4 Perform Traffic Filtering Between Network Segments", "TRUE", "TRUE", "TRUE", "4.4, 4.5", "4.4, 4.5, 13.4", "4.4, 4.5, 13.4", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"6.2", "AZURE", "azure_006_cis_6-2", "ssphp_use_case_azure_006_cis_6-2", "AZURE 006 [CIS 6.2]", "Ensure that SSH access from the Internet is evaluated and restricted", "Level 1", "L1", "Network security groups should be periodically evaluated for port misconfigurations. Where certain ports and protocols may b e exposed to the Internet, they should be evaluated for necessity and restricted wherever they are not explicitly required.", "The potential security problem with using SSH over the Internet is that attackers can use various brute force techniques to gain access to Azure Virtual Machines. Once the attackers gain access, they can use a virtual machine as a launch point for compromi sing other machines on the Azure Virtual Network or even attack networked devices outside of Azure.", "", "Networking", "4.4 Implement and Manage a Firewall on Servers, 4.5 Implement and Manage a Firewall on End -User Devices, 13.4 Perform Traffic Filtering Between Network Segments", "TRUE", "TRUE", "TRUE", "4.4, 4.5", "4.4, 4.5, 13.4", "4.4, 4.5, 13.4", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"6.3", "AZURE", "azure_006_cis_6-3", "ssphp_use_case_azure_006_cis_6-3", "AZURE 006 [CIS 6.3]", "Ensure that UDP access from the Internet is evaluated and restricted", "Level 1", "L1", "Network security groups should be periodically evaluated for port misconfigurations. Where certain ports and protocols may b e exposed to the Internet, they should be evaluated for necessity and restricted wherever they are not explicitly required.", "The potential security problem with broadly exposing UDP services over the Internet is that attackers can use DDoS amplif ication techniques to reflect spoofed UDP traffic from Azure Virtual Machines. The most common types of these attacks use exposed DNS, NTP, SSDP, SNMP, CLDAP and other UDP-based services as amplification sources for disrupting services of other machines on the Azure Virtual Network or even attack networked devices outside of Azure.", "", "Networking", "4.4 Implement and Manage a Firewall on Servers, 4.5 Implement and Manage a Firewall on End -User Devices, 13.4 Perform Traffic Filtering Between Network Segments", "TRUE", "TRUE", "TRUE", "4.4, 4.5", "4.4, 4.5, 13.4", "4.4, 4.5, 13.4", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"6.4", "AZURE", "azure_006_cis_6-4", "ssphp_use_case_azure_006_cis_6-4", "AZURE 006 [CIS 6.4]", "Ensure that HTTP(S) access from the Internet is evaluated and restricted", "Level 1", "L1", "Network security groups should be periodically evaluated for port misconfigurations. Where certain ports and protocols may be exposed to the Internet, they should be evaluated for necessity and restricted wherever they are not explicitly required and narro wly configured.", "The potential security problem with using HTTP(S) over the Internet is that attackers can use various brute force techniques to gain access to Azure resources. Once the attackers gain access, they can use the resource as a launch point for compromising other resources within the Azure tenant.", "", "Networking", "4.4 Implement and Manage a Firewall on Servers, 4.5 Implement and Manage a Firewall on End -User Devices, 13.4 Perform Traffic Filtering Between Network Segments", "TRUE", "TRUE", "TRUE", "4.4, 4.5", "4.4, 4.5, 13.4", "4.4, 4.5, 13.4", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"6.5", "AZURE", "azure_006_cis_6-5", "ssphp_use_case_azure_006_cis_6-5", "AZURE 006 [CIS 6.5]", "Ensure that Network Security Group Flow Log retention period is 'greater than 90 days'", "Level 2", "L2", "Network Security Group Flow Logs should be enabled and the retention period set to greater than or equal t o 90 days.", "Flow logs enable capturing information about IP traffic flowing in and out of network security groups. Logs can be used to check for anomalies and give insight into suspected breaches.", "This will keep IP traffic logs for longer than 90 days. As a level 2, first determine your need to retain data, then apply your selection here. As this is data stored for longer, your monthly storage costs will increase depending on your data use.", "Networking", "8.3 Ensure Adequate Audit Log Storage, 8.10 Retain Audit Logs", "TRUE", "TRUE", "TRUE", "8.3", "8.3, 8.10", "8.3, 8.10", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"6.6", "AZURE", "azure_006_cis_6-6", "ssphp_use_case_azure_006_cis_6-6", "AZURE 006 [CIS 6.6]", "Ensure that Network Watcher is 'Enabled'", "Level 2", "L2", "Enable Network Watcher for Azure subscriptions.", "Network diagnostic and visualization tools available with Network Watcher help users understa nd, diagnose, and gain insights to the network in Azure.", "There are additional costs per transaction to run and store network data. For high-volume networks these charges will add up quickly.", "Networking", "12.2 Establish and Maintain a Secure Network Architecture, 12.4 Establish and Maintain Architecture Diagram(s)", "FALSE", "TRUE", "TRUE", "-", "12.2, 12.4", "12.2, 12.4", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"6.7", "AZURE", "azure_006_cis_6-7", "ssphp_use_case_azure_006_cis_6-7", "AZURE 006 [CIS 6.7]", "Ensure that Public IP addresses are Evaluated on a Periodic Basis", "Level 1", "L1", "Public IP Addresses provide tenant accounts with Internet connectivity for resources contained within the tenant. During the creat ion of certain resources in Azure, a Public IP Address may be created. All Public IP Addresses within the tenant should be periodically reviewed for accuracy and necessity.", "Public IP Addresses allocated to the tenant should be periodically revie wed for necessity. Public IP Addresses that are not intentionally assigned and controlled present a publicly facing vector for threat actors and significant risk to the tenant.", "", "Networking", "12.1 Ensure Network Infrastructure is Up -to-Date", "TRUE", "TRUE", "TRUE", "12.1", "12.1", "12.1", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"7.1", "AZURE", "azure_007_cis_7-1", "ssphp_use_case_azure_007_cis_7-1", "AZURE 007 [CIS 7.1]", "Ensure an Azure Bas tion Host Exists", "Level 2", "L2", "The Azure Bastion service allows secure remote access to Azure Virtual Machines over the Internet without exposing remote access protocol ports and services directly to the Interne t. The Azure Bastion service provides this access using TLS over 443/TCP, and subscribes to hardened configurations within an organization's Azure Active Directory service.", "The Azure Bastion service allows organizations a more secure means of ac cessing Azure Virtual Machines over the Internet without assigning public IP addresses to those Virtual Machines. The Azure Bastion service provides Remote Desktop Protocol (RDP) and Secure Shell (SSH) access to Virtual Machines using TLS within a web brow ser, thus preventing organizations from opening up 3389/TCP and 22/TCP to the Internet on Azure Virtual Machines. Additional benefits of the Bastion service includes Multi-Factor Authentication, Conditional Access Policies, and any other hardening measures configured within Azure Active Directory using a central point of access.", "The Azure Bastion service incurs additional costs and requires a specific virtual network configuration. The Standard tier offers additional configuration options compared t o the Basic tier and may incur additional costs for those added features.", "Virtual Machines", "12.1 Ensure Network Infrastructure is Up -to-Date, 13.4 Perform Traffic Filtering Between Network Segments", "TRUE", "TRUE", "TRUE", "12.1", "12.1, 13.4", "12.1, 13.4", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"7.2", "AZURE", "azure_007_cis_7-2", "ssphp_use_case_azure_007_cis_7-2", "AZURE 007 [CIS 7.2]", "Ensure Virtual Machines are utilizing Managed Disks", "Level 1", "L1", "Migrate blob-based VHDs to Managed Disks on Virtual Machines to exploit the default features of this configuration. The features include: 1. Default Disk Encryption 2. Resilience, as Microsoft will managed the disk storage and move around if underlying hardware goes faulty 3. Reduction of costs over storage accounts", "Managed disks are by default encrypted on the underlying hardware, so no addi tional encryption is required for basic protection. It is available if additional encryption is required. Managed disks are by design more resilient that storage accounts. For ARM-deployed Virtual Machines, Azure Adviser will at some point recommend moving VHDs to managed disks both from a security and cost management perspective.", "There are additional costs for managed disks based off of disk space allocated. When converting to managed disks, VMs will be powered off and back on.", "Virtual Machines", "3.11 Encrypt Sensitive Data at Rest", "FALSE", "TRUE", "TRUE", "-", "3.11", "3.11", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"7.3", "AZURE", "azure_007_cis_7-3", "ssphp_use_case_azure_007_cis_7-3", "AZURE 007 [CIS 7.3]", "Ensure that 'OS and Data' disks are encrypted with Customer Managed Key (CMK)", "Level 2", "L2", "Ensure that OS disks (boot volumes) and data disks (non-boot volumes) are encrypte d with CMK (Customer Managed Keys). Customer Managed keys can be either ADE or Server Side Encryption (SSE).", "Encrypting the IaaS VM's OS disk (boot volume) and Data disks (non-boot volume) ensures that the entire content is fully unrecoverable w ithout a key, thus protecting the volume from unwanted reads. PMK (Platform Managed Keys) are enabled by default in Azure-managed disks and allow encryption at rest. CMK is recommended because it gives the customer the option to control which specific keys are used for the encryption and decryption of the disk. The customer can then change keys and increase security by disabling them instead of relying on the PMK key that remains unchanging. There is also the option to increase security further by using aut omatically rotating keys so that access to disk is ensured to be limited. Organizations should evaluate what their security requirements are, however, for the data stored on the disk. For high-risk data using CMK is a must, as it provides extra steps of se curity. If the data is low risk, PMK is enabled by default and provides sufficient data security.", "Using CMK/BYOK will entail additional management of keys. NOTE: You must have your key vault set up to utilize this.", "Virtual Machines", "3.11 Encrypt Sensitive Data at Rest", "FALSE", "TRUE", "TRUE", "-", "3.11", "3.11", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"7.4", "AZURE", "azure_007_cis_7-4", "ssphp_use_case_azure_007_cis_7-4", "AZURE 007 [CIS 7.4]", "Ensure that 'Unattached disks' are encrypted with 'Customer Managed Key' (CMK)", "Level 2", "L2", "Ensure that unattached disks in a subscription are encrypted with a Customer Managed Key (CMK).", "Managed disks are encrypted by default with Platform-managed keys. Using Customer-managed keys may provide an additional level of security or meet an organization's regulatory requirements. Encrypting managed disks ensures that its entire content is fully unrecoverable without a key and thus protects the volume from unwarranted reads. Even if the disk is not attached to any of the VMs, there is always a risk where a compromised user account with administrative access to VM service can mount/attach these data disks, which may lead to sensitive information disclosure and tampering.", "NOTE: You must have your key vault set up to utilize this. Encrypt ion is available only on Standard tier VMs. This might cost you more. Utilizing and maintaining Customer-managed keys will require additional work to create, protect, and rotate keys.", "Virtual Machines", "3.11 Encrypt Sensitive Dat a at Rest", "FALSE", "TRUE", "TRUE", "-", "3.11", "3.11", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"7.5", "AZURE", "azure_007_cis_7-5", "ssphp_use_case_azure_007_cis_7-5", "AZURE 007 [CIS 7.5]", "Ensure that Only Approved Extensions Are Installed", "Level 1", "L1", "For added security, only install organization-approved extensions on VMs.", "Azure virtual machine extensions are small applications that provide post-deployment configuration and automation tasks on Azure virtual machines. These extensions run with administrative privileges and could potentially access anything on a virtual machine. The Azure Portal and community provide several such extensions. Each organization should carefully evaluate these extensions and ensure that only those that are approve d for use are actually implemented.", "Functionality by unsupported extensions will be disabled.", "Virtual Machines", "2.1 Establish and Maintain a Software Inventory", "TRUE", "TRUE", "TRUE", "2.1", "2.1", "2.1", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"7.6", "AZURE", "azure_007_cis_7-6", "ssphp_use_case_azure_007_cis_7-6", "AZURE 007 [CIS 7.6]", "Ensure that Endpoint Protection for all Virtual Machines is installed", "Level 2", "L2", "Install endpoint protection for all virtual machines.", "Installing endpoint protection systems (like an ti-malware for Azure) provides for real-time protection capability that helps identify and remove viruses, spyware, and other malicious software. These also offer configurable alerts when known-malicious or unwanted software attempts to install itself or r un on Azure systems.", "Endpoint protection will incur an additional cost to you.", "Virtual Machines", "10.2 Configure Automatic Anti -Malware Signature Updates", "TRUE", "TRUE", "TRUE", "10.2", "10.2", "10.2", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"7.7", "AZURE", "azure_007_cis_7-7", "ssphp_use_case_azure_007_cis_7-7", "AZURE 007 [CIS 7.7]", "[Legacy] Ensure that VHDs are Encrypted", "Level 2", "L2", "NOTE: This is a legacy recommendation. Managed Disks are encrypted by default and recommended for all new VM implementations. VHD (Virtual Hard Disks) are stored in blob storage and are the old-style disks that were attached to Virtual Machines. The blob V HD was then leased to the VM. By default, storage accounts are not encrypted, and Microsoft Defender will then recommend that the OS disks should be encrypted. Storage accounts can be encrypted as a whole using PMK or CMK. This should be turned on for stor age accounts containing VHDs.", "While it is recommended to use Managed Disks which are encrypted by default, 'legacy' VHDs may exist for a variety of reasons and may need to remain in VHD format. VHDs are not encrypted by default, so this recommen dation intends to address the security of these disks. In these niche cases, VHDs should be encrypted using the procedures in this recommendation to encrypt and protect the data content. If a virtual machine is using a VHD and can be converted to a managed disk, instructions for this procedure can be found in the resources section of this recommendation under the title 'Convert VHD to Managed Disk.'", "Depending on how the encryption is implemented will change the size of the impact. If provider-manage d keys(PMK) are utilized, the impact is relatively low, but processes need to be put in place to regularly rotate the keys. If Customer-managed keys(CMK) are utilized, a key management process needs to be implemented to store and manage key rotation, thus the impact is medium to high depending on user maturity with key management.", "Virtual Machines", "3.11 Encrypt Sensitive Data at Rest", "FALSE", "TRUE", "TRUE", "-", "3.11", "3.11", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"8.1", "AZURE", "azure_008_cis_8-1", "ssphp_use_case_azure_008_cis_8-1", "AZURE 008 [CIS 8.1]", "Ensure that the Expiration Date is set for all Keys in RBAC Key Va ults", "Level 1", "L1", "Ensure that all Keys in Role Based Access Control (RBAC) Azure Key Vaults have an expiration date set.", "Azure Key Vault enables users to store and use cryptographic keys within the Microsoft Azure environment. The exp (expiration date) attribute identifies the expiration date on or after which the key MUST NOT be used for encryption of new data, wrapping of new keys, and signing. By default, keys never expire. It is thus recommended that keys be rotated in the key vault and set an explicit expiration date for all keys to help enforce the key rotation. This ensures that the keys cannot be used beyond their ass igned lifetimes.", "Keys cannot be used beyond their assigned expiration dates respectively. Keys need to be rotated periodically wherever they are used.", "Key Vault", "3.1 Establish and Maintain a Data Management Process, 6.2 Establish an Access Revoking Process", "TRUE", "TRUE", "TRUE", "3.1, 6.2", "3.1, 6.2", "3.1, 6.2", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"8.2", "AZURE", "azure_008_cis_8-2", "ssphp_use_case_azure_008_cis_8-2", "AZURE 008 [CIS 8.2]", "Ensure that the Expiration Date is set for all Keys in Non-RBAC Key Vaults.", "Level 1", "L1", "Ensure that all Keys in Non Role Based Access Control (RBAC) Azure Key Vaults have an expiration date set.", "Azure Key Vault enables users to store and use cryptographic keys within the Microsoft Azure environment. The exp (expiration date) attribute identifies the expiration date on or after which the key MUST NOT be used for a cryptographic operation. By defau lt, keys never expire. It is thus recommended that keys be rotated in the key vault and set an explicit expiration date for all keys. This ensures that the keys cannot be used beyond their assigned lifetimes.", "Keys cannot be used beyond their assigned expiration dates respectively. Keys need to be rotated periodically wherever they are used.", "Key Vault", "3.1 Establish and Maintain a Data Management Process, 6.2 Establish an Access Revoking Process", "TRUE", "TRUE", "TRUE", "3.1, 6.2", "3.1, 6.2", "3.1, 6.2", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"8.3", "AZURE", "azure_008_cis_8-3", "ssphp_use_case_azure_008_cis_8-3", "AZURE 008 [CIS 8.3]", "Ensure that the Expiration Date is set for all Secrets in RBAC Key Vaults", "Level 1", "L1", "Ensure that all Secrets in Role Based Access Control (RBAC) Azure Key Vaults have an expiration date set.", "The Azure Key Vault enables users to store and keep secrets within the Microsoft Azure environment. Secrets in the Azure Key Vault are octet sequences with a maximum size of 25k bytes each. The exp (expiration date) attribute identifies the expiration date o n or after which the secret MUST NOT be used. By default, secrets never expire. It is thus recommended to rotate secrets in the key vault and set an explicit expiration date for all secrets. This ensures that the secrets cannot be used beyond their assigne d lifetimes.", "Secrets cannot be used beyond their assigned expiry date respectively. Secrets need to be rotated periodically wherever they are used.", "Key Vault", "3.1 Establish and Maintain a Data Management Process, 6.2 Establish an Access Revoking Process", "TRUE", "TRUE", "TRUE", "3.1, 6.2", "3.1, 6.2", "3.1, 6.2", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"8.4", "AZURE", "azure_008_cis_8-4", "ssphp_use_case_azure_008_cis_8-4", "AZURE 008 [CIS 8.4]", "Ensure that the Expiration Date is set for all Secrets in Non-RBAC Key Vaults", "Level 1", "L1", "Ensure that all Secrets in Non Role Based Access Control (RBAC) Azure Key Vaults have an expiration date set.", "The Azure Key Vault enables users to store and keep secrets within the Microsoft Azure environment. Secrets in the Azure Key Vault are octet sequences with a maximum size of 25k bytes each. The exp (expiration date) attribute identifies the expiratio n date on or after which the secret MUST NOT be used. By default, secrets never expire. It is thus recommended to rotate secrets in the key vault and set an explicit expiration date for all secrets. This ensures that the secrets cannot be used beyond their assigned lifetimes.", "Secrets cannot be used beyond their assigned expiry date respectively. Secrets need to be rotated periodically wherever they are used.", "Key Vault", "3.1 Establish and Maintain a Data Management Process, 6.2 Establish an Access Revoking Process", "TRUE", "TRUE", "TRUE", "3.1, 6.2", "3.1, 6.2", "3.1, 6.2", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"8.5", "AZURE", "azure_008_cis_8-5", "ssphp_use_case_azure_008_cis_8-5", "AZURE 008 [CIS 8.5]", "Ensure the Key Vault is Recoverable", "Level 1", "L1", "The Key Vault contains object keys, secrets, and certificates. Accidental unavailability of a Key Vault can cause immediate data loss or loss of security fun ctions (authentication, validation, verification, non-repudiation, etc.) supported by the Key Vault objects. It is recommended the Key Vault be made recoverable by enabling the 'Do Not Purge' and 'Soft Delete' functions. This is in order to prevent loss of encrypted data, including storage accounts, SQL databases, and/or dependent services provided by Key Vault objects (Keys, Secrets, Certificates) etc. This may happen in the case of accidental deletion by a user or from disruptive activity by a malicious u ser. WARNING: A current limitation of the soft-delete feature across all Azure services is role assignments disappearing when Key Vault is deleted. All role assignments will need to be recreated after recovery.", "There could be scenarios where use rs accidentally run delete/purge commands on Key Vault or an attacker/malicious user deliberately does so in order to cause disruption. Deleting or purging a Key Vault leads to immediate data loss, as keys encrypting data and secrets/certificates allowing access/services will become non-accessible. There are 2 Key Vault properties that play a role in permanent unavailability of a Key Vault: 1. enableSoftDelete : Setting this parameter to 'true' for a Key Vault ensures that even if Key Vault is deleted, Key Vault itself or its objects remain recoverable for the next 90 days. Key Vault/objects can either be recovered or purged (permanent deletion) during those 90 days. If no action is taken, key va ult and its objects will subsequently be purged. 2. enablePurgeProtection : enableSoftDelete only ensures that Key Vault is not deleted permanently and will be recoverable for 90 days from date of deletion. However, there are scenarios in which the Key Vault a nd/or its objects are accidentally purged and hence will not be recoverable. Setting enablePurgeProtection to 'true' ensures that the Key Vault and its objects cannot be purged. Enabling both the parameters on Key Vaults ensures that Key Vaults and their o bjects cannot be deleted/purged permanently.", "Once purge-protection and soft-delete are enabled for a Key Vault, the action is irreversible.", "Key Vault", "11.1 Establish and Maintain a Data Recovery Process", "TRUE", "TRUE", "TRUE", "11.1", "11.1", "11.1", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"8.6", "AZURE", "azure_008_cis_8-6", "ssphp_use_case_azure_008_cis_8-6", "AZURE 008 [CIS 8.6]", "Enable Role Based Access Control for Azure Key Vault", "Level 2", "L2", "WARNING: Role assignments disappear when a Key Vault has been deleted (soft-delete) and recovered. Afterwards it will be required to recreate all role assignments. This is a limitation of the soft-delete feature across all Azure services.", "The ne w RBAC permissions model for Key Vaults enables a much finer grained access control for key vault secrets, keys, certificates, etc., than the vault access policy. This in turn will permit the use of privileged identity management over these roles, thus securing the key vaults with JIT Access management.", "Implementation needs to be properly designed from the ground up, as this is a fundamental change to the way key vaults are accessed/managed. Changing permissions to key vaults will result in loss of service as permissions are re-applied. For the least amount of downtime, map your current groups and users to their corresponding permission needs.", "Key Vault", "3.3 Configure Data Access Control Lists, 6.8 Define and Maintain Role -Based Access Control", "TRUE", "TRUE", "TRUE", "3.3", "3.3", "3.3, 6.8", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"8.7", "AZURE", "azure_008_cis_8-7", "ssphp_use_case_azure_008_cis_8-7", "AZURE 008 [CIS 8.7]", "Ensure that Private Endpoints are Used for Azure Key Vault", "Level 2", "L2", "Private endpoints will secure network traffic from Azure Key Vault to the resources requesting secrets and keys.", "Private endpo ints will keep network requests to Azure Key Vault limited to the endpoints attached to the resources that are whitelisted to communicate with each other. Assigning the Key Vault to a network without an endpoint will allow other resources on that network t o view all traffic from the Key Vault to its destination. In spite of the complexity in configuration, this is recommended for high security secrets.", "Incorrect or poorly-timed changing of network configuration could result in service interruption. There are also additional costs tiers for running a private endpoint per petabyte or more of networking traffic.", "Key Vault", "12.2 Establish and Maintain a Secure Network Architecture", "FALSE", "TRUE", "TRUE", "-", "12.2", "12.2", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"8.8", "AZURE", "azure_008_cis_8-8", "ssphp_use_case_azure_008_cis_8-8", "AZURE 008 [CIS 8.8]", "Ensure Automatic Key Rotation is Enab led Within Azure Key Vault for the Supported Services", "Level 2", "L2", "Automatic Key Rotation is available in Public Preview. The currently supported applications are Key Vault, Managed Disks, and Storage accounts accessing keys within Key Vault. The number of supported applications will incrementally increased.", "Once set up, Automatic Private Key Rotation removes the need for manual administration when keys expire at intervals determined by your organization's policy. The recommended key lifetime is 2 years. Your organization should determine its own key expiration policy.", "There are an additional costs per operation in running the needed applications.", "Key Vault", "3.1 Establish and Maintain a Data Management Process, 6.2 Establish an Access Revoking Process", "TRUE", "TRUE", "TRUE", "3.1, 6.2", "3.1, 6.2", "3.1, 6.2", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"9.1", "AZURE", "azure_009_cis_9-1", "ssphp_use_case_azure_009_cis_9-1", "AZURE 009 [CIS 9.1]", "Ensure App Service Authentication is set up for apps in A zure App Service", "Level 2", "L2", "Azure App Service Authentication is a feature that can prevent anonymous HTTP requests from reaching a Web Application or authenticate those with tokens before they reach the app. If an anonymous request is received from a browser, App Service will redirect to a logon page. To handle the logon process, a choice from a set of identity providers can be made, or a custom authentication mechanism can be implemented.", "By Enabli ng App Service Authentication, every incoming HTTP request passes through it before being handled by the application code. It also handles authentication of users with the specified provider (Azure Active Directory, Facebook, Google, Microsoft Account, and Twitter), validation, storing and refreshing of tokens, managing the authenticated sessions and injecting identity information into request headers.", "This is only required for App Services which require authentication. Enabling on site like a marke ting or support website will prevent unauthenticated access which would be undesirable. Adding Authentication requirement will increase cost of App Service and require additional security components to facilitate the authentication.", "AppService", "3.3 Configure Data Access Control Lists", "TRUE", "TRUE", "TRUE", "3.3", "3.3", "3.3", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"9.2", "AZURE", "azure_009_cis_9-2", "ssphp_use_case_azure_009_cis_9-2", "AZURE 009 [CIS 9.2]", "Ensure Web App Redirects All HTTP traffic to HTTPS in Azure App Serv ice", "Level 1", "L1", "Azure Web Apps allows sites to run under both HTTP and HTTPS by default. Web apps can be accessed by anyone using non-secure HTTP links by default. Non-secure HTTP requests can be restricted and all HTTP requests redirected to the secure HTTPS port. It is recommended to enforce HTTPS-only traffic.", "Enabling HTTPS-only traffic will redirect all non-secure HTTP requests to HTTPS ports. HTTPS uses the TLS/SSL protocol to provide a secure connection which is both encrypted and authenticated. It is the refore important to support HTTPS for the security benefits.", "When it is enabled, every incoming HTTP request is redirected to the HTTPS port. This means an extra level of security will be added to the HTTP requests made to the app.", "AppService", "3.10 Encrypt Sensitive Data in Transit", "FALSE", "TRUE", "TRUE", "-", "3.10", "3.10", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"9.3", "AZURE", "azure_009_cis_9-3", "ssphp_use_case_azure_009_cis_9-3", "AZURE 009 [CIS 9.3]", "Ensure Web App is using the latest version of TLS encryption", "Level 1", "L1", "The TLS (Transport Layer Security) protocol secures transmission of data over the internet using standard encryption technology. Enc ryption should be set with the latest version of TLS. App service allows TLS 1.2 by default, which is the recommended TLS level by industry standards such as PCI DSS.", "App service currently allows the web app to set TLS versions 1.0, 1.1 and 1.2. It is highly recommended to use the latest TLS 1.2 version for web app secure connections.", "", "AppService", "3.10 Encrypt Sensitive Data in Transit", "FALSE", "TRUE", "TRUE", "-", "3.10", "3.10", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"9.4", "AZURE", "azure_009_cis_9-4", "ssphp_use_case_azure_009_cis_9-4", "AZURE 009 [CIS 9.4]", "Ensure the web app has 'Client Certificates (Incoming client certificates)' set to 'On'", "Level 2", "L2", "Client certificates allow for the app to request a certificate for incoming requests. Only clients that have a valid certificate will be able to reach the app.", "The TLS mutual authentication technique in enterprise environments ensures the authen ticity of clients to the server. If incoming client certificates are enabled, then only an authenticated client who has valid certificates can access the app.", "Utilizing and maintaining client certificates will require additional work to obtain and manage replacement and key rotation.", "AppService", "3.3 Configure Data Access Control Lists", "TRUE", "TRUE", "TRUE", "3.3", "3.3", "3.3", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"9.5", "AZURE", "azure_009_cis_9-5", "ssphp_use_case_azure_009_cis_9-5", "AZURE 009 [CIS 9.5]", "Ensure that Register with Azure Active Directory is enabled on App Servi ce", "Level 1", "L1", "Managed service identity in App Service provides more security by eliminating secrets from the app, such as credentials in the connection strings. When registering with Azure Active Directory in App Service, the app will connect to other Azure services sec urely without the need for usernames and passwords.", "App Service provides a highly scalable, self-patching web hosting service in Azure. It also provides a managed identity for apps, which is a turn-key solution for securing access to Azure SQL D atabase and other Azure services.", "", "AppService", "5.6 Centralize Account Management", "FALSE", "TRUE", "TRUE", "-", "5.6", "5.6", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"9.6", "AZURE", "azure_009_cis_9-6", "ssphp_use_case_azure_009_cis_9-6", "AZURE 009 [CIS 9.6]", "Ensure That 'PHP version' is the Latest, If Used to Run the Web App", "Level 1", "L1", "Periodically newer versions are released for PHP software either due to security flaws or to include additional functionality. Using the latest PHP version for web apps is recommended in order to take advantage of security fixes, if any, and/or additional functionalities of the newer version.", "Newer versions may contain security enhancements and additional functionality. Using the latest software version is recommended in order to take advantage of enhancements and new capabilities. With each soft ware installation, organizations need to determine if a given update meets their requirements. They must also verify the compatibility and support provided for any additional software against the update revision that is selected.", "If your app is wri tten using version-dependent features or libraries, they may not be available on the latest version. If you wish to upgrade, research the impact thoroughly. Upgrading may have unforeseen consequences that could result in downtime.", "AppService", "2.2 Ensure Auth orized Software is Currently Supported", "TRUE", "TRUE", "TRUE", "2.2", "2.2", "2.2", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"9.7", "AZURE", "azure_009_cis_9-7", "ssphp_use_case_azure_009_cis_9-7", "AZURE 009 [CIS 9.7]", "Ensure that 'Python version' is the Latest Stable Version, if Used to Run the Web App", "Level 1", "L1", "Periodically, newer versions are released for Python software either due to security flaws or to include addit ional functionality. Using the latest full Python version for web apps is recommended in order to take advantage of security fixes, if any, and/or additional functionalities of the newer version.", "Newer versions may contain security enhancements and additional functionality. Using the latest software version is recommended in order to take advantage of enhancements and new capabilities. With each software installation, organizations need to determin e if a given update meets their requirements. They must also verify the compatibility and support provided for any additional software against the update revision that is selected. Using the latest full version will keep your stack secure to vulnerabilitie s and exploits.", "If your app is written using version-dependent features or libraries, they may not be available on the latest version. If you wish to upgrade, research the impact thoroughly. Upgrading may have unforeseen consequences that could res ult in downtime.", "AppService", "2.2 Ensure Authorized Software is Currently Supported", "TRUE", "TRUE", "TRUE", "2.2", "2.2", "2.2", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"9.8", "AZURE", "azure_009_cis_9-8", "ssphp_use_case_azure_009_cis_9-8", "AZURE 009 [CIS 9.8]", "Ensure that 'Java version' is the latest, if used to run the Web App", "Level 1", "L1", "Periodically, newer versions are released for Java software either due to security flaws or to include additional functionality . Using the latest Java version for web apps is recommended in order to take advantage of security fixes, if any, and/or new functionalities of the newer version.", "Newer versions may contain security enhancements and additional functionality. Usi ng the latest software version is recommended in order to take advantage of enhancements and new capabilities. With each software installation, organizations need to determine if a given update meets their requirements. They must also verify the compatibil ity and support provided for any additional software against the update revision that is selected.", "If your app is written using version-dependent features or libraries, they may not be available on the latest version. If you wish to upgrade, resear ch the impact thoroughly. Upgrading may have unforeseen consequences that could result in downtime.", "AppService", "2.2 Ensure Authorized Software is Currently Supported", "TRUE", "TRUE", "TRUE", "2.2", "2.2", "2.2", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"9.9", "AZURE", "azure_009_cis_9-9", "ssphp_use_case_azure_009_cis_9-9", "AZURE 009 [CIS 9.9]", "Ensure that 'HTTP Version' is the Latest, if Used to Run the Web App", "Level 1", "L1", "Periodically, new er versions are released for HTTP either due to security flaws or to include additional functionality. Using the latest HTTP version for web apps to take advantage of security fixes, if any, and/or new functionalities of the newer version.", "Newer versions may contain security enhancements and additional functionality. Using the latest version is recommended in order to take advantage of enhancements and new capabilities. With each software installation, organizations need to determine if a given u pdate meets their requirements. They must also verify the compatibility and support provided for any additional software against the update revision that is selected. HTTP 2.0 has additional performance improvements on the head-of-line blocking problem of old HTTP version, header compression, and prioritization of requests. HTTP 2.0 no longer supports HTTP 1.1's chunked transfer encoding mechanism, as it provides its own, more efficient, mechanisms for data streaming.", "", "AppService", "2.2 Ensure Authorized Software is Currently Supported", "TRUE", "TRUE", "TRUE", "2.2", "2.2", "2.2", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"9.10", "AZURE", "azure_009_cis_9-10", "ssphp_use_case_azure_009_cis_9-10", "AZURE 009 [CIS 9.10]", "Ensure FTP deployments are Disabled", "Level 1", "L1", "By default, Azure Functions, Web, and API Services can be deployed over FTP. If FTP is required for an essential deployment workflow, FTPS should be required for FTP login for all App Service Apps and Functions.", "Azure FTP deployment endpoints ar e public. An attacker listening to traffic on a wifi network used by a remote employee or a corporate network could see login traffic in clear-text which would then grant them full control of the code base of the app or service. This finding is more severe if User Credentials for deployment are set at the subscription level rather than using the default Application Credentials which are unique per App.", "Any deployment workflows that rely on FTP or FTPs rather than the WebDeploy or HTTPs endpoints may be affected.", "AppService", "3.10 Encrypt Sensitive Data in Transit", "FALSE", "TRUE", "TRUE", "-", "3.10", "3.10", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"9.11", "AZURE", "azure_009_cis_9-11", "ssphp_use_case_azure_009_cis_9-11", "AZURE 009 [CIS 9.11]", "Ensure Azure Key Vaults are Used to Store Secrets", "Level 2", "L2", "Azure Key Vault will store multiple types of sensitive information such as encryption keys, certificate thumbprints, and Managed Identity Credent ials. Access to these 'Secrets' can be controlled through granular permissions.", "The credentials given to an application have permissions to create, delete, or modify data stored within the systems they access. If these credentials are stored wit hin the application itself, anyone with access to the application or a copy of the code has access to them. Storing within Azure Key Vault as secrets increases security by controlling access. This also allows for updates of the credentials without redeploy ing the entire application.", "Integrating references to secrets within the key vault are required to be specifically integrated within the application code. This will require additional configuration to be made during the writing of an application, o r refactoring of an already written one. There are also additional costs that are charged per 10000 requests to the Key Vault.", "AppService", "3.1 Establish and Maintain a Data Management Process", "TRUE", "TRUE", "TRUE", "3.1", "3.1", "3.1", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
"10.1", "AZURE", "azure_010_cis_10-1", "ssphp_use_case_azure_010_cis_10-1", "AZURE 010 [CIS 10.1]", "Ensure that Resource Locks are set for Mission-Critical Azure Resources", "Level 2", "L2", "Resource Manager Locks provide a way for administrators to lock down Azure resources to prevent deletion of, or modificatio ns to, a resource. These locks sit outside of the Role Based Access Controls (RBAC) hierarchy and, when applied, will place restrictions on the resource for all users. These locks are very useful when there is an important resource in a subscription that u sers should not be able to delete or change. Locks can help prevent accidental and malicious changes or deletion.", "As an administrator, it may be necessary to lock a subscription, resource group, or resource to prevent other users in the organiza tion from accidentally deleting or modifying critical resources. The lock level can be set to to CanNotDelete or ReadOnly to achieve this purpose. - CanNotDelete means authorized users can still read and modify a resource, but they cannot delete the resource .- ReadOnly means authorized users can read a resource, but they cannot delete or update the resource. Applying this lock is similar to restricting all authorized users to the permissions granted by the Reader role.", "There can be unintended outcomes of locking a resource. Applying a lock to a parent service will cause it to be inherited by all resources within. Conversely, applying a lock to a resource may not apply to connected storage, leaving it unlocked. Please see the documentation for further in formation.", "Miscellaneous", "3.3 Configure Data Access Control Lists", "TRUE", "TRUE", "TRUE", "3.3", "3.3", "3.3", "CIS Microsoft Azure Foundations Benchmark", "2.0.0", "2023-02-14", "CIS v8", "Auto Document Extraction Script", "2024-03-20 17:07:39"
