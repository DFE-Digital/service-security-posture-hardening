[ssphp_use_case_azure_001_cis_1-3]
cron_schedule = */30 * * * *
dispatch.earliest_time = 0
dispatch.latest_time = now
enableSched = 1
search = """
| `ssphp_use_case_m365_cis_powershell("m365:authorization_policy")`

| eval ssphp.score.numerator="-", 
       ssphp.score.denominator="-",
       ssphp.score.score=if('defaultUserRolePermissions.allowedToCreateTenants'="false","100","0")

| fields ssphp.score.score, ssphp.score.numerator, ssphp.score.denominator


``` add metadata ```
| eval SSPHP_RUN=round(now()),
       ssphp.use_case.id="azure_001_cis_1-3",
       ssphp.use_case.display.title="Azure 001 [CIS 1.3]",
       ssphp.use_case.display.short_description="Users Creating Tenants",
       ssphp.cis_benchmark.document.name="CIS Microsoft Azure Foundations Benchmark",
       ssphp.cis_benchmark.document.version="2.0.0",
       ssphp.cis_benchmark.document.date="14-02-2023",
       ssphp.cis_benchmark.control.number="1.3",
       ssphp.cis_benchmark.control.level="L1",
       ssphp.cis_benchmark.control.title="Ensure that 'Users can create Azure AD Tenants' is set to 'No'",
       ssphp.cis_benchmark.control.profile_applicability="Level 1",
       ssphp.cis_benchmark.control.description="Require administrators or appropriately delegated users to create new tenants.",
       ssphp.cis_benchmark.control.rationale="It is recommended to only allow an administrator to create new tenants. This prevent users from creating new Azure AD or Azure AD B2C tenants and ensures that only authorized users are able to do so.",
       ssphp.cis_benchmark.control.impact="Enforcing this setting will ensure that only authorized users are able to create new tenants.",
       ssphp.cis_benchmark.controls.v8="-",
       ssphp.cis_benchmark.controls.ig1="false",
       ssphp.cis_benchmark.controls.ig2="false",
       ssphp.cis_benchmark.controls.ig3="false",

       ssphp.use_case.description='ssphp.cis_benchmark.control.description',
       ssphp.use_case.control='ssphp.cis_benchmark.control.description'." : ".ssphp.cis_benchmark.control.rationale,

       ssphp.use_case.version="1.0.0",
       ssphp.use_case.last_changed.date="2023-09-29",
       ssphp.use_case.last_changed.by="Ian Pearl",
       ssphp.use_case.treshhold.red="-",
       ssphp.use_case.treshhold.orange="-",
       ssphp.use_case.treshhold.green="99",
       ssphp.color=case('ssphp.score.score'>'ssphp.use_case.treshhold.green',"green",1==1,"red"),
       ssphp.use_case.scoring_narrative="Score is 100 if control requirements are confirmed, otherwise 0. Best=100, Worst=0",
       ssphp.use_case.framework.mitre="Initial Access",
       ssphp.use_case.framework.ig_1="-",
       ssphp.use_case.framework.ig_2="-",
       ssphp.use_case.framework.ig_3="-",
       ssphp.cis_benchmark.version="CIS v8"
       
`ssphp_use_case_write`

"""
