[ssphp_use_case_azure_001_cis_1-1-4]
cron_schedule = */30 * * * *
dispatch.earliest_time = 0
dispatch.latest_time = now
enableSched = 1
search = """
| `ssphp_use_case_m365_cis_secure_score("aad_sign_in_freq_session_timeout")`

| eval ssphp.score.numerator="-", 
       ssphp.score.denominator="-",
       ssphp.score.score=if(like(implementationStatus,"Setting is: sign in frequency is not yet enabled in the following accounts:%"),"0","100")
| fields ssphp.score.score, ssphp.score.numerator, ssphp.score.denominator, description, implementationStatus

``` ##################### add metadata ##################### ```
| eval SSPHP_RUN=round(now()),
       ssphp.use_case.id="azure_001_cis_1-1-4",

       ssphp.use_case.version.number="2.0.0",
       ssphp.use_case.version.last_changed_date="2023-10-05",
       ssphp.use_case.version.last_changed_by="Ian Pearl",
       
       ssphp.microsoft.description=coalesce('description',"-"),
       ssphp.microsoft.implementation_status=coalesce('implementationStatus',"-")

| lookup foundational_systems_use_case_metadata.csv ssphp.use_case.id

| eval ssphp.use_case.control=coalesce('ssphp.use_case.control','ssphp.cis_benchmark.control.title',"-"),
       ssphp.use_case.description=coalesce('ssphp.use_case.description','ssphp.cis_benchmark.control.description',"-")

```
| eval SSPHP_RUN=round(now()),
       ssphp.use_case.id="azure_001_cis_1-1-4",
       ssphp.use_case.display.title="Azure 001 [CIS 1.1.4]",
       ssphp.use_case.display.short_description="Remember multi-factor authentication",
       ssphp.cis_benchmark.document.name="CIS Microsoft Azure Foundations Benchmark",
       ssphp.cis_benchmark.document.version="2.0.0",
       ssphp.cis_benchmark.document.date="14-02-2023",
       ssphp.cis_benchmark.control.number="1.1.4",
       ssphp.cis_benchmark.control.level="L1",
       ssphp.cis_benchmark.control.title="Ensure that 'Allow users to remember multi-factor authentication on devices they trust' is Disabled",
       ssphp.cis_benchmark.control.profile_applicability="Level 1",
       ssphp.cis_benchmark.control.description="Do not allow users to remember multi-factor authentication on devices.",
       ssphp.cis_benchmark.control.rationale="Remembering Multi-Factor Authentication (MFA) for devices and browsers allows users to have the option to bypass MFA for a set number of days after performing a successful sign-in using MFA. This can enhance usability by minimizing the number of times a user may need to perform two-step verification on the same device. However, if an account or device is compromised, remembering MFA for trusted devices may affect security. Hence, it is recommended that users not be allowed to bypass MFA.",
       ssphp.cis_benchmark.control.impact="For every login attempt, the user will be required to perform multi-factor authentication.",
       ssphp.cis_benchmark.controls.v8=mvappend(ssphp.cis_benchmark.controls.v8,"6.3 Require MFA for Externally-Exposed Applications","6.4 Require MFA for Remote Network Access"),
       ssphp.cis_benchmark.controls.ig1="true",
       ssphp.cis_benchmark.controls.ig2="true",
       ssphp.cis_benchmark.controls.ig3="true",
       ssphp.microsoft.desciption='description',
       ssphp.microsoft.implementation_status='implementationStatus',

       ssphp.use_case.description='ssphp.cis_benchmark.control.description',
       ssphp.use_case.control='ssphp.cis_benchmark.control.description'." : ".ssphp.cis_benchmark.control.rationale,

       ssphp.use_case.version="1.0.0",
       ssphp.use_case.last_changed.date="2023-10-02",
       ssphp.use_case.last_changed.by="Ian Pearl",
       ssphp.use_case.treshhold.red="-",
       ssphp.use_case.treshhold.orange="-",
       ssphp.use_case.treshhold.green="99",
       ssphp.color=case('ssphp.score.score'>'ssphp.use_case.treshhold.green',"green",1==1,"red"),
       ssphp.use_case.scoring_narrative="Score is 100 if control requirements are confirmed, otherwise 0. Best=100, Worst=0",
       ssphp.use_case.framework.mitre="Initial Access",
       ssphp.use_case.framework.ig_1="6.4",
       ssphp.use_case.framework.ig_2="6.3, 6.4",
       ssphp.use_case.framework.ig_3="6.3, 6.4",
       ssphp.cis_benchmark.version="CIS v8"
```

`ssphp_use_case_write`

"""
