[ssphp_use_case_aad_001]
cron_schedule = */10 * * * *
dispatch.earliest_time = 0
dispatch.latest_time = now
enableSched = 1
search = """
`ssphp_use_case_aad_001`

| where isPrivileged="true" AND NOT match(assignedPlans_service,"MultiFactorService")

| stats count
| eval ssphp.score=100-(10*count),
       ssphp.score=if('ssphp.score'<0,0,'ssphp.score')
| fields ssphp.score

``` add metadata ```
| eval SSPHP_RUN=round(now()),
       ssphp.use_case.id="aad_001",
       ssphp.use_case.display.title="AAD 001",
       ssphp.use_case.display.short_description="Admin No MFA Devices",
       ssphp.use_case.description="This use case is the number of privileged Azure Active Directory accounts that do not have MFA enabled",
       ssphp.use_case.version="1.0.1",
       ssphp.use_case.last_changed.date="2023-07-26",
       ssphp.use_case.last_changed.by="Ian Pearl",
       ssphp.use_case.treshhold.red="99",
       ssphp.use_case.treshhold.orange="99",
       ssphp.use_case.treshhold.green="99",
       ssphp.color=case('ssphp.score'>'ssphp.use_case.treshhold.red',"green",1==1,"red"),
       ssphp.use_case.scoring_narrative="Score drops by 10 points for every admin user found without MFA enabled. Best=100, Worst=0",
       ssphp.use_case.framework.mitre="Initial Access",
       ssphp.use_case.framework.ig_1="8.2, 13.1",
       ssphp.use_case.framework.ig_2="-",
       ssphp.use_case.framework.ig_3="1.6"
       
`ssphp_use_case_write`

"""
