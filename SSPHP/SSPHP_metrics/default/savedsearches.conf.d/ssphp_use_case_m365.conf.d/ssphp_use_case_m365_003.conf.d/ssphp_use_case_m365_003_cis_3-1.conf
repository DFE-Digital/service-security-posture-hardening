[ssphp_use_case_m365_003_cis_3-1]
cron_schedule = */30 * * * *
dispatch.earliest_time = 0
dispatch.latest_time = now
enableSched = 1
search = """
| `ssphp_use_case_m365_cis_secure_score("CustomerLockboxEnabled")`

| eval ssphp.score.numerator="-", 
       ssphp.score.denominator="-",
       ssphp.score.score=if(implementationStatus="Feature in place: true.","100","0")
| fields ssphp.score.score, ssphp.score.numerator, ssphp.score.denominator


``` add metadata ```
| eval SSPHP_RUN=round(now()),
       ssphp.use_case.id="m365_003_cis_3-1",
       ssphp.use_case.display.title="M365 003 [CIS 3.1]",
       ssphp.use_case.display.short_description="M365 Customer Lockbox",
       ssphp.cis_benchmark.document.name="CIS Microsoft 365 Foundations Benchmark",
       ssphp.cis_benchmark.document.version="2.0.0",
       ssphp.cis_benchmark.document.date="31-03-2023",
       ssphp.cis_benchmark.control.number="3.1",
       ssphp.cis_benchmark.control.level="L2",
       ssphp.cis_benchmark.control.title="Ensure the customer lockbox feature is enabled",
       ssphp.cis_benchmark.control.profile_applicability="E3 Level 2",
       ssphp.cis_benchmark.control.description="Customer Lockbox is a security feature that provides an additional layer of control and transparency to customer data in Microsoft 365. It offers an approval process for Microsoft support personnel to access organization data and creates an audited trail to meet compliance requirements.",
       ssphp.cis_benchmark.control.rationale="Enabling this feature protects organizational data against data spillage and exfiltration.",
       ssphp.cis_benchmark.control.impact="Administrators will need to grant Microsoft access to the tenant environment prior to a Microsoft engineer accessing the environment for support or troubleshooting.",
       ssphp.cis_benchmark.controls.v8="-",
       ssphp.cis_benchmark.controls.ig1="-",
       ssphp.cis_benchmark.controls.ig2="-",
       ssphp.cis_benchmark.controls.ig3="-",

       ssphp.use_case.description='ssphp.cis_benchmark.control.description',
       ssphp.use_case.control='ssphp.cis_benchmark.control.description'." : ".ssphp.cis_benchmark.control.rationale,

       ssphp.use_case.version="1.0.1",
       ssphp.use_case.last_changed.date="2023-09-22",
       ssphp.use_case.last_changed.by="Ian Pearl",
       ssphp.use_case.treshhold.red="-",
       ssphp.use_case.treshhold.orange="-",
       ssphp.use_case.treshhold.green="99",
       ssphp.color=case('ssphp.score.score'>'ssphp.use_case.treshhold.green',"green",1==1,"red"),
       ssphp.use_case.scoring_narrative="Score is 100 if control requirements are confirmed, otherwise 0. Best=100, Worst=0",
       ssphp.use_case.framework.mitre="Initial Access",
       ssphp.use_case.framework.ig_1="-",
       ssphp.use_case.framework.ig_2="-",
       ssphp.use_case.framework.ig_3="-",
       ssphp.cis_benchmark.version="CIS v8"
       
`ssphp_use_case_write`

"""
