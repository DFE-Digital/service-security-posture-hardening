[ssphp_use_case_m365_001_cis_1-7]
cron_schedule = */30 * * * *
dispatch.earliest_time = 0
dispatch.latest_time = now
enableSched = 1
search = """
| `ssphp_use_case_m365_cis_secure_score("spo_idle_session_timeout")`

| eval ssphp.score.numerator="-", 
       ssphp.score.denominator="-",
       ssphp.score.score=if(implementationStatus="The setting is compliant." AND on="true","100","0")
| fields ssphp.score.score, ssphp.score.numerator, ssphp.score.denominator, description, implementationStatus


``` ##################### add metadata ##################### ```
| eval SSPHP_RUN=round(now()),
       ssphp.use_case.id="m365_001_cis_1-7",

       ssphp.use_case.version.number="2.0.0",
       ssphp.use_case.version.last_changed_date="2023-10-05",
       ssphp.use_case.version.last_changed_by="Ian Pearl",
       
       ssphp.microsoft.description=coalesce('description',"-"),
       ssphp.microsoft.implementation_status=coalesce('implementationStatus',"-")

| lookup foundational_systems_use_case_metadata.csv ssphp.use_case.id

| eval ssphp.use_case.control=coalesce('ssphp.use_case.control','ssphp.cis_benchmark.control.title',"-"),
       ssphp.use_case.description=coalesce('ssphp.use_case.description','ssphp.cis_benchmark.control.description',"-")

| eval ssphp.score.color=case('ssphp.score.score'>'ssphp.score.threshold.green',"green",1==1,"red")

```
| eval SSPHP_RUN=round(now()),
       ssphp.use_case.id="m365_001_cis_1-7",
       ssphp.use_case.display.title="M365 001 [CIS 1.7]",
       ssphp.use_case.display.short_description="Idle session timeout",
       ssphp.cis_benchmark.document.name="CIS Microsoft 365 Foundations Benchmark",
       ssphp.cis_benchmark.document.version="2.0.0",
       ssphp.cis_benchmark.document.date="31-03-2023",
       ssphp.cis_benchmark.control.number="1.7",
       ssphp.cis_benchmark.control.level="L1",
       ssphp.cis_benchmark.control.title="Ensure 'Idle session timeout' is set to '1 hour (or less)' for unmanaged devices",
       ssphp.cis_benchmark.control.profile_applicability="E3 Level 1",
       ssphp.cis_benchmark.control.description="Idle session timeout allows the configuration of a setting which will timeout inactive users after a pre-determined amount of time. When a user reaches the set idle timeout session, they'll get a notification that they're about to be signed out. They have to select to stay signed in or they'll be automatically signed out of all Microsoft 365 web apps. Combined with a Conditional Access rule this will only impact unmanaged devices. A managed device is considered a device managed by Intune MDM.  The following Microsoft 365 web apps are supported : Outlook Web App, OneDrive for Business, SharePoint Online (SPO), Office.com and other start pages, Office (Word, Excel, PowerPoint) on the web, Microsoft 365 Admin Center.  NOTE: Idle session timeout doesn't affect Microsoft 365 desktop and mobile apps. The recommended setting is 1 hour (or less) for unmanaged devices.",
       ssphp.cis_benchmark.control.rationale="Ending idle sessions through an automatic process can help protect sensitive company data, and will add another layer of security for end users who work on unmanaged devices that can potentially be accessed by the public. Unauthorized individuals onsite or remotely can take advantage of systems left unattended over time. Automatic timing out of sessions makes this more difficult.",
       ssphp.cis_benchmark.control.impact="If step 2 in the Audit/Remediation procedure is left out then there is no issue from this from a security standpoint. However, it will require users on trusted devices to sign in more frequently which could result in credential prompt fatigue.",
       ssphp.cis_benchmark.controls.v8=mvappend(ssphp.cis_benchmark.controls.v8,"4.3 Configure Automatic Session Locking on Enterprise Assets"),
       ssphp.cis_benchmark.controls.ig1="true",
       ssphp.cis_benchmark.controls.ig2="true",
       ssphp.cis_benchmark.controls.ig3="true",
       ssphp.microsoft.desciption='description',
       ssphp.microsoft.implementation_status='implementationStatus',

       ssphp.use_case.description='ssphp.cis_benchmark.control.description',
       ssphp.use_case.control='ssphp.cis_benchmark.control.description'." : ".ssphp.cis_benchmark.control.rationale,

       ssphp.use_case.version="1.0.0",
       ssphp.use_case.last_changed.date="2023-09-27",
       ssphp.use_case.last_changed.by="Ian Pearl",
       ssphp.use_case.treshhold.red="-",
       ssphp.use_case.treshhold.orange="-",
       ssphp.use_case.treshhold.green="99",
       ssphp.color=case('ssphp.score.score'>'ssphp.use_case.treshhold.green',"green",1==1,"red"),
       ssphp.use_case.scoring_narrative="Score is 100 if control requirements are confirmed, otherwise 0. Best=100, Worst=0",
       ssphp.use_case.framework.mitre="Initial Access",
       ssphp.use_case.framework.ig_1="4.3",
       ssphp.use_case.framework.ig_2="4.3",
       ssphp.use_case.framework.ig_3="4.3",
       ssphp.cis_benchmark.version="CIS v8"
```

`ssphp_use_case_write`

"""
