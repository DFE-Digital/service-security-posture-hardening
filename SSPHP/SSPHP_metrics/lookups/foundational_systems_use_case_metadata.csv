"sphp.cis_benchmark.control.profile_applicability","ssphp.cis_benchmark.control.description","ssphp.cis_benchmark.control.impact","ssphp.cis_benchmark.control.level","ssphp.cis_benchmark.control.number","ssphp.cis_benchmark.control.rationale","ssphp.cis_benchmark.control.title","ssphp.cis_benchmark.controls.ig1","ssphp.cis_benchmark.controls.ig2","ssphp.cis_benchmark.controls.ig3","ssphp.cis_benchmark.controls.v8","ssphp.cis_benchmark.document.date","ssphp.cis_benchmark.document.name","ssphp.cis_benchmark.document.version","ssphp.cis_benchmark.version","ssphp.metadata.last_updated_by","ssphp.metadata.last_updated_date","ssphp.risk.expectancy","ssphp.risk.impact","ssphp.score.scoring_narrative","ssphp.score.threshold.green","ssphp.score.threshold.orange","ssphp.score.threshold.red","ssphp.use_case.control","ssphp.use_case.description","ssphp.use_case.foundational_system","ssphp.use_case.framework.ig_1","ssphp.use_case.framework.ig_2","ssphp.use_case.framework.ig_3","ssphp.use_case.id","ssphp.use_case.savedsearch","ssphp.use_case.short_description","ssphp.use_case.title"
,,,,,,,,,,,"-","-","-","CIS v8","Ian Pearl","2023-10-05 12:00:00",5,5,"Score is the percentage of privieged accounts that have the MFA Service Plan enabled. Best=100, Worst=0",99,"-","-","All Azure AD privileged users should have an MFA device associated with their Azure Active Directory account.","This use case is the number of privileged Azure Active Directory accounts that have MFA enabled",AAD,"8.2, 13.1","-","1.6","aad_001","ssphp_use_case_aad_001","Admin No MFA Devices","AAD 001"
,,,,,,,,,,,"-","-","-","CIS v8","Ian Pearl","2023-10-05 12:00:00",5,5,"Score is percentage of Azure AD Admin users with MFA Conditional Policies. Best=100, Worst=0",99,"-","-","All privileged Azure AD users should have an MFA required policy enabled on their account.","This use case is the number of privileged AD accounts that do not have a specific conditional access policy",AAD,"8.2, 13.1","-","1.6","aad_002","ssphp_use_case_aad_002","Admins no MFA Conditional Policies","AAD 002"
,,,,,,,,,,,"-","-","-","CIS v8","Ian Pearl","2023-10-05 12:00:00",5,5,"Score is percentage of Azure AD Admin users with VPN Conditional Policies. Best=100, Worst=0",99,"-","-","All users should have a Conditional Access Policy associated with their Azure AD account which restricts access to only be through the DfE VPN.","This use case is the number of privileged AD accounts that do not have a specific VPN conditional access policy",AAD,"8.2, 13.1","-","1.6","aad_003","ssphp_use_case_aad_003","Admins no VPN Conditional Policies","AAD 003"
,,,,,,,,,,,"-","-","-","CIS v8","Ian Pearl","2023-10-05 12:00:00",5,5,"Score is percentage of Azure AD Admin users with Compliant Device Conditional Policies. Best=100, Worst=0",99,"-","-","All users should have a Conditional Access Policy associated with their Azure AD account which restricts access to only be using a restricted device.","This use case is the number of privileged AD accounts that do not have a specific conditional access policy which restricts the devices they can log into AAD from to specific 'compliant devices'.",AAD,"8.2, 13.1","-","1.6","aad_004","ssphp_use_case_aad_004","Admins no Compliant Device Conditional Policies","AAD 004"
,,,,,,,,,,,"-","-","-","CIS v8","Ian Pearl","2023-10-05 12:00:00",5,5,"Score is percentage of Azure AD Admin users with Anonymous Accounts. Best=100, Worst=0",99,"-","-","All privileged Azure AD user accounts should be assigned to an individual, not anonymously.","This use case is the number of privileged AD accounts that do not have a specific named individual associated",AAD,"8.2, 13.1","-","1.6","aad_005","ssphp_use_case_aad_005","Admins with Anonymous Accounts","AAD 005"
,"Do not allow users to remember multi-factor authentication on devices.","For every login attempt, the user will be required to perform multi-factor authentication.",L1,"1.1.4","Remembering Multi-Factor Authentication (MFA) for devices and browsers allows users to have the option to bypass MFA for a set number of days after performing a successful sign-in using MFA. This can enhance usability by minimizing the number of times a user may need to perform two-step verification on the same device. However, if an account or device is compromised, remembering MFA for trusted devices may affect security. Hence, it is recommended that users not be allowed to bypass MFA.","Ensure that 'Allow users to remember multi-factor authentication on devices they trust' is Disabled",TRUE,TRUE,TRUE,"6.3 Require MFA for Externally-Exposed Applications
6.4 Require MFA for Remote Network Access","14/02/2023","CIS Microsoft Azure Foundations Benchmark","2.0.0","CIS v8","Ian Pearl","2023-10-05 12:00:00",5,5,"Score is 100 if control requirements are confirmed, otherwise 0. Best=100, Worst=0",99,"-","-",,,Azure,"6.4","6.3, 6.4","6.3, 6.4","azure_001_cis_1-1-4","ssphp_use_case_azure_001_cis_1-1-4","Remember multi-factor authentication","Azure 001 [CIS 1.1.4]"
,"For designated users, they will be prompted to use their multi-factor authentication (MFA) process on login","There is an increased cost, as Conditional Access policies require Azure AD Premium. Similarly, MFA may require additional overhead to maintain. There is also a potential scenario in which the multi-factor authentication method can be lost, and administrative users are no longer able to log in. For this scenario, there should be an emergency access account. Please see References for creating this.",L1,"1.2.3","Enabling multi-factor authentication is a recommended setting to limit the use of Administrative accounts to authenticated personnel.","Ensure that A Multi-factor Authentication Policy Exists for Administrative Groups",TRUE,TRUE,TRUE,"6.3 Require MFA for Externally-Exposed Applications
6.4 Require MFA for Remote Network Access
6.5 Require MFA for Administrative Access
6.7 Centralize Access Control","14/02/2023","CIS Microsoft Azure Foundations Benchmark","2.0.0","CIS v8","Ian Pearl","2023-10-05 12:00:00",5,5,"Score is the percentage of privieged accounts that have the MFA Service Plan enabled. Best=100, Worst=0",99,"-","-",,,Azure,"6.4, 6.5","6.3, 6.4, 6.5, 6.7","6.3, 6.4, 6.5, 6.7","azure_001_cis_1-2-3","ssphp_use_case_azure_001_cis_1-2-3","MFA Policy for Admin Groups","Azure 001 [CIS 1.2.3]"
,"For designated users, they will be prompted to use their multi-factor authentication (MFA) process on logins","There is an increased cost, as Conditional Access policies require Azure AD Premium. Similarly, this may require additional overhead to maintain if users lose access to their MFA.",L1,"1.2.4","Enabling multi-factor authentication is a recommended setting to limit the potential of accounts being compromised and limiting access to authenticated personnel.","Ensure that A Multi-factor Authentication Policy Exists for All Users",TRUE,TRUE,TRUE,"6.3 Require MFA for Externally-Exposed Applications
6.4 Require MFA for Remote Network Access
6.7 Centralize Access Control","14/02/2023","CIS Microsoft Azure Foundations Benchmark","2.0.0","CIS v8","Ian Pearl","2023-10-05 12:00:00",5,5,"Score is the percentage of privieged accounts that have the MFA Service Plan enabled. Best=100, Worst=0",99,"-","-",,,Azure,"6.4","6.3, 6.4, 6.7","6.3, 6.4, 6.7","azure_001_cis_1-2-4","ssphp_use_case_azure_001_cis_1-2-4","MFA Policy for Users","Azure 001 [CIS 1.2.4]"
,"Require administrators or appropriately delegated users to create new tenants.","Enforcing this setting will ensure that only authorized users are able to create new tenants.",L1,"1.3","It is recommended to only allow an administrator to create new tenants. This prevent users from creating new Azure AD or Azure AD B2C tenants and ensures that only authorized users are able to do so.","Ensure that 'Users can create Azure AD Tenants' is set to 'No'",FALSE,FALSE,FALSE,,"14/02/2023","CIS Microsoft Azure Foundations Benchmark","2.0.0","CIS v8","Ian Pearl","2023-10-05 12:00:00",5,5,"Score is 100 if control requirements are confirmed, otherwise 0. Best=100, Worst=0",99,"-","-",,,Azure,"-","-","-","azure_001_cis_1-3","ssphp_use_case_azure_001_cis_1-3","Users Creating Tenants","Azure 001 [CIS 1.3]"
,"None of the settings offered by ASC Default policy should be set to effect Disabled.","-",L1,"2.1.14","A security policy defines the desired configuration of your workloads and helps ensure compliance with company or regulatory security requirements. ASC Default policy is associated with every subscription by default. ASC default policy assignment is a set of security recommendations based on best practices. Enabling recommendations in ASC default policy ensures that Azure security center provides the ability to monitor all of the supported recommendations and optionally allow automated action for a few of the supported recommendations.","Ensure That 'All users with the following roles' is set to 'Owner'",TRUE,TRUE,TRUE,"4.1 Establish and Maintain a Secure Configuration Process
4.2 Establish and Maintain a Secure Configuration Process for Network Infrastructure
13.11 Tune Security Event Alerting Thresholds","14/02/2023","CIS Microsoft Azure Foundations Benchmark","2.0.0","CIS v8","Ian Pearl","2023-10-05 12:00:00",5,5,"Score is 100 if control requirements are confirmed, otherwise 0. Best=100, Worst=0",99,"-","-",,,Azure,"4.1, 4.2","4.1, 4.2","4.1, 4.2, 13.11","azure_002_cis_2-1-14","ssphp_use_case_azure_002_cis_2-1-14","ASC Default Policy Settings are Not Set to 'Disabled'","Azure 002 [CIS 2.1.14]"
"Level 1","Enable automatic provisioning of the monitoring agent to collect security data.","-",L1,"2.1.15","When Log Analytics agent for Azure VMs is turned on, Microsoft Defender for Cloud provisions the Microsoft Monitoring Agent on all existing supported Azure virtual machines and any new ones that are created. The Microsoft Monitoring Agent scans for various security-related configurations and events such as system updates, OS vulnerabilities, endpoint protection, and provides alerts.","Ensure that Auto provisioning of 'Log Analytics agent for Azure VMs' is Set to 'On'",FALSE,TRUE,TRUE,"7.5 Perform Automated Vulnerability Scans of Internal Enterprise Assets
7.6 Perform Automated Vulnerability Scans of ExternallyExposed Enterprise Assets","2023-02-14","CIS Microsoft Azure Foundations Benchmark","2.0.0","CIS v8","Ian Pearl","2023-10-06 12:35:01",5,5,"Score is the percentage of accounts that have Auto provisioning On. Best=100, Worst=0.",99,"-","-","","",Azure,"-","7.5, 7.6","7.5, 7.6","azure_002_cis_2-1-15","azure_002_cis_2-1-15","Auto provisioning of 'Log Analytics agent for Azure VMs'","Azure 002 [CIS 2.1.15]"
,"Enable security alert emails to subscription owners.","-",L1,"2.1.18","Enabling security alert emails to subscription owners ensures that they receive security alert emails from Microsoft. This ensures that they are aware of any potential security issues and can mitigate the risk in a timely fashion.","Ensure That 'All users with the following roles' is set to 'Owner'",TRUE,TRUE,TRUE,"17.2 Establish and Maintain Contact Information for Reporting Security Incidents","14/02/2023","CIS Microsoft Azure Foundations Benchmark","2.0.0","CIS v8","Ian Pearl","2023-10-05 12:00:00",5,5,"Score is 100 if control requirements are confirmed, otherwise 0. Best=100, Worst=0",99,"-","-",,,Azure,"17.2","17.2","17.2","azure_002_cis_2-1-18","ssphp_use_case_azure_002_cis_2-1-18","Security Alert Emails to Subscription Owners","Azure 002 [CIS 2.1.18]"
,"Microsoft Defender for Cloud emails the subscription owners whenever a high-severity alert is triggered for their subscription. You should provide a security contact email address as an additional email address.","-",L1,"2.1.18","Microsoft Defender for Cloud emails the Subscription Owner to notify them about security alerts. Adding your Security Contact's email address to the 'Additional email addresses' field ensures that your organization's Security Team is included in these alerts. This ensures that the proper people are aware of any potential compromise in order to mitigate the risk in a timely fashion.","Ensure 'Additional email addresses' is Configured with a Security Contact Email",TRUE,TRUE,TRUE,"17.2 Establish and Maintain Contact Information for Reporting Security Incidents","14/02/2023","CIS Microsoft Azure Foundations Benchmark","2.0.0","CIS v8","Ian Pearl","2023-10-05 12:00:00",5,5,"Score is 100 if control requirements are confirmed, otherwise 0. Best=100, Worst=0",99,"-","-",,,Azure,"17.2","17.2","17.2","azure_002_cis_2-1-19","ssphp_use_case_azure_002_cis_2-1-19","'Additional email addresses' is Configured with a Security Contact Email","Azure 002 [CIS 2.1.19]"
,"Enables emailing security alerts to the subscription owner or other designated security contact.","-",L1,"2.1.20","Enabling security alert emails ensures that security alert emails are received from Microsoft. This ensures that the right people are aware of any potential security issues and are able to mitigate the risk.","Ensure That 'Notify about alerts with the following severity' is Set to 'High'",FALSE,FALSE,TRUE,"13.11 Tune Security Event Alerting Thresholds","14/02/2023","CIS Microsoft Azure Foundations Benchmark","2.0.0","CIS v8","Ian Pearl","2023-10-05 12:00:00",5,5,"Score is 100 if control requirements are confirmed, otherwise 0. Best=100, Worst=0",99,"-","-",,,Azure,"-","-","13.11","azure_002_cis_2-1-20","ssphp_use_case_azure_002_cis_2-1-20","'Notify about alerts with the following severity' is Set to 'High'","Azure 002 [CIS 2.1.20]"
"Level 2","This integration setting enables Microsoft Defender for Cloud Apps (formerly 'Microsoft Cloud App Security' or 'MCAS' - see additional info) to communicate with Microsoft Defender for Cloud.","Microsoft Defender for Cloud Apps works with Standard pricing tier Subscription. Choosing the Standard pricing tier of Microsoft Defender for Cloud incurs an additional cost per resource.",L2,"2.1.21","Microsoft Defender for Cloud offers an additional layer of protection by using Azure Resource Manager events, which is considered to be the control plane for Azure. By analyzing the Azure Resource Manager records, Microsoft Defender for Cloud detects unusual or potentially harmful operations in the Azure subscription environment. Several of the preceding analytics are powered by Microsoft Defender for Cloud Apps. To benefit from these analytics, subscription must have a Cloud App Security license. Microsoft Defender for Cloud Apps works only with Standard Tier subscriptions.","Ensure that Microsoft Defender for Cloud Apps integration with Microsoft Defender for Cloud is Selected",FALSE,TRUE,TRUE,"7.5 Perform Automated Vulnerability Scans of Internal Enterprise Assets
7.6 Perform Automated Vulnerability Scans of Externally Exposed Enterprise Assets
13.10 Perform Application Layer Filtering
16.11 Leverage Vetted Modules or Services for Application Security Components","2023-02-14","CIS Microsoft Azure Foundations Benchmark","2.0.0","CIS v8","Ian Pearl","2023-10-06 12:53:35",5,5,"Score is the percentage of accounts where Microsoft Defender for Cloud Apps integration with Microsoft Defender for Cloud is Selected. Best=100, Worst=0.",99,"-","-","","",Azure,"-","7.5, 7.6, 16.11","7.5, 7.6, 13.10, 16.11","azure_002_cis_2-1-21","azure_002_cis_2-1-21","Microsoft Defender for Cloud Apps integration","Azure 002 [CIS 2.1.21]"
"Level 2","This integration setting enables Microsoft Defender for Endpoint (formerly 'Advanced Threat Protection' or 'ATP' or 'WDATP' - see additional info) to communicate with Microsoft Defender for Cloud.  IMPORTANT: When enabling integration between DfE & DfC it needs to be taken into account that this will have some side effects that may be undesirable. 1. For server 2019 & above if defender is installed (default for these server SKU's) this will trigger a deployment of the new unified agent and link to any of the extended configuration in the Defender portal. 2. If the new unified agent is required for server SKU's of Win 2016 or Linux and lower there is additional integration that needs to be switched on and agents need to be aligned","Microsoft Defender for Endpoint works with Standard pricing tier Subscription. Choosing the Standard pricing tier of Microsoft Defender for Cloud incurs an additional cost per resource.",L2,"2.1.22","Microsoft Defender for Endpoint integration brings comprehensive Endpoint Detection and Response (EDR) capabilities within Microsoft Defender for Cloud. This integration helps to spot abnormalities, as well as detect and respond to advanced attacks on endpoints monitored by Microsoft Defender for Cloud.MDE works only with Standard Tier subscriptions.","Ensure that Microsoft Defender for Endpoint integration with Microsoft Defender for Cloud is selected",TRUE,TRUE,TRUE,"7.5 Perform Automated Vulnerability Scans of Internal Enterprise Assets
10.1 Deploy and Maintain Anti-Malware Software
10.6 Centrally Manage Anti-Malware Software
13.2 Deploy a Host-Based Intrusion Detection Solution","2023-02-14","CIS Microsoft Azure Foundations Benchmark","2.0.0","CIS v8","Ian Pearl","2023-10-09 08:46:06",5,5,"Best=100, Worst=0.",99,"-","-","","",Azure,"10.1","7.5, 10.1, 10.6, 13.2","7.5, 10.1, 10.6, 13.2","azure_002_cis_2-1-22","azure_002_cis_2-1-22","Microsoft Defender for Endpoint integration with Microsoft Defender for Cloud","Azure 002 [CIS 2.1.22]"
"Level 2","Transparent Data Encryption (TDE) with Customer-managed key support provides increased transparency and control over the TDE Protector, increased security with an HSM-backed external service, and promotion of separation of duties.With TDE, data is encrypted at rest with a symmetric key (called the database encryption key) stored in the database or data warehouse distribution. To protect this data encryption key (DEK) in the past, only a certificate that the Azure SQL Service managed could be used. Now, with Customer-managed key support for TDE, the DEK can be protected with an asymmetric key that is stored in the Azure Key Vault. The Azure Key Vault is a highly available and scalable cloud-based key store which offers central key management, leverages FIPS 140-2 Level 2 validated hardware security modules (HSMs), and allows separation of management of keys and data for additional security. Based on business needs or criticality of data/databases hosted on a SQL server, it is recommended that the TDE protector is encrypted by a key that is managed by the data owner (Customer-managed key).","Once TDE protector is encrypted with a Customer-managed key, it transfers entire responsibility of respective key management on to you, and hence you should be more careful about doing any operations on the particular key in order to keep data from corresponding SQL server and Databases hosted accessible.When deploying Customer Managed Keys, it is prudent to ensure that you also deploy an automated toolset for managing these keys (this should include discovery and key rotation), and Keys should be stored in an HSM or hardware backed keystore, such as Azure Key Vault. As far as toolsets go, check with your cryptographic key provider, as they may well provide one as an add-on to their service.",L2,"4.1.3","Customer-managed key support for Transparent Data Encryption (TDE) allows user control of TDE encryption keys and restricts who can access them and when. Azure Key Vault, Azure’s cloud-based external key management system, is the first key management service where TDE has integrated support for Customer-managed keys. With Customer-managed key support, the database encryption key is protected by an asymmetric key stored in the Key Vault. The asymmetric key is set at the server level and inherited by all databases under that server.","Ensure SQL server's Transparent Data Encryption (TDE) protector is encrypted with Customer-managed key",FALSE,TRUE,TRUE,"3.11 Encrypt Sensitive Data at Rest
","2023-02-14","CIS Microsoft Azure Foundations Benchmark","2.0.0","CIS v8","Ian Pearl","2023-10-06 13:15:59",5,5,"Best=100, Worst=0.",99,"-","-","","",Azure,"-","3.11","3.11","azure_004_cis_4-1-3","azure_004_cis_4-1-3","SQL Server Transparent Data Encryption","Azure 004 [CIS 4.1.3]"
,,,,,,,,,,,"-","-","-","CIS v8","Ian Pearl","2023-10-05 12:00:00",5,5,"Score is the % of all users that have an MFA device associated with their AWS account. Best=100, Worst=0",99,"-","-","All users should have an MFA device associated with their AWS account.","This use case checks that all users have an MFA device associated with their AWS account.",DNS,"6.1, 6.5, 8.2, 14.2","-","12.8","dns_001","ssphp_use_case_dns_001","No MFA","DNS 001"
,,,,,,,,,,,"-","-","-","CIS v8","Ian Pearl","2023-10-05 12:00:00",5,5,"Score is the % of all AWS user accounts that have 'acceptable (listed)' policies applied. Best=100, Worst=0",99,"-","-","All users should have policies associated with their AWS account that are on the agreed 'Policy List'.","This use case tests whether all accounts with access to the DfE AWS DNS servers have 'acceptable' policies applied",DNS,"6.1, 8.2","-","12.8","dns_002","ssphp_use_case_dns_002","No Policies","DNS 002"
,,,,,,,,,,,"-","-","-","CIS v8","Ian Pearl","2023-10-05 12:00:00",5,5,"Score is calculated as the number of recent 15 minute time periods where there were Cloudtrail events logged as a percentage of the total number of 15 minute time periods. So if there are Cloudtrail logs for every 15 minute period in the past 7 days then the score is 100. Best=100, Worst=0",99,"-","-","Cloudtrail logging should be switched on and correctly delivering logs to Splunk across the AWS estate.","This use case tests whether Cloudtrail logging is switched on and working properly. It measures the health of the Cloudtrail feed over the most recent 7 day period.",DNS,"6.1, 8.2","8.9","3.13, 12.8","dns_003","ssphp_use_case_dns_003","Cloudtrail Working","DNS 003"
,,,,,,,,,,,"-","-","-","CIS v8","Ian Pearl","2023-10-05 12:00:00",5,5,"Score is the % of all AWS accounts that are not part of an 'Organization'. Best=100, Worst=0",99,"-","-","All AWS accounts should be configured to be in the DfE 'Organisation'.","This use case tests whether all AWS accounts are part of an 'Organisation'",DNS,"8.2","8.9","-","dns_004","ssphp_use_case_dns_004","Accounts in Organization","DNS 004"
,,,,,,,,,,,"-","-","-","CIS v8","Ian Pearl","2023-10-05 12:00:00",5,5,"Score is calculated as percentage of real-world DNS records that match their equivalent in AWS Route53. Best=100, Worst=0",99,"-","-","The configuration of DNS servers in the real-world should be the same as that in AWS Route53 at all times.","This use case tests whether what is in Route53 matches what is actually being returned by the DNS server",DNS,"4.1, 8.2","-","-","dns_005","ssphp_use_case_dns_005","DNS = Route53","DNS 005"
"E3 Level 1","Security defaults in Azure Active Directory (Azure AD) make it easier to be secure and help protect the organization. Security defaults contain preconfigured security settings for common attacks. By default, Microsoft enables security defaults. The goal is to ensure that all organizations have a basic level of security-enabled. The security default setting is manipulated in the Azure Portal. The use of security defaults however, will prohibit custom settings which are being set with more advanced settings from this benchmark.","The potential impact associated with disabling of Security Defaults is dependent upon the security controls implemented in the environment. It is likely that most organizations disabling Security Defaults plan to implement equivalent controls to replace Security Defaults. It may be necessary to check settings in other Microsoft products, such as Azure, to ensure settings and functionality are as expected when disabling security defaults for MS365",L1,"1.1.1","Security defaults provide secure default settings that are manage on behalf of organizations to keep customers safe until they are ready to manage their own identity security settings. For example doing the following: Requiring all users and admins to register for MFA, Challenging users with MFA - mostly when they show up on a new device or app, but more often for critical roles and tasks, Disabling authentication from legacy authentication clients, which can’t do MFA."," Ensure Security Defaults is disabled on Azure Active Directory",FALSE,FALSE,FALSE,"-","2023-03-31","CIS Microsoft 365 Foundations Benchmark","2.0.0","CIS v8","Ian Pearl","2023-10-17 14:08:53",5,5,"Score is 100 is isEnabled=false, else 0. Best=100, Worst=0.",99,"-","-","","",M365,"-","-","-","m365_001_cis_1-1-1","ssphp_use_case_m365_001_cis_1-1-1","AAD Security Defaults","M365 001 [CIS 1.1.1]"
,"Azure AD supports the most widely used authentication and authorization protocols including legacy authentication. This authentication pattern includes basic authentication, a widely used industry-standard method for collecting user name and password information.","Enabling this setting will prevent users from connecting with older versions of Office, ActiveSync or using protocols like IMAP, POP or SMTP and may require upgrades to older versions of Office, and use of mobile mail clients that support modern authentication.",L1,"1.1.11","Legacy authentication protocols do not support multi-factor authentication. These protocols are often used by attackers because of this deficiency. Blocking legacy authentication makes it harder for attackers to gain access.  NOTE: As of October 2022 Microsoft began disabling basic authentication in all tenants, except for those who requested special exceptions it should no longer be available in most tenants beyond Dec 31, 2022. Despite this CIS recommends the CA policy to remain in place to act as a defense in depth measure.","Enable Conditional Access policies to block legacy authentication",FALSE,TRUE,TRUE,"4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","31/03/2023","CIS Microsoft 365 Foundations Benchmark","2.0.0","CIS v8","Ian Pearl","2023-10-05 12:00:00",5,5,"Score is 100 if control requirements are confirmed, otherwise 0. Best=100, Worst=0",99,"-","-",,,M365,"-","4.8","4.8","m365_001_cis_1-1-11","ssphp_use_case_m365_001_cis_1-1-11","M365 Block Legacy Authentication","M365 001 [CIS 1.1.11]"
,"Password hash synchronization is one of the sign-in methods used to accomplish hybrid identity synchronization. Azure AD Connect synchronizes a hash, of the hash, of a user's password from an on-premises Active Directory instance to a cloud-based Azure AD instance.  Note: Audit and remediation procedures in this recommendation only apply to Microsoft 365 tenants operating in a hybrid configuration using Azure AD Connect sync.","Compliance or regulatory restrictions may exist, depending on the organization's business sector, that preclude hashed versions of passwords from being securely transmitted to cloud data centers.",L1,"1.1.12","Password hash synchronization helps by reducing the number of passwords your users need to maintain to just one and enables leaked credential detection for your hybrid accounts. Leaked credential protection is leveraged through Azure AD Identity Protection and is a subset of that feature which can help identity if an organization's user account passwords have appeared on the dark web or public spaces. Using other options for your directory synchronization may be less resislient as Microsoft can still process sign-ins to 365 with Hash Sync even if a network connection to your on-premises environment is not available.","Ensure that password hash sync is enabled for hybrid deployments",FALSE,TRUE,TRUE,"6.7 Centralize Access Control","31/03/2023","CIS Microsoft 365 Foundations Benchmark","2.0.0","CIS v8","Ian Pearl","2023-10-05 12:00:00",5,5,"Score is 100 if control requirements are confirmed, otherwise 0. Best=100, Worst=0",99,"-","-",,,M365,"-","6.7","6.7","m365_001_cis_1-1-12","ssphp_use_case_m365_001_cis_1-1-12","M365 Password Hash Sync","M365 001 [CIS 1.1.12]"
,"Azure Active Directory Identity Protection sign-in risk detects risks in real-time and offline. A risky sign-in is an indicator for a sign-in attempt that might not have been performed by the legitimate owner of a user account.","When the policy triggers, the user will need MFA to access the account. In the case of a user who hasn't registered MFA on their account, they would be blocked from accessing their account. It is therefore recommended that the MFA registration policy be configured for all users who are a part of the Sign-in Risk policy.",L2,"1.1.13","Turning on the sign-in risk policy ensures that suspicious sign-ins are challenged for multi-factor authentication.","Enable Azure AD Identity Protection sign-in risk policies",FALSE,TRUE,TRUE,"13.3 Deploy a Network Intrusion Detection Solution","31/03/2023","CIS Microsoft 365 Foundations Benchmark","2.0.0","CIS v8","Ian Pearl","2023-10-05 12:00:00",5,5,"Score is 100 if control requirements are confirmed, otherwise 0. Best=100, Worst=0",99,"-","-",,,M365,"-","13.3","13.3","m365_001_cis_1-1-13","ssphp_use_case_m365_001_cis_1-1-13","Identity Protection Sign-In Risk Policy","M365 001 [CIS 1.1.13]"
,"Azure Active Directory Identity Protection user risk policies detect the probability that a user account has been compromised.","Upon policy activation, account access will be either blocked or the user will be required to use MFA and change their password. Users without registered MFA will be denied access, necessitating an admin to recover the account. To avoid inconvenience, it is advised to configure the MFA registration policy for all users under the User Risk policy. Additionally, users identified in the Risky Users section will be affected by this policy. To gain a better understanding of the impact to the organization's environment, the list of Risky Users should be reviewed before enforcing the policy",L2,"1.1.14","With the user risk policy turned on, Azure AD detects the probability that a user account has been compromised. Administrators can configure a user risk conditional access policy to automatically respond to a specific user risk level.","Enable Azure AD Identity Protection user risk policies",FALSE,TRUE,TRUE,"13.3 Deploy a Network Intrusion Detection Solution","31/03/2023","CIS Microsoft 365 Foundations Benchmark","2.0.0","CIS v8","Ian Pearl","2023-10-05 12:00:00",5,5,"Score is 100 if control requirements are confirmed, otherwise 0. Best=100, Worst=0",99,"-","-",,,M365,"-","13.3","13.3","m365_001_cis_1-1-14","ssphp_use_case_m365_001_cis_1-1-14","Identity Protection User Risk Policies","M365 001 [CIS 1.1.14]"
,"Multi-factor authentication is a process that requires an additional form of identification during the sign-in process, such as a code from a mobile device or a fingerprint scan, to enhance security. Ensure users in administrator roles have MFA capabilities enabled.","Implementation of multifactor authentication for all users in administrative roles will necessitate a change to user routine. All users in administrative roles will be required to enroll in multifactor authentication using phone, SMS, or an authentication application. After enrollment, use of multifactor authentication will be required for future access to the environment.",L1,"1.1.2","Multifactor authentication requires an individual to present a minimum of two separate forms of authentication before access is granted. Multifactor authentication provides additional assurance that the individual attempting to gain access is who they claim to be. With multifactor authentication, an attacker would need to compromise at least two different authentication mechanisms, increasing the difficulty of compromise and thus reducing the risk.","Ensure multifactor authentication is enabled for all users in administrative roles",TRUE,TRUE,TRUE,"6.5 Require MFA for Administrative Access","31/03/2023","CIS Microsoft 365 Foundations Benchmark","2.0.0","CIS v8","Ian Pearl","2023-10-05 12:00:00",5,5,"Score is 100 if control requirements are confirmed, otherwise 0. Best=100, Worst=0",99,"-","-",,,M365,"6.5","6.5","6.5","m365_001_cis_1-1-2","ssphp_use_case_m365_001_cis_1-1-2","M365 Admins have MFA","M365 001 [CIS 1.1.2]"
,"Non-privileged users can create tenants in the Azure AD and Entra administration portal under Manage tenant. The creation of a tenant is recorded in the Audit log as category DirectoryManagement and activity Create Company. Anyone who creates a tenant becomes the Global Administrator of that tenant. The newly created tenant doesn't inherit any settings or configurations.","-",L1,"1.1.22","Restricting tenant creation prevents unauthorized or uncontrolled deployment of resources and ensures that the organization retains control over its infrastructure. User generation of shadow IT could lead to multiple, disjointed environments that can make it difficult for IT to manage and secure the organization's data, especially if other users in the organization began using these tenants for business purposes under the misunderstanding that they were secured by the organization's security team.","Ensure 'Restrict non-admin users from creating tenants' is set to 'Yes'",FALSE,FALSE,FALSE,,"31/03/2023","CIS Microsoft 365 Foundations Benchmark","2.0.0","CIS v8","Ian Pearl","2023-10-05 12:00:00",5,5,"Score is 100 if control requirements are confirmed, otherwise 0. Best=100, Worst=0",99,"-","-",,,M365,"-","-","-","m365_001_cis_1-1-22","ssphp_use_case_m365_001_cis_1-1-22","Non-Admins Creating Tenants","M365 001 [CIS 1.1.22]"
,"Enable multifactor authentication for all users in the Microsoft 365 tenant. Users will be prompted to authenticate with a second factor upon logging in to Microsoft 365 services. The second factor is most commonly a text message to a registered mobile phone number where they type in an authorization code, or with a mobile application like Microsoft Authenticator.","Implementation of multifactor authentication for all users will necessitate a change to user routine. All users will be required to enroll in multifactor authentication using phone, SMS, or an authentication application. After enrollment, use of multifactor authentication will be required for future authentication to the environment.  NOTE: Organizations that have difficulty enforcing MFA globally due lack of the budget to provide company owned mobile devices to every user, or equally are unable to force end users to use their personal devices due to regulations, unions, or policy have another option. FIDO2 Security keys may be used as a stand in to this recommendation. They are more secure, phishing resistant, and are very affordable for an organization to issue to every end user.",L1,"1.1.4","Multifactor authentication requires an individual to present a minimum of two separate forms of authentication before access is granted. Multifactor authentication provides additional assurance that the individual attempting to gain access is who they claim to be. With multifactor authentication, an attacker would need to compromise at least two different authentication mechanisms, increasing the difficulty of compromise and thus reducing the risk.","Ensure multifactor authentication is enabled for all users",FALSE,TRUE,TRUE,"6.3 Require MFA for Externally-Exposed Applications","31/03/2023","CIS Microsoft 365 Foundations Benchmark","2.0.0","CIS v8","Ian Pearl","2023-10-05 12:00:00",5,5,"Score is 100 if control requirements are confirmed, otherwise 0. Best=100, Worst=0",99,"-","-",,,M365,"-","6.3","6.3","m365_001_cis_1-1-4","ssphp_use_case_m365_001_cis_1-1-4","M365 All Users have MFA","M365 001 [CIS 1.1.4]"
,"More than one global administrator should be designated so a single admin can be monitored and to provide redundancy should a single admin leave an organization. Additionally, there should be no more than four global admins set for any tenant. Ideally global administrators will have no licenses assigned to them.","The potential impact associated with ensuring compliance with this requirement is dependent upon the current number of global administrators configured in the tenant. If there is only one global administrator in a tenant, an additional global administrator will need to be identified and configured. If there are more than four global administrators, a review of role requirements for current global administrators will be required to identify which of the users require global administrator access.",L1,"1.1.7","If there is only one global tenant administrator, he or she can perform malicious activity without the possibility of being discovered by another admin. If there are numerous global tenant administrators, the more likely it is that one of their accounts will be successfully breached by an external attacker.","Ensure that between two and four global admins are designated",TRUE,TRUE,TRUE,"5.1 Establish and Maintain an Inventory of Accounts","31/03/2023","CIS Microsoft 365 Foundations Benchmark","2.0.0","CIS v8","Ian Pearl","2023-10-05 12:00:00",5,5,"Score is 100 if control requirements are confirmed, otherwise 0. Best=100, Worst=0",99,"-","-",,,M365,"5.1","5.1","5.1","m365_001_cis_1-1-7","ssphp_use_case_m365_001_cis_1-1-7","M365 Number of Global Admins","M365 001 [CIS 1.1.7]"
,"Enabling self-service password reset allows users to reset their own passwords in Azure AD. When users sign in to Microsoft 365, they will be prompted to enter additional contact information that will help them reset their password in the future. If combined registration is enabled additional information, outside of multi-factor, will not be needed.  NOTE: Effective Oct. 1st, 2022, Microsoft will begin to enable combined registration for all users in Azure AD tenants created before August 15th, 2020. Tenants created after this date are enabled with combined registration by default.","Users will be required to provide additional contact information to enroll in self-service password reset. Additionally, minor user education may be required for users that are used to calling a help desk for assistance with password resets.  NOTE: This is unavailable if using Azure AD Connect / Sync in a hybrid environment.",L1,"1.1.8","Users will no longer need to engage the helpdesk for password resets, and the password reset mechanism will automatically block common, easily guessable passwords.","Ensure 'Self service password reset enabled' is set to 'All'",FALSE,TRUE,TRUE,,"31/03/2023","CIS Microsoft 365 Foundations Benchmark","2.0.0","CIS v8","Ian Pearl","2023-10-05 12:00:00",5,5,"Score is 100 if control requirements are confirmed, otherwise 0. Best=100, Worst=0",99,"-","-",,,M365,"-","-","-","m365_001_cis_1-1-8","ssphp_use_case_m365_001_cis_1-1-8","Self service password reset","M365 001 [CIS 1.1.8]"
,"Modern authentication in Microsoft 365 enables authentication features like multifactor authentication (MFA) using smart cards, certificate-based authentication (CBA), and third-party SAML identity providers. When you enable modern authentication in Exchange Online, Outlook 2016 and Outlook 2013 use modern authentication to log in to Microsoft 365 mailboxes. When you disable modern authentication in Exchange Online, Outlook 2016 and Outlook 2013 use basic authentication to log in to Microsoft 365 mailboxes. When users initially configure certain email clients, like Outlook 2013 and Outlook 2016, they may be required to authenticate using enhanced authentication mechanisms, such as multifactor authentication. Other Outlook clients that are available in Microsoft 365 (for example, Outlook Mobile and Outlook for Mac 2016) always use modern authentication to log in to Microsoft 365 mailboxes.","Users of older email clients, such as Outlook 2013 and Outlook 2016, will no longer be able to authenticate to Exchange using Basic Authentication, which will necessitate migration to modern authentication practices.",L1,"1.1.2","Strong authentication controls, such as the use of multifactor authentication, may be circumvented if basic authentication is used by Exchange Online email clients such as Outlook 2016 and Outlook 2013. Enabling modern authentication for Exchange Online ensures strong authentication mechanisms are used when establishing sessions between email clients and Exchange Online.","Ensure modern authentication for Exchange Online is enabled",FALSE,TRUE,TRUE,"3.10 Encrypt Sensitive Data in Transit","31/03/2023","CIS Microsoft 365 Foundations Benchmark","2.0.0","CIS v8","Ian Pearl","2023-10-05 12:00:00",5,5,"Score is 100 if control requirements are confirmed, otherwise 0. Best=100, Worst=0",99,"-","-",,,M365,"-","3.1","3.1","m365_001_cis_1-2","ssphp_use_case_m365_001_cis_1-2","M365 Exchange Online Modern Authentication","M365 001 [CIS 1.2]"
,"Microsoft cloud-only accounts have a pre-defined password policy that cannot be changed. The only items that can change are the number of days until a password expires and whether or not passwords expire at all.","When setting passwords not to expire it is important to have other controls in place to supplement this setting. See below for related recommendations and user guidance : Ban common passwords, Educate users to not reuse organization passwords anywhere else, Enforce Multi-Factor Authentication registration for all users",L1,"1.4","Organizations such as NIST and Microsoft have updated their password policy recommendations to not arbitrarily require users to change their passwords after a specific amount of time, unless there is evidence that the password is compromised or the user forgot it. They suggest this even for single factor (Password Only) use cases, with a reasoning that forcing arbitrary password changes on users actually make the passwords less secure. Other recommendations within this Benchmark suggest the use of MFA authentication for at least critical accounts (at minimum), which makes password expiration even less useful as well as password protection for Azure AD.","Ensure the 'Password expiration policy' is set to 'Set passwords to never expire",TRUE,TRUE,TRUE,"5.2 Use Unique Passwords","31/03/2023","CIS Microsoft 365 Foundations Benchmark","2.0.0","CIS v8","Ian Pearl","2023-10-05 12:00:00",5,5,"Score is 100 if control requirements are confirmed, otherwise 0. Best=100, Worst=0",99,"-","-",,,M365,"5.2","5.2","5.2","m365_001_cis_1-4","ssphp_use_case_m365_001_cis_1-4","Password expiration policy","M365 001 [CIS 1.4]"
"E3 Level 1","Administrative accounts are special privileged accounts that could have varying levels of access to data, users, and settings. Regular user accounts should never be utilized for Administrative tasks and care should be taken, in the case of a hybrid environment, to keep Administrative accounts separated from on-prem accounts. Administrative accounts should not have applications assigned so that they have no access to potentially vulnerable services (EX. email, Teams, SharePoint, etc.) and only access to perform tasks as needed for Administrative purposes. Ensure administrative accounts are licensed without attached applications and cloud-only.","Administrative users will have to switch accounts and utilizing login/logout functionality when performing Administrative tasks, as well as not benefiting from SSO.",L1,"1.5","Ensuring administrative accounts are cloud-only, without applications assigned to them will reduce the attack surface of high privileged identities in your environment. In order to participate in Microsoft 365 security services such as Identity Protection, PIM and Conditional Access an administrative account will need a license attached to it. Ensure that the license used does not include any applications with potentially vulnerable services by using either Azure Premium P1 or Azure Premium P2 for the cloud-only account with administrator roles. In a hybrid environment, having separate accounts will help ensure that in the event of a breach in the cloud, that the breach does not affect the on-prem environment and viceversa","Ensure Administrative accounts are separate and cloud only",TRUE,TRUE,TRUE,"5.4 Restrict Administrator Privileges to Dedicated Administrator Accounts","2023-03-31","CIS Microsoft 365 Foundations Benchmark","2.0.0","CIS v8","Ian Pearl","2023-10-13 08:55:29",5,5,"Score is the percentage of admin accounts where account is sync'd between cloud and on-prem. Best=100, Worst=0.",99,"-","-","","",M365,"5.4","5.4","5.4","m365_001_cis_1-5","ssphp_use_case_m365_001_cis_1-5","Seperate Admin Accounts for Cloud and On-Prem","M365 001 [CIS 1.5]"
,"Idle session timeout allows the configuration of a setting which will timeout inactive users after a pre-determined amount of time. When a user reaches the set idle timeout session, they'll get a notification that they're about to be signed out. They have to select to stay signed in or they'll be automatically signed out of all Microsoft 365 web apps. Combined with a Conditional Access rule this will only impact unmanaged devices. A managed device is considered a device managed by Intune MDM.  The following Microsoft 365 web apps are supported : Outlook Web App, OneDrive for Business, SharePoint Online (SPO), Office.com and other start pages, Office (Word, Excel, PowerPoint) on the web, Microsoft 365 Admin Center.  NOTE: Idle session timeout doesn't affect Microsoft 365 desktop and mobile apps. The recommended setting is 1 hour (or less) for unmanaged devices.","If step 2 in the Audit/Remediation procedure is left out then there is no issue from this from a security standpoint. However, it will require users on trusted devices to sign in more frequently which could result in credential prompt fatigue.",L1,"1.7","Ending idle sessions through an automatic process can help protect sensitive company data, and will add another layer of security for end users who work on unmanaged devices that can potentially be accessed by the public. Unauthorized individuals onsite or remotely can take advantage of systems left unattended over time. Automatic timing out of sessions makes this more difficult.","Ensure 'Idle session timeout' is set to '1 hour (or less)' for unmanaged devices",TRUE,TRUE,TRUE,"4.3 Configure Automatic Session Locking on Enterprise Assets","31/03/2023","CIS Microsoft 365 Foundations Benchmark","2.0.0","CIS v8","Ian Pearl","2023-10-05 12:00:00",5,5,"Score is 100 if control requirements are confirmed, otherwise 0. Best=100, Worst=0",99,"-","-",,,M365,"4.3","4.3","4.3","m365_001_cis_1-7","ssphp_use_case_m365_001_cis_1-7","Idle session timeout","M365 001 [CIS 1.7]"
,"The admin consent workflow gives admins a secure way to grant access to applications that require admin approval. When a user tries to access an application but is unable to provide consent, they can send a request for admin approval. The request is sent via email to admins who have been designated as reviewers. A reviewer takes action on the request, and the user is notified of the action.","To approve requests, a reviewer must be a global administrator, cloud application administrator, or application administrator. The reviewer must already have one of these admin roles assigned; simply designating them as a reviewer doesn't elevate their privileges.",L1,"2.1","The admin consent workflow (Preview) gives admins a secure way to grant access to applications that require admin approval. When a user tries to access an application but is unable to provide consent, they can send a request for admin approval. The request is sent via email to admins who have been designated as reviewers. A reviewer acts on the request, and the user is notified of the action.","Ensure the admin consent workflow is enabled",FALSE,TRUE,TRUE,"2.5 Allowlist Authorized Software","31/03/2023","CIS Microsoft 365 Foundations Benchmark","2.0.0","CIS v8","Ian Pearl","2023-10-05 12:00:00",5,5,"Score is 100 if control requirements are confirmed, otherwise 0. Best=100, Worst=0",99,"-","-",,,M365,"-","2.5","2.5","m365_002_cis_2-1","ssphp_use_case_m365_002_cis_2-1",,"M365 002 [CIS 2.1]"
,"App registrations allows users to register custom-developed applications for use within the directory.","Implementation of this change will impact both end users and administrators. End users will not be able to integrate third-party applications that they may wish to use. Administrators are likely to receive requests from end users to grant them permission to necessary third-party applications.",L2,"2.2","Third party integrated applications connection to services should be disabled, unless there is a very clear value and robust security controls are in place. While there are legitimate uses, attackers can grant access from breached accounts to third party applications to exfiltrate data from your tenancy without having to maintain the breached account.","Ensure the admin consent workflow is enabled",FALSE,TRUE,TRUE,"2.5 Allowlist Authorized Software","31/03/2023","CIS Microsoft 365 Foundations Benchmark","2.0.0","CIS v8","Ian Pearl","2023-10-05 12:00:00",5,5,"Score is 100 if control requirements are confirmed, otherwise 0. Best=100, Worst=0",99,"-","-",,,M365,"-","2.5","2.5","m365_002_cis_2-2","ssphp_use_case_m365_002_cis_2-2","Integrated Apps Not Allowed","M365 002 [CIS 2.2]"
,"By default, users can install add-ins in their Microsoft Word, Excel, and PowerPoint applications, allowing data access within the application. Do not allow users to install add-ins in Word, Excel, or PowerPoint.","Attackers commonly use vulnerable and custom-built add-ins to access data in user applications. While allowing users to install add-ins by themselves does allow them to easily acquire useful add-ins that integrate with Microsoft applications, it can represent a risk if not used and monitored carefully. Disable future user's ability to install add-ins in Microsoft Word, Excel, or PowerPoint helps reduce your threat-surface and mitigate this risk.",L1,"2.9","Attackers commonly use vulnerable and custom-built add-ins to access data in user applications. While allowing users to install add-ins by themselves does allow them to easily acquire useful add-ins that integrate with Microsoft applications, it can represent a risk if not used and monitored carefully. Disable future user's ability to install add-ins in Microsoft Word, Excel, or PowerPoint helps reduce your threat-surface and mitigate this risk.","Ensure 'User owned apps and services' is restricted",FALSE,TRUE,TRUE,"4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","31/03/2023","CIS Microsoft 365 Foundations Benchmark","2.0.0","CIS v8","Ian Pearl","2023-10-05 12:00:00",5,5,"Score is 100 if control requirements are confirmed, otherwise 0. Best=100, Worst=0",99,"-","-",,,M365,"-","4.8","4.8","m365_002_cis_2-9","ssphp_use_case_m365_002_cis_2-9","User Owned Apps and Services","M365 002 [CIS 2.9]"
,"Customer Lockbox is a security feature that provides an additional layer of control and transparency to customer data in Microsoft 365. It offers an approval process for Microsoft support personnel to access organization data and creates an audited trail to meet compliance requirements.","Administrators will need to grant Microsoft access to the tenant environment prior to a Microsoft engineer accessing the environment for support or troubleshooting.",L2,"3.1","Enabling this feature protects organizational data against data spillage and exfiltration.","Ensure the customer lockbox feature is enabled",FALSE,FALSE,FALSE,,"31/03/2023","CIS Microsoft 365 Foundations Benchmark","2.0.0","CIS v8","Ian Pearl","2023-10-05 12:00:00",5,5,"Score is 100 if control requirements are confirmed, otherwise 0. Best=100, Worst=0",99,"-","-",,,M365,"-","-","-","m365_003_cis_3-1","ssphp_use_case_m365_003_cis_3-1","M365 Customer Lockbox","M365 003 [CIS 3.1]"
,"MailTips are informative messages displayed to users while they're composing a message. While a new message is open and being composed, Exchange analyzes the message (including recipients). If a potential problem is detected, the user is notified with a MailTip prior to sending the message. Using the information in the MailTip, the user can adjust the message to avoid undesirable situations or non-delivery reports (also known as NDRs or bounce messages).","-",L2,"4.11","Setting up MailTips gives a visual aid to users when they send emails to large groups of recipients or send emails to recipients not within the tenant.","Ensure MailTips are enabled for end users",FALSE,FALSE,FALSE,,"31/03/2023","CIS Microsoft 365 Foundations Benchmark","2.0.0","CIS v8","Ian Pearl","2023-10-05 12:00:00",5,5,"Score is 100 if control requirements are confirmed, otherwise 0. Best=100, Worst=0",99,"-","-",,,M365,"-","-","-","m365_004_cis_4-11","ssphp_use_case_m365_004_cis_4-11","M365 MailTips for end users","M365 001 [CIS 4.11]"
"E5 Level 2","Microsoft Defender for Cloud Apps is a Cloud Access Security Broker (CASB). It provides visibility into suspicious activity in Microsoft 365, enabling investigation into potential security issues and facilitating the implementation of remediation measures if necessary. Some risk detection methods provided by Azure AD Identity Protection also require Microsoft Defender for Cloud Apps: Suspicious manipulation of inbox rules, Suspicious inbox forwarding, New country detection, Impossible travel detection, Activity from anonymous IP addresses, Mass access to sensitive files. https://docs.microsoft.com/en-us/azure/active-directory/identity-protection/conceptidentity-protection-risks","-",L2,"5.13","Security teams can receive notifications of triggered alerts for atypical or suspicious activities, see how the organization's data in Microsoft 365 is accessed and used, suspend user accounts exhibiting suspicious activity, and require users to log back in to Microsoft 365 apps after an alert has been triggered.","Ensure Microsoft Defender for Cloud Apps is enabled and configured",TRUE,TRUE,TRUE,"10.1 Deploy and Maintain Anti-Malware Software
10.5 Enable Anti-Exploitation Features","2023-03-31","CIS Microsoft 365 Foundations Benchmark","2.0.0","CIS v8","Ian Pearl","2023-10-16 14:52:19",5,5,"This score has been input manually. Best=100, Worst=0.",99,"-","-","","",M365,"10.1","10.1, 10.5","10.1, 10.5","m365_005_cis_5-13","ssphp_use_case_m365_005_cis_5-13","Microsoft Defender for Cloud Apps","M365 005 [CIS 5.13]"
,"By turning on mailbox auditing, Microsoft 365 back office teams can track logons to a mailbox as well as what actions are taken while the user is logged on. After you turn on mailbox audit logging for a mailbox, you can search the audit log for mailbox activity. Additionally, when mailbox audit logging is turned on, some actions performed by administrators, delegates, and owners are logged by default.","-",L1,"5.3","Starting in January 2019, Microsoft is turning on mailbox audit logging by default for all organizations. This means that certain actions performed by mailbox owners, delegates, and admins are automatically logged, and the corresponding mailbox audit records will be available when you search for them in the mailbox audit log. When mailbox auditing on by default is turned on for the organization, the AuditEnabled property for affected mailboxes won't be changed from False to True. In other words, mailbox auditing on by default ignores the AuditEnabled property on mailboxes. However, only certain mailbox types support default auditing On : User Mailboxes, Shared Mailboxes, Microsoft 365 Group Mailboxes.  The remaining mailbox types require auditing be turned on at the mailbox level: Resource Mailboxes, Public Folder Mailboxes, DiscoverySearch Mailbox.  Whether it is for regulatory compliance or for tracking unauthorized configuration changes in Microsoft 365, enabling mailbox auditing allows for Microsoft 365 back office teams to run security operations, forensics or general investigations on mailbox activities.  NOTE: Without advanced auditing (E5 function) the logs are limited to 90 days.","Ensure mailbox auditing for all users is Enabled",TRUE,TRUE,TRUE,"8.2 Collect Audit Logs","31/03/2023","CIS Microsoft 365 Foundations Benchmark","2.0.0","CIS v8","Ian Pearl","2023-10-05 12:00:00",5,5,"Score is 100 if control requirements are confirmed, otherwise 0. Best=100, Worst=0",99,"-","-",,,M365,"8.2","8.2","8.2","m365_005_cis_5-3","ssphp_use_case_m365_005_cis_5-3","M365 Mailbox Auditing","M365 005 [CIS 5.3]"
,"Control sharing of documents to external domains by either blocking domains or only allowing sharing with specific named domains.","Enabling this feature will prevent users from sharing documents with domains outside of the organization unless allowed.",L2,"6.1","Attackers will often attempt to expose sensitive information to external entities through sharing, and restricting the domains that users can share documents with will reduce that surface area.","Ensure SharePoint external sharing is managed through domain whitelist/blacklists",TRUE,TRUE,TRUE,"3.3 Configure Data Access Control Lists","31/03/2023","CIS Microsoft 365 Foundations Benchmark","2.0.0","CIS v8","Ian Pearl","2023-10-05 12:00:00",5,5,"Score is 100 if control requirements are confirmed, otherwise 0. Best=100, Worst=0",99,"-","-",,,M365,"3.3","3.3","3.3","m365_006_cis_6-1","ssphp_use_case_m365_006_cis_6-1","SharePoint external sharing","M365 006 [CIS 6.1]"
,"Microsoft OneDrive allows users to sign in their cloud tenant account, and begin syncing select folders or the entire contents of OneDrive to a local computer. By default this includes any computer with OneDrive already installed, whether or not it is Azure Domain Joined or Active Directory Domain joined.","Enabling this feature will prevent users from using the OneDrive for Business Sync client on devices that are not joined to the domains that were defined.",L2,"6.2","Unmanaged devices pose a risk, since their security cannot be verified through existing security policies, brokers or endpoint protection. Allowing users to sync data to these devices takes that data out of the control of the organization. This increases the risk of the data either being intentionally or accidentally leaked.  Note: This setting is only applicable to Active Directory domains when operating in a hybrid configuration. It does not apply to Azure AD domains. If there are devices which are only Azure AD joined, consider using a Conditional Access Policy instead.","Block OneDrive for Business sync from unmanaged devices",FALSE,FALSE,FALSE,,"31/03/2023","CIS Microsoft 365 Foundations Benchmark","2.0.0","CIS v8","Ian Pearl","2023-10-05 12:00:00",5,5,"Score is 100 if control requirements are confirmed, otherwise 0. Best=100, Worst=0",99,"-","-",,,M365,"-","-","-","m365_006_cis_6-2","ssphp_use_case_m365_006_cis_6-2","OneDrive sync from unmanaged devices","M365 006 [CIS 6.2]"
