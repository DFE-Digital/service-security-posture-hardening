<form theme="dark" version="1.1">
  <label>Github Findings</label>
  
  <fieldset submitButton="false">
    <input type="multiselect" token="tkn_use_cases" searchWhenChanged="true">
      <label>Select Use Cases</label>
      <choice value="*">ALL</choice>
      <choice value="Change Branch Protection Rules">Change Branch Protection Rules</choice>
      <choice value="CodeQL">CodeQL scanning</choice>
      <choice value="CVE">CVE</choice>
      <choice value="Disable Secret Scanning">Disable Secret Scanning</choice>
      <choice value="Repo Made Public">Repo Made Public</choice>
      <choice value="Secret">Secret in Repo</choice>
      <default>*</default>
      <prefix> (</prefix>
      <suffix>) </suffix>
      <initialValue>*</initialValue>
      <valuePrefix>ssphp_use_case="</valuePrefix>
      <valueSuffix>"</valueSuffix>
      <delimiter> OR </delimiter>
    </input>
  </fieldset>
  
  
  <row>
    <panel>
      <table>
        <search>
          <query>
  index="ssphp_github_summary" 
  (
  (ssphp_use_case="CVE" AND [| inputlookup ssphp_latest_run_times.csv where ssphp_use_case="CVE" | stats max(SSPHP_RUN) as SSPHP_RUN | return SSPHP_RUN]) OR 
   (ssphp_use_case="Secret" AND [| inputlookup ssphp_latest_run_times.csv where ssphp_use_case="Secret" | stats max(SSPHP_RUN) as SSPHP_RUN | return SSPHP_RUN]) OR 
   (ssphp_use_case="Disable Secret Scanning" AND [| inputlookup ssphp_latest_run_times.csv where ssphp_use_case="Disable Secret Scanning" | stats max(SSPHP_RUN) as SSPHP_RUN | return SSPHP_RUN]) OR 
   (ssphp_use_case="Repo Made Public" AND [| inputlookup ssphp_latest_run_times.csv where ssphp_use_case="Repo Made Public" | stats max(SSPHP_RUN) as SSPHP_RUN | return SSPHP_RUN]) OR 
   (ssphp_use_case="Change Branch Protection Rules" AND [| inputlookup ssphp_latest_run_times.csv where ssphp_use_case="Change Branch Protection Rules" | stats max(SSPHP_RUN) as SSPHP_RUN | return SSPHP_RUN]) OR 
   (ssphp_use_case="CodeQL" AND [| inputlookup ssphp_latest_run_times.csv where ssphp_use_case="CodeQL" | stats max(SSPHP_RUN) as SSPHP_RUN | return SSPHP_RUN])
   )
  
  | rex field=ssphp_repository "(?&lt;ssphp_organization&gt;[^\/]*)\/(?&lt;ssphp_repository&gt;.*)"
  
  | search $tkn_use_cases$
  
  | table ssphp_event_time, ssphp_action, ssphp_created_at, ssphp_tech_source, ssphp_use_case, ssphp_organization, ssphp_repository, ssphp_details, ssphp_severity, ssphp_state, ssphp_url, ssphp_original_event, SSPHP_RUN
  | sort 0 - ssphp_created_at
            </query>
          <earliest>0</earliest>
          <latest>now</latest>
          <sampleRatio>1</sampleRatio>
        </search>
        <option name="count">100</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">cell</option>
        <option name="percentagesRow">false</option>
        <option name="rowNumbers">false</option>
        <option name="totalsRow">false</option>
        <option name="wrap">true</option>
        <format type="color" field="ssphp_use_case">
          <colorPalette type="expression">case(value="CVE","#E59866",value="Repo Made Public","#F7DC6F",value="Disable Secret Scanning","#76D7C4",value="Change Branch Protection Rules","#7FB3D5",value="CodeQL","#C39BD3",value="Secret","#DAF7A6",1==1,"#000000")</colorPalette>
        </format>
        <fields>["ssphp_event_time","ssphp_action","ssphp_created_at","ssphp_tech_source","ssphp_use_case", "ssphp_organization", "ssphp_repository", "ssphp_details","ssphp_severity","ssphp_state","ssphp_url"]</fields>
        <drilldown>
          <link target="_blank">/app/SSPHP/ssphp_github_findings_drilldown_dashboard?tkn_original_event=$row.ssphp_original_event$</link>
        </drilldown>
      </table>
    </panel>
  </row>
</form>