[azure:security:alert]
ADD_EXTRA_TIME_FIELDS = 1
ANNOTATE_PUNCT = 1
AUTO_KV_JSON = 1
CHARSET = UTF-8
DATETIME_CONFIG = /etc/datetime.xml
BREAK_ONLY_BEFORE_DATE = 1
DEPTH_LIMIT = 1000
DETERMINE_TIMESTAMP_DATE_WITH_SYSTEM_TIME = 0
EVAL-SSPHP_RUN = substr(SSPHP_RUN,1,10)
EVAL-ssphp_alert_id = MD5('id')
EVAL-ssphp_alert_description = 'properties.description'
EVAL-ssphp_alert_name = 'properties.alertDisplayName'
EVAL-ssphp_alerts_meta_entities = 'meta.entities{}{}'
EVAL-ssphp_resource_id = coalesce('properties.entities{}.resourceId','properties.resourceIdentifiers{}.azureResourceId','properties.entities{}.hostName')
EVAL-ssphp_resources_affected = 'properties.compromisedEntity'
EVAL-ssphp_run = strftime(SSPHP_RUN,"%Y-%m-%d %H:%M:%S")
EVAL-ssphp_severity = 'properties.severity'
EVAL-ssphp_start_time = replace(substr('properties.startTimeUtc',1,19),"T"," ")
EVAL-ssphp_start_time_epoch = round(strptime('properties.startTimeUtc',"%Y-%m-%dT%H:%M:%S"))
EVAL-ssphp_status = 'properties.status'
LB_CHUNK_BREAKER_TRUNCATE = 2000000
LEARN_MODEL = 1
LEARN_SOURCETYPE = 1
LINE_BREAKER_LOOKBEHIND = 100
MATCH_LIMIT = 100000
MAX_DAYS_AGO = 2000
MAX_DAYS_HENCE = 2
MAX_DIFF_SECS_AGO = 3600
MAX_DIFF_SECS_HENCE = 604800
MAX_EVENTS = 256
MAX_TIMESTAMP_LOOKAHEAD = 128
SEGMENTATION = indexing
SEGMENTATION-all = full
SEGMENTATION-inner = inner
SEGMENTATION-outer = outer
SEGMENTATION-raw = none
SEGMENTATION-standard = standard
SHOULD_LINEMERGE = 1
TRUNCATE = 100000

###############################################################################################################################################################

[azure:security:finding]
ADD_EXTRA_TIME_FIELDS = 1
ANNOTATE_PUNCT = 1
AUTO_KV_JSON = 1
CHARSET = UTF-8
DATETIME_CONFIG = /etc/datetime.xml
BREAK_ONLY_BEFORE_DATE = 1
DEPTH_LIMIT = 1000
DETERMINE_TIMESTAMP_DATE_WITH_SYSTEM_TIME = 0
EVAL-SSPHP_RUN = substr(SSPHP_RUN,1,10)
EVAL-ssphp_assess_status = 'assessment.properties.status.code'
EVAL-ssphp_assessment_id = lower('assessment.id')
EVAL-ssphp_category = mvdedup(mvappend('assessment_metadata.properties.categories{}','sub_assessment.properties.category'))
EVAL-ssphp_creation_time = replace(substr('assessment.properties.status.firstEvaluationDate',1,19),"T"," ")
EVAL-ssphp_creation_time_epoch = round(strptime('assessment.properties.status.firstEvaluationDate',"%Y-%m-%dT%H:%M:%S"))
EVAL-ssphp_event_time = strftime(_time,"%Y-%m-%d %H:%M:%S")
EVAL-ssphp_event_uid = round('_time')."~~~".md5(_raw)
EVAL-ssphp_impact = if(isnotnull('sub_assessment.properties.impact'),'sub_assessment.properties.impact',"Unknown")
EVAL-ssphp_last_changed_time = replace(substr('assessment.properties.status.statusChangeDate',1,19),"T"," ")
EVAL-ssphp_last_changed_time_epoch = round(strptime('assessment.properties.status.statusChangeDate',"%Y-%m-%dT%H:%M:%S"))
EVAL-ssphp_metadata_id = lower('assessment_metadata.id')
EVAL-ssphp_policy_uid = mvindex(split('assessment_metadata.properties.policyDefinitionId', "/"), -1)
EVAL-ssphp_policy_description = mvdedup(mvappend('assessment_metadata.properties.description','sub_assessment.properties.description'))
EVAL-ssphp_policy_name = mvdedup(mvappend('assessment.properties.displayName','assessment_metadata.properties.displayName','sub_assessment.properties.displayName'))
EVAL-ssphp_remediation = mvdedup(mvappend('assessment_metadata.properties.remediationDescription','sub_assessment.properties.remediation'))
EVAL-ssphp_resource_group = mvdedup(mvappend('meta.assessment.id.resource_group','meta.assessment.resource_id.resource_group','meta.sub_assessment.id.resource_group','meta.sub_assessment.resource_id.resource_group'))
EVAL-ssphp_resource_names = mvdedup(mvappend('meta.assessment.id.name','meta.assessment.resource_id.name','meta.sub_assessment.id.name','meta.sub_assessment.resource_id.name'))
EVAL-ssphp_resource_types = mvdedup(mvappend('meta.assessment.id.type','meta.assessment.resource_id.type','meta.sub_assessment.id.type','meta.sub_assessment.resource_id.type'))
EVAL-ssphp_resources_affected = mvdedup(mvappend('meta.assessment.resource_id.resource_type'."=".'meta.assessment.resource_id.resource_name','meta.sub_assessment.resource_id.resource_type'."=".'meta.sub_assessment.resource_id.resource_name','meta.assessment.id.type'."=".'meta.assessment.id.name','meta.assessment.resource_id.type'."=".'meta.assessment.resource_id.name','meta.sub_assessment.id.type'."=".'meta.sub_assessment.id.name','meta.sub_assessment.resource_id.type'."=".'meta.sub_assessment.resource_id.name'))
EVAL-ssphp_run = strftime(SSPHP_RUN,"%Y-%m-%d %H:%M:%S")
EVAL-ssphp_severity = coalesce('assessment_metadata.properties.severity','sub_assessment.properties.status.severity')
EVAL-ssphp_status = coalesce('assessment.properties.status.code','sub_assessment.properties.status.code')
EVAL-ssphp_status_cause = mvdedup(mvappend("Sub=".'sub_assessment.properties.status.cause',"Assess=".'assessment.properties.status.cause'))
EVAL-ssphp_sub_assessment_id = lower('sub_assessment.id')
EVAL-ssphp_subscription = mvdedup(mvappend('meta.assessment.id.subscription','meta.assessment.resource_id.subscription','meta.sub_assessment.id.subscription','meta.sub_assessment.resource_id.subscription'))
EVAL-ssphp_tactics = if(isnotnull('assessment_metadata.properties.tactics{}'),'assessment_metadata.properties.tactics{}',"Unknown")
EVAL-ssphp_techniques = if(isnotnull('assessment_metadata.properties.techniques{}'),'assessment_metadata.properties.techniques{}',"Unknown")
EVAL-ssphp_threats = if(isnotnull('assessment_metadata.properties.threats{}'),'assessment_metadata.properties.threats{}',"Unknown")
EVAL-ssphp_user_impact = if(isnotnull('assessment_metadata.properties.userImpact'),'assessment_metadata.properties.userImpact',"Unknown")
LB_CHUNK_BREAKER_TRUNCATE = 2000000
LEARN_MODEL = 1
LEARN_SOURCETYPE = 1
LINE_BREAKER_LOOKBEHIND = 100
#LOOKUP-ssphp_resource_service_map = ssphp_resource_service_map ssphp_resource_group AS ssphp_resource_group OUTPUT ssphp_business_service_index AS ssphp_business_service_index ssphp_environment AS ssphp_environment ssphp_location AS ssphp_location ssphp_parent_business AS ssphp_parent_business ssphp_portfolio AS ssphp_portfolio ssphp_product AS ssphp_product ssphp_service AS ssphp_service ssphp_service_line AS ssphp_service_line ssphp_service_name AS ssphp_service_name ssphp_service_offering AS ssphp_service_offering ssphp_service_team AS ssphp_service_team ssphp_tech_contact_email AS ssphp_tech_contact_email ssphp_tech_dir_arch_partner AS ssphp_tech_dir_arch_partner ssphp_tenant AS ssphp_tenant ssphp_tenant_name AS ssphp_tenant_name ssphp_level_1 as ssphp_level_1 ssphp_level_1_display_name as ssphp_level_1_display_name ssphp_level_2 as ssphp_level_2 ssphp_level_2_display_name as ssphp_level_2_display_name
LOOKUP-ssphp_azure_resource_cmdb_csv = ssphp_azure_resource_cmdb_csv ssphp_id AS ssphp_id OUTPUT ssphp_business_service_index AS ssphp_business_service_index ssphp_environment AS ssphp_environment ssphp_level_1 AS ssphp_level_1 ssphp_level_1_display_name AS ssphp_level_1_display_name ssphp_level_2 AS ssphp_level_2 ssphp_level_2_display_name AS ssphp_level_2_display_name ssphp_location AS ssphp_location ssphp_parent_business AS ssphp_parent_business ssphp_portfolio AS ssphp_portfolio ssphp_product AS ssphp_product ssphp_resource_azure_finding_count AS ssphp_resource_azure_finding_count ssphp_resource_group AS ssphp_resource_group ssphp_service AS ssphp_service ssphp_service_line AS ssphp_service_line ssphp_service_name AS ssphp_service_name ssphp_service_offering AS ssphp_service_offering ssphp_service_team AS ssphp_service_team ssphp_subscription AS ssphp_subscription ssphp_subscription_display_name AS ssphp_subscription_display_name ssphp_tech_contact_email AS ssphp_tech_contact_email ssphp_tech_dir_arch_partner AS ssphp_tech_dir_arch_partner ssphp_tenant AS ssphp_tenant ssphp_tenant_name AS ssphp_tenant_name
MATCH_LIMIT = 100000
MAX_DAYS_AGO = 2000
MAX_DAYS_HENCE = 2
MAX_DIFF_SECS_AGO = 3600
MAX_DIFF_SECS_HENCE = 604800
MAX_EVENTS = 256
MAX_TIMESTAMP_LOOKAHEAD = 128
SEGMENTATION = indexing
SEGMENTATION-all = full
SEGMENTATION-inner = inner
SEGMENTATION-outer = outer
SEGMENTATION-raw = none
SEGMENTATION-standard = standard
SHOULD_LINEMERGE = 1
TRUNCATE = 100000

###############################################################################################################################################################

[azure:security:score]
ADD_EXTRA_TIME_FIELDS = 1
ANNOTATE_PUNCT = 1
AUTO_KV_JSON = 1
CHARSET = UTF-8
DATETIME_CONFIG = /etc/datetime.xml
BREAK_ONLY_BEFORE_DATE = 1
DEPTH_LIMIT = 1000
DETERMINE_TIMESTAMP_DATE_WITH_SYSTEM_TIME = 0
EVAL-ssphp_score_current = 'properties.score.current'
EVAL-ssphp_score_max = 'properties.score.max'
EVAL-ssphp_score_percent = 'properties.score.percentage'
EVAL-ssphp_score_precent_1 = 1-'properties.score.percentage'
EVAL-ssphp_score_weight = 'properties.weight'
EVAL-ssphp_subscription = 'meta.id.subscription'
LB_CHUNK_BREAKER_TRUNCATE = 2000000
LEARN_MODEL = 1
LEARN_SOURCETYPE = 1
LINE_BREAKER_LOOKBEHIND = 100
MATCH_LIMIT = 100000
MAX_DAYS_AGO = 2000
MAX_DAYS_HENCE = 2
MAX_DIFF_SECS_AGO = 3600
MAX_DIFF_SECS_HENCE = 604800
MAX_EVENTS = 256
MAX_TIMESTAMP_LOOKAHEAD = 128
SEGMENTATION = indexing
SEGMENTATION-all = full
SEGMENTATION-inner = inner
SEGMENTATION-outer = outer
SEGMENTATION-raw = none
SEGMENTATION-standard = standard
SHOULD_LINEMERGE = 1
TRUNCATE = 10000

###############################################################################################################################################################

[azure:resource:graph]
ADD_EXTRA_TIME_FIELDS = 1
ANNOTATE_PUNCT = 1
AUTO_KV_JSON = 1
CHARSET = UTF-8
DATETIME_CONFIG = /etc/datetime.xml
BREAK_ONLY_BEFORE_DATE = 1
DEPTH_LIMIT = 1000
DETERMINE_TIMESTAMP_DATE_WITH_SYSTEM_TIME = 0
EVAL-ssphp_id = lower(id)
LB_CHUNK_BREAKER_TRUNCATE = 2000000
LEARN_MODEL = 1
LEARN_SOURCETYPE = 1
LINE_BREAKER_LOOKBEHIND = 100
MATCH_LIMIT = 100000
MAX_DAYS_AGO = 2000
MAX_DAYS_HENCE = 2
MAX_DIFF_SECS_AGO = 3600
MAX_DIFF_SECS_HENCE = 604800
MAX_EVENTS = 256
MAX_TIMESTAMP_LOOKAHEAD = 128
SEGMENTATION = indexing
SEGMENTATION-all = full
SEGMENTATION-inner = inner
SEGMENTATION-outer = outer
SEGMENTATION-raw = none
SEGMENTATION-standard = standard
SHOULD_LINEMERGE = 1
TRUNCATE = 10000

###############################################################################################################################################################

[github_json]
DATETIME_CONFIG = CURRENT
LINE_BREAKER = ([\r\n]+)
NO_BINARY_CHECK = true
TRUNCATE = 200000
category = Structured
description = Github logs
pulldown_type = 1