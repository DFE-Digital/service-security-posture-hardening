[ssphp_create_last_ssphp_drop_csv]
action.cryptolert.param.debug = 1
action.email = 0
action.email.show_password = 1
action.email.useNSSubject = 1
action.populate_lookup = 0
action.rss = 0
action.summary_index = 0
action.summary_index.force_realtime_schedule = 0
action.webhook.enable_allowlist = 1
alert.digest_mode = 1
alert.expires = 24h
alert.severity = 3
alert.track = 0
allow_skew = 12m
auto_summarize = 0
auto_summarize.command = | summarize override=partial timespan=$auto_summarize.timespan$ max_summary_size=$auto_summarize.max_summary_size$ max_summary_ratio=$auto_summarize.max_summary_ratio$ max_disabled_buckets=$auto_summarize.max_disabled_buckets$ max_time=$auto_summarize.max_time$ [ $search$ ]
auto_summarize.cron_schedule = */10 * * * *
auto_summarize.dispatch.time_format = %FT%T.%Q%:z
auto_summarize.dispatch.ttl = 60
auto_summarize.max_concurrent = 1
auto_summarize.max_disabled_buckets = 2
auto_summarize.max_summary_ratio = 0.1
auto_summarize.max_summary_size = 52428800
auto_summarize.max_time = 3600
auto_summarize.suspend_period = 24h
counttype = always
cron_schedule = */5 * * * *
defer_scheduled_searchable_idxc = 0
disabled = 0
dispatch.allow_partial_results = 1
dispatch.auto_cancel = 0
dispatch.auto_pause = 0
dispatch.buckets = 0
dispatch.earliest_time = -30d@d
dispatch.latest_time = now
dispatch.lookups = 1
dispatch.max_count = 500000
dispatch.max_time = 0
dispatch.rate_limit_retry = 0
dispatch.reduce_freq = 10
dispatch.rt_backfill = 0
dispatch.sample_ratio = 1
dispatch.spawn_process = 1
dispatch.time_format = %FT%T.%Q%:z
dispatch.ttl = 2p
dispatchAs = owner
display.events.fields = ["host","source","sourcetype","callerIpAddress","category","correlationId","date_hour","date_mday","date_minute","date_month","date_second","date_wday","date_year","date_zone","durationMs","identity.authorization.action","identity.authorization.evidence.principalId","identity.authorization.evidence.principalType","identity.authorization.evidence.role","identity.authorization.evidence.roleAssignmentId","identity.authorization.evidence.roleAssignmentScope","identity.authorization.evidence.roleDefinitionId","identity.authorization.scope","identity.claims.aio","identity.claims.altsecid","identity.claims.appid","identity.claims.appidacr","identity.claims.aud","identity.claims.exp","identity.claims.groups","identity.claims.http://schemas.microsoft.com/claims/authnclassreference","identity.claims.http://schemas.microsoft.com/claims/authnmethodsreferences","identity.claims.http://schemas.microsoft.com/identity/claims/identityprovider","identity.claims.http://schemas.microsoft.com/identity/claims/objectidentifier","identity.claims.http://schemas.microsoft.com/identity/claims/scope","identity.claims.http://schemas.microsoft.com/identity/claims/tenantid","identity.claims.http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress","identity.claims.http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname","identity.claims.http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name","identity.claims.http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier","identity.claims.http://schemas.xmlsoap.org/ws/2005/05/identity/claims/surname","identity.claims.iat","identity.claims.idtyp","identity.claims.ipaddr","identity.claims.iss","identity.claims.name","identity.claims.nbf","identity.claims.puid","identity.claims.rh","identity.claims.uti","identity.claims.ver","identity.claims.wids","identity.claims.xms_cc","identity.claims.xms_tcdt","index","jobId","jobType","level","linecount","operationName","properties.entity","properties.eventCategory","properties.hierarchy","properties.message","properties.requestbody","properties.responseBody","properties.serviceRequestId","properties.statusCode","punct","ReleaseVersion","resourceId","resultSignature","resultType","RoleLocation","splunk_server","ssphp_contact","ssphp_cost_centre","ssphp_devops_site","ssphp_division","ssphp_division_name","ssphp_environment","ssphp_provider","ssphp_resource_category","ssphp_resource_group","ssphp_resource_id","ssphp_resource_name","ssphp_resource_type","ssphp_service","ssphp_service_id","ssphp_service_name","ssphp_sro","ssphp_subscription","ssphp_technical_contact_email","ssphp_tenant_name","tenantId","time","timeendpos","timestartpos","body.callerIpAddress","body.category","body.correlationId","body.durationMs","body.identity","body.identity.authorization.action","body.identity.authorization.evidence.principalId","body.identity.authorization.evidence.principalType","body.identity.authorization.evidence.role","body.identity.authorization.evidence.roleAssignmentId","body.identity.authorization.evidence.roleAssignmentScope","body.identity.authorization.evidence.roleDefinitionId","body.identity.authorization.scope","body.identity.claims.aio","body.identity.claims.appid","body.identity.claims.appidacr","body.identity.claims.aud","body.identity.claims.exp","body.identity.claims.http://schemas.microsoft.com/identity/claims/identityprovider","body.identity.claims.http://schemas.microsoft.com/identity/claims/objectidentifier","body.identity.claims.http://schemas.microsoft.com/identity/claims/tenantid","body.identity.claims.http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier","body.identity.claims.iat","body.identity.claims.idtyp","body.identity.claims.iss","body.identity.claims.nbf","body.identity.claims.rh","body.identity.claims.uti","body.identity.claims.ver","body.identity.claims.xms_tcdt","body.jobId","body.jobType","body.level","body.Level","body.operationName","body.operationVersion","body.properties.activityDateTime","body.properties.activityDisplayName","body.properties.additionalDetails{}.key","body.properties.additionalDetails{}.value","body.properties.category","body.properties.correlationId","body.properties.entity","body.properties.eventCategory","body.properties.hierarchy","body.properties.id","body.properties.initiatedBy.user.displayName","body.properties.initiatedBy.user.id","body.properties.initiatedBy.user.ipAddress","body.properties.initiatedBy.user.userPrincipalName","body.properties.loggedByService","body.properties.message","body.properties.operationType","body.properties.requestbody","body.properties.result","body.properties.resultReason","body.properties.serviceRequestId","body.properties.statusCode","body.properties.targetResources{}.displayName","body.properties.targetResources{}.groupType","body.properties.targetResources{}.id","body.properties.targetResources{}.modifiedProperties{}.displayName","body.properties.targetResources{}.modifiedProperties{}.newValue","body.properties.targetResources{}.modifiedProperties{}.oldValue","body.properties.targetResources{}.type","body.properties.targetResources{}.userPrincipalName","body.properties.userAgent","body.ReleaseVersion","body.resourceId","body.resultDescription","body.resultSignature","body.resultType","body.RoleLocation","body.tenantId","body.time","eventtype","identity","Level","operationVersion","properties.activityDateTime","properties.activityDisplayName","properties.additionalDetails{}.key","properties.additionalDetails{}.value","properties.category","properties.correlationId","properties.id","properties.initiatedBy.user.displayName","properties.initiatedBy.user.id","properties.initiatedBy.user.ipAddress","properties.initiatedBy.user.userPrincipalName","properties.loggedByService","properties.operationType","properties.result","properties.resultReason","properties.targetResources{}.displayName","properties.targetResources{}.groupType","properties.targetResources{}.id","properties.targetResources{}.modifiedProperties{}.displayName","properties.targetResources{}.modifiedProperties{}.newValue","properties.targetResources{}.modifiedProperties{}.oldValue","properties.targetResources{}.type","properties.targetResources{}.userPrincipalName","properties.userAgent","resultDescription","tag","tag::eventtype","x-opt-enqueued-time","x-opt-offset","x-opt-sequence-number","identity.claim.appid","identity.claim.appidacr","identity.claim.oid","identity.claim.xms_mirid","location","properties.algorithm","properties.appId","properties.appServicePrincipalId","properties.authenticationProcessingDetails{}.key","properties.authenticationProcessingDetails{}.value","properties.authenticationProtocol","properties.CIp","properties.clientCredentialType","properties.clientInfo","properties.ComputerName","properties.conditionalAccessStatus","properties.Cookie","properties.createdDateTime","properties.crossTenantAccessType","properties.CsBytes","properties.CsHost","properties.CsMethod","properties.CsUriQuery","properties.CsUriStem","properties.CsUsername","properties.flaggedForReview","properties.httpStatusCode","properties.incomingTokenType","properties.ipAddress","properties.isAccessPolicyMatch","properties.isInteractive","properties.isTenantRestricted","properties.keyProperties.type","properties.location.city","properties.location.countryOrRegion","properties.location.geoCoordinates.latitude","properties.location.geoCoordinates.longitude","properties.location.state","properties.processingTimeInMilliseconds","properties.Referer","properties.requestUri","properties.resourceDisplayName","properties.resourceId","properties.resourceServicePrincipalId","properties.Result","properties.riskDetail","properties.riskLevelAggregated","properties.riskLevelDuringSignIn","properties.riskState","properties.ScBytes","properties.ScStatus","properties.ScSubStatus","properties.ScWin32Status","properties.servicePrincipalCredentialKeyId","properties.servicePrincipalId","properties.servicePrincipalName","properties.SPort","properties.status.errorCode","properties.TimeTaken","properties.tlsVersion","properties.tokenIssuerType","properties.trustedService","properties.uniqueTokenIdentifier","properties.UserAgent","properties.userId","id","managedBy","name","properties.provisioningState","tags.AntiMalware_MetaData","tags.AntiMalware_PolicyMaster","tags.AntiMalware_PolicySecondary","tags.AntiMalware_Status","tags.app","tags.Build","tags.Contact","tags.Contact Service","tags.ContactTechnical","tags.CostCentre","tags.CreatedBy","tags.DAS Environment","tags.DateProvisioned","tags.Department","tags.Dependencies","tags.DeploymentRepo","tags.DeploymentScript","tags.displayName","tags.Environment","tags.environment","tags.Feature","tags.hidden-DevTestLabs-LabUId","tags.Impact","tags.ms-resource-usage","tags.Name","tags.Organisation","tags.Parent Business","tags.Portfolio","tags.Product","tags.Repository","tags.Role","tags.Service","tags.Service Line","tags.Service Offering","tags.ServiceType","tags.Solution","tags.Subscription","tags.Value","timestamp","type","properties.creationTimeUtc","properties.lastStateChangeTimeUtc","properties.securityTaskParameters.assessmentKey","properties.securityTaskParameters.category","properties.securityTaskParameters.details{}.name","properties.securityTaskParameters.details{}.value","properties.securityTaskParameters.name","properties.securityTaskParameters.policyDefinitionId","properties.securityTaskParameters.policyName","properties.securityTaskParameters.resourceId","properties.securityTaskParameters.resourceType","properties.securityTaskParameters.severity","properties.securityTaskParameters.uniqueKey","properties.state","properties.subState","properties.additionalData.assessedResourceType","properties.additionalData.data.resources","properties.description","properties.displayName","properties.impact","properties.remediation","properties.resourceDetails.id","properties.resourceDetails.source","properties.status.code","properties.status.severity","properties.timeGenerated","created_time_epoch","ssphp_business_service_index","ssphp_subscription_display_name","ssphp_tenant_id","assessment_id","assessment_name","assessment_properties.additionalData.Kind","assessment_properties.displayName","assessment_properties.resourceDetails.Id","assessment_properties.resourceDetails.Source","assessment_properties.status.code","assessment_type","metadata_id","metadata_name","metadata_properties.assessmentType","metadata_properties.categories{}","metadata_properties.description","metadata_properties.displayName","metadata_properties.implementationEffort","metadata_properties.policyDefinitionId","metadata_properties.preview","metadata_properties.remediationDescription","metadata_properties.severity","metadata_properties.threats{}","metadata_properties.userImpact","metadata_type","zz_ak","zz_rid","assessment.id","assessment.meta.assessment_sub_assessments_link","assessment.meta.sub_assessments","assessment.meta.sub_assessments_link_detected","assessment.metadata.id","assessment.metadata.name","assessment.metadata.properties.assessmentType","assessment.metadata.properties.categories{}","assessment.metadata.properties.description","assessment.metadata.properties.displayName","assessment.metadata.properties.implementationEffort","assessment.metadata.properties.policyDefinitionId","assessment.metadata.properties.preview","assessment.metadata.properties.remediationDescription","assessment.metadata.properties.severity","assessment.metadata.properties.threats{}","assessment.metadata.properties.userImpact","assessment.metadata.type","assessment.name","assessment.properties.additionalData.Kind","assessment.properties.additionalData.subAssessmentsLink","assessment.properties.displayName","assessment.properties.resourceDetails.Id","assessment.properties.resourceDetails.Source","assessment.properties.status.cause","assessment.properties.status.code","assessment.properties.status.description","assessment.type","assessments{}.id","assessments{}.meta.assessment_sub_assessments_link","assessments{}.meta.sub_assessments","assessments{}.meta.sub_assessments_link_detected","assessments{}.metadata.id","assessments{}.metadata.name","assessments{}.metadata.properties.assessmentType","assessments{}.metadata.properties.categories{}","assessments{}.metadata.properties.description","assessments{}.metadata.properties.displayName","assessments{}.metadata.properties.implementationEffort","assessments{}.metadata.properties.policyDefinitionId","assessments{}.metadata.properties.preview","assessments{}.metadata.properties.remediationDescription","assessments{}.metadata.properties.severity","assessments{}.metadata.properties.threats{}","assessments{}.metadata.properties.userImpact","assessments{}.metadata.type","assessments{}.name","assessments{}.properties.additionalData.Kind","assessments{}.properties.additionalData.OS Type","assessments{}.properties.additionalData.subAssessmentsLink","assessments{}.properties.displayName","assessments{}.properties.resourceDetails.Id","assessments{}.properties.resourceDetails.Source","assessments{}.properties.status.cause","assessments{}.properties.status.code","assessments{}.properties.status.description","assessments{}.type","ssphp_assessment_id","ssphp_assessment_metadata_id","ssphp_category","ssphp_creation_time","ssphp_creation_time_epoch","ssphp_event_time","ssphp_last_changed_time","ssphp_last_changed_time_epoch","ssphp_parent_business","ssphp_policy_name","ssphp_portfolio","ssphp_remediation_description","SSPHP_RUN","ssphp_run","ssphp_service_team","ssphp_severity","ssphp_state","ssphp_status_code","ssphp_task_id","ssphp_tech_contact_email","ssphp_threats","task.id","task.meta.details","task.meta.task_sub_assessments_link_detected","task.name","task.properties.creationTimeUtc","task.properties.lastStateChangeTimeUtc","task.properties.securityTaskParameters.assessmentKey","task.properties.securityTaskParameters.category","task.properties.securityTaskParameters.details{}.name","task.properties.securityTaskParameters.details{}.value","task.properties.securityTaskParameters.name","task.properties.securityTaskParameters.policyDefinitionId","task.properties.securityTaskParameters.policyName","task.properties.securityTaskParameters.resourceId","task.properties.securityTaskParameters.resourceType","task.properties.securityTaskParameters.severity","task.properties.securityTaskParameters.uniqueKey","task.properties.state","task.properties.subState","task.type","assessments{}.additional_data.Kind","assessments{}.additional_data.subAssessmentsLink","assessments{}.additional_data.usersWithNoMfaObjectIdList","assessments{}.display_name","assessments{}.status.cause","assessments{}.status.code","assessments{}.status.description","assessments{}.status.first_evaluation_date","assessments{}.status.status_change_date","meta.child_name_1","meta.child_name_2","meta.child_namespace_1","meta.child_namespace_2","meta.child_parent_1","meta.child_parent_2","meta.child_type_1","meta.child_type_2","meta.children","meta.last_child_num","meta.name","meta.namespace","meta.resource_group","meta.resource_name","meta.resource_namespace","meta.resource_parent","meta.resource_type","meta.subscription","meta.type","task.creation_time_utc","task.last_state_change_time_utc","task.security_task_parameters.assessmentKey","task.security_task_parameters.category","task.security_task_parameters.name","task.security_task_parameters.policyDefinitionId","task.security_task_parameters.policyName","task.security_task_parameters.resourceId","task.security_task_parameters.resourceType","task.security_task_parameters.severity","task.security_task_parameters.uniqueKey","task.state","task.sub_state","aa","assessment.properties.metadata.id","assessment.properties.metadata.name","assessment.properties.metadata.properties.assessmentType","assessment.properties.metadata.properties.categories{}","assessment.properties.metadata.properties.description","assessment.properties.metadata.properties.displayName","assessment.properties.metadata.properties.implementationEffort","assessment.properties.metadata.properties.policyDefinitionId","assessment.properties.metadata.properties.preview","assessment.properties.metadata.properties.publishDates.public","assessment.properties.metadata.properties.remediationDescription","assessment.properties.metadata.properties.severity","assessment.properties.metadata.properties.tactics{}","assessment.properties.metadata.properties.techniques{}","assessment.properties.metadata.properties.threats{}","assessment.properties.metadata.properties.userImpact","assessment.properties.metadata.type","assessment.properties.status.firstEvaluationDate","assessment.properties.status.statusChangeDate","meta.assessment.child_name_1","meta.assessment.child_name_2","meta.assessment.child_namespace_1","meta.assessment.child_namespace_2","meta.assessment.child_parent_1","meta.assessment.child_parent_2","meta.assessment.child_type_1","meta.assessment.child_type_2","meta.assessment.children","meta.assessment.last_child_num","meta.assessment.name","meta.assessment.namespace","meta.assessment.resource_group","meta.assessment.resource_name","meta.assessment.resource_namespace","meta.assessment.resource_parent","meta.assessment.resource_type","meta.assessment.subscription","meta.assessment.type","meta.task.child_name_1","meta.task.child_parent_1","meta.task.child_type_1","meta.task.children","meta.task.last_child_num","meta.task.name","meta.task.namespace","meta.task.resource_group","meta.task.resource_name","meta.task.resource_namespace","meta.task.resource_parent","meta.task.resource_type","meta.task.subscription","meta.task.type","ssphp_meta_affected_resource","task.properties.securityTaskParameters.baselineCceId","task.properties.securityTaskParameters.baselineName","task.properties.securityTaskParameters.baselineRuleId","task.properties.securityTaskParameters.osName","task.properties.securityTaskParameters.ruleType","task.properties.securityTaskParameters.subscriptionId","task.properties.securityTaskParameters.totalNumberOfDefectedMachines","task.properties.securityTaskParameters.workspaces{}.serverCount","task.properties.securityTaskParameters.workspaces{}.workspaceId"]
display.events.list.drilldown = full
display.events.list.wrap = 1
display.events.maxLines = 5
display.events.raw.drilldown = full
display.events.rowNumbers = 0
display.events.table.drilldown = 1
display.events.table.wrap = 1
display.events.type = list
display.general.enablePreview = 1
display.general.migratedFromViewState = 0
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.mode = fast
display.page.search.patterns.sensitivity = 0.8
display.page.search.showFields = 1
display.page.search.tab = statistics
display.page.search.timeline.format = compact
display.page.search.timeline.scale = linear
display.statistics.drilldown = cell
display.statistics.overlay = none
display.statistics.percentagesRow = 0
display.statistics.rowNumbers = 0
display.statistics.show = 1
display.statistics.totalsRow = 0
display.statistics.wrap = 1
display.visualizations.chartHeight = 300
display.visualizations.charting.axisLabelsX.majorLabelStyle.overflowMode = ellipsisNone
display.visualizations.charting.axisLabelsX.majorLabelStyle.rotation = 0
display.visualizations.charting.axisTitleX.visibility = visible
display.visualizations.charting.axisTitleY.visibility = visible
display.visualizations.charting.axisTitleY2.visibility = visible
display.visualizations.charting.axisX.abbreviation = none
display.visualizations.charting.axisX.scale = linear
display.visualizations.charting.axisY.abbreviation = none
display.visualizations.charting.axisY.scale = linear
display.visualizations.charting.axisY2.abbreviation = none
display.visualizations.charting.axisY2.enabled = 0
display.visualizations.charting.axisY2.scale = inherit
display.visualizations.charting.chart = pie
display.visualizations.charting.chart.bubbleMaximumSize = 50
display.visualizations.charting.chart.bubbleMinimumSize = 10
display.visualizations.charting.chart.bubbleSizeBy = area
display.visualizations.charting.chart.nullValueMode = gaps
display.visualizations.charting.chart.showDataLabels = none
display.visualizations.charting.chart.sliceCollapsingThreshold = 0.01
display.visualizations.charting.chart.stackMode = default
display.visualizations.charting.chart.style = shiny
display.visualizations.charting.drilldown = all
display.visualizations.charting.layout.splitSeries = 0
display.visualizations.charting.layout.splitSeries.allowIndependentYRanges = 0
display.visualizations.charting.legend.labelStyle.overflowMode = ellipsisMiddle
display.visualizations.charting.legend.mode = standard
display.visualizations.charting.legend.placement = right
display.visualizations.charting.lineWidth = 2
display.visualizations.custom.drilldown = all
display.visualizations.mapHeight = 400
display.visualizations.mapping.choroplethLayer.colorBins = 5
display.visualizations.mapping.choroplethLayer.colorMode = auto
display.visualizations.mapping.choroplethLayer.maximumColor = 0xaf575a
display.visualizations.mapping.choroplethLayer.minimumColor = 0x62b3b2
display.visualizations.mapping.choroplethLayer.neutralPoint = 0
display.visualizations.mapping.choroplethLayer.shapeOpacity = 0.75
display.visualizations.mapping.choroplethLayer.showBorder = 1
display.visualizations.mapping.data.maxClusters = 100
display.visualizations.mapping.drilldown = all
display.visualizations.mapping.legend.placement = bottomright
display.visualizations.mapping.map.center = (0,0)
display.visualizations.mapping.map.panning = 1
display.visualizations.mapping.map.scrollZoom = 0
display.visualizations.mapping.map.zoom = 2
display.visualizations.mapping.markerLayer.markerMaxSize = 50
display.visualizations.mapping.markerLayer.markerMinSize = 10
display.visualizations.mapping.markerLayer.markerOpacity = 0.8
display.visualizations.mapping.showTiles = 1
display.visualizations.mapping.tileLayer.maxZoom = 7
display.visualizations.mapping.tileLayer.minZoom = 0
display.visualizations.mapping.tileLayer.tileOpacity = 1
display.visualizations.mapping.type = marker
display.visualizations.show = 0
display.visualizations.singlevalue.colorBy = value
display.visualizations.singlevalue.colorMode = none
display.visualizations.singlevalue.drilldown = none
display.visualizations.singlevalue.numberPrecision = 0
display.visualizations.singlevalue.rangeColors = ["0x53a051", "0x0877a6", "0xf8be34", "0xf1813f", "0xdc4e41"]
display.visualizations.singlevalue.rangeValues = [0,30,70,100]
display.visualizations.singlevalue.showSparkline = 1
display.visualizations.singlevalue.showTrendIndicator = 1
display.visualizations.singlevalue.trendColorInterpretation = standard
display.visualizations.singlevalue.trendDisplayMode = absolute
display.visualizations.singlevalue.unitPosition = after
display.visualizations.singlevalue.useColors = 0
display.visualizations.singlevalue.useThousandSeparators = 1
display.visualizations.singlevalueHeight = 115
display.visualizations.trellis.enabled = 0
display.visualizations.trellis.scales.shared = 1
display.visualizations.trellis.size = medium
display.visualizations.type = charting
durable.backfill_type = auto
durable.lag_time = 0
durable.max_backfill_intervals = 0
embed.enabled = 0
enableSched = 1
is_visible = 1
max_concurrent = 1
precalculate_required_fields_for_alerts = 1
realtime_schedule = 1
request.ui_dispatch_app = SSPHP_RSD
request.ui_dispatch_view = search
restart_on_searchpeer_add = 1
run_n_times = 0
run_on_startup = 0
schedule_as = auto
schedule_priority = default
schedule_window = auto
search = index="ssphp_test" sourcetype="azure:security:finding" host="c113p01-splhf04" source="azure_cloud_defender"\
| stats max(SSPHP_RUN) as last_SSPHP_RUN\
| eval ssphp_source="findings"\
\
| append\
    [search index="ssphp_test" sourcetype="azure:security:alert" host="c113p01-splhf04" source="azure_defender_alerts"\
| stats max(SSPHP_RUN) as last_SSPHP_RUN\
| eval ssphp_source="alerts"]\
| outputlookup createinapp=t append=f ssphp_last_ssphp_drop.csv
skip_scheduled_realtime_idxc = 0
workload_pool = standard_perf

###############################################################################################################################################################
[ssphp_create_resource_service_map_csv]
action.cryptolert.param.debug = 1
action.email = 0
action.email.show_password = 1
action.email.useNSSubject = 1
action.populate_lookup = 0
action.rss = 0
action.summary_index = 0
action.summary_index.force_realtime_schedule = 0
action.webhook.enable_allowlist = 1
alert.digest_mode = 1
alert.expires = 24h
alert.severity = 3
alert.track = 0
allow_skew = 12m
auto_summarize = 0
auto_summarize.command = | summarize override=partial timespan=$auto_summarize.timespan$ max_summary_size=$auto_summarize.max_summary_size$ max_summary_ratio=$auto_summarize.max_summary_ratio$ max_disabled_buckets=$auto_summarize.max_disabled_buckets$ max_time=$auto_summarize.max_time$ [ $search$ ]
auto_summarize.cron_schedule = */10 * * * *
auto_summarize.dispatch.time_format = %FT%T.%Q%:z
auto_summarize.dispatch.ttl = 60
auto_summarize.max_concurrent = 1
auto_summarize.max_disabled_buckets = 2
auto_summarize.max_summary_ratio = 0.1
auto_summarize.max_summary_size = 52428800
auto_summarize.max_time = 3600
auto_summarize.suspend_period = 24h
counttype = always
cron_schedule = 15 * * * *
defer_scheduled_searchable_idxc = 0
disabled = 0
dispatch.allow_partial_results = 1
dispatch.auto_cancel = 0
dispatch.auto_pause = 0
dispatch.buckets = 0
dispatch.earliest_time = 0
dispatch.latest_time = now
dispatch.lookups = 1
dispatch.max_count = 500000
dispatch.max_time = 0
dispatch.rate_limit_retry = 0
dispatch.reduce_freq = 10
dispatch.rt_backfill = 0
dispatch.sample_ratio = 1
dispatch.spawn_process = 1
dispatch.time_format = %FT%T.%Q%:z
dispatch.ttl = 2p
dispatchAs = owner
display.events.fields = ["host","source","sourcetype"]
display.events.list.drilldown = full
display.events.list.wrap = 1
display.events.maxLines = 5
display.events.raw.drilldown = full
display.events.rowNumbers = 0
display.events.table.drilldown = 1
display.events.table.wrap = 1
display.events.type = list
display.general.enablePreview = 1
display.general.migratedFromViewState = 0
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.mode = smart
display.page.search.patterns.sensitivity = 0.8
display.page.search.showFields = 1
display.page.search.tab = statistics
display.page.search.timeline.format = compact
display.page.search.timeline.scale = linear
display.statistics.drilldown = cell
display.statistics.overlay = none
display.statistics.percentagesRow = 0
display.statistics.rowNumbers = 0
display.statistics.show = 1
display.statistics.totalsRow = 0
display.statistics.wrap = 1
display.visualizations.chartHeight = 300
display.visualizations.charting.axisLabelsX.majorLabelStyle.overflowMode = ellipsisNone
display.visualizations.charting.axisLabelsX.majorLabelStyle.rotation = 0
display.visualizations.charting.axisTitleX.visibility = visible
display.visualizations.charting.axisTitleY.visibility = visible
display.visualizations.charting.axisTitleY2.visibility = visible
display.visualizations.charting.axisX.abbreviation = none
display.visualizations.charting.axisX.scale = linear
display.visualizations.charting.axisY.abbreviation = none
display.visualizations.charting.axisY.scale = linear
display.visualizations.charting.axisY2.abbreviation = none
display.visualizations.charting.axisY2.enabled = 0
display.visualizations.charting.axisY2.scale = inherit
display.visualizations.charting.chart = column
display.visualizations.charting.chart.bubbleMaximumSize = 50
display.visualizations.charting.chart.bubbleMinimumSize = 10
display.visualizations.charting.chart.bubbleSizeBy = area
display.visualizations.charting.chart.nullValueMode = gaps
display.visualizations.charting.chart.showDataLabels = none
display.visualizations.charting.chart.sliceCollapsingThreshold = 0.01
display.visualizations.charting.chart.stackMode = default
display.visualizations.charting.chart.style = shiny
display.visualizations.charting.drilldown = all
display.visualizations.charting.layout.splitSeries = 0
display.visualizations.charting.layout.splitSeries.allowIndependentYRanges = 0
display.visualizations.charting.legend.labelStyle.overflowMode = ellipsisMiddle
display.visualizations.charting.legend.mode = standard
display.visualizations.charting.legend.placement = right
display.visualizations.charting.lineWidth = 2
display.visualizations.custom.drilldown = all
display.visualizations.mapHeight = 400
display.visualizations.mapping.choroplethLayer.colorBins = 5
display.visualizations.mapping.choroplethLayer.colorMode = auto
display.visualizations.mapping.choroplethLayer.maximumColor = 0xaf575a
display.visualizations.mapping.choroplethLayer.minimumColor = 0x62b3b2
display.visualizations.mapping.choroplethLayer.neutralPoint = 0
display.visualizations.mapping.choroplethLayer.shapeOpacity = 0.75
display.visualizations.mapping.choroplethLayer.showBorder = 1
display.visualizations.mapping.data.maxClusters = 100
display.visualizations.mapping.drilldown = all
display.visualizations.mapping.legend.placement = bottomright
display.visualizations.mapping.map.center = (0,0)
display.visualizations.mapping.map.panning = 1
display.visualizations.mapping.map.scrollZoom = 0
display.visualizations.mapping.map.zoom = 2
display.visualizations.mapping.markerLayer.markerMaxSize = 50
display.visualizations.mapping.markerLayer.markerMinSize = 10
display.visualizations.mapping.markerLayer.markerOpacity = 0.8
display.visualizations.mapping.showTiles = 1
display.visualizations.mapping.tileLayer.maxZoom = 7
display.visualizations.mapping.tileLayer.minZoom = 0
display.visualizations.mapping.tileLayer.tileOpacity = 1
display.visualizations.mapping.type = marker
display.visualizations.show = 0
display.visualizations.singlevalue.colorBy = value
display.visualizations.singlevalue.colorMode = none
display.visualizations.singlevalue.drilldown = none
display.visualizations.singlevalue.numberPrecision = 0
display.visualizations.singlevalue.rangeColors = ["0x53a051", "0x0877a6", "0xf8be34", "0xf1813f", "0xdc4e41"]
display.visualizations.singlevalue.rangeValues = [0,30,70,100]
display.visualizations.singlevalue.showSparkline = 1
display.visualizations.singlevalue.showTrendIndicator = 1
display.visualizations.singlevalue.trendColorInterpretation = standard
display.visualizations.singlevalue.trendDisplayMode = absolute
display.visualizations.singlevalue.unitPosition = after
display.visualizations.singlevalue.useColors = 0
display.visualizations.singlevalue.useThousandSeparators = 1
display.visualizations.singlevalueHeight = 115
display.visualizations.trellis.enabled = 0
display.visualizations.trellis.scales.shared = 1
display.visualizations.trellis.size = medium
display.visualizations.type = charting
durable.backfill_type = auto
durable.lag_time = 0
durable.max_backfill_intervals = 0
embed.enabled = 0
enableSched = 1
is_visible = 1
max_concurrent = 1
precalculate_required_fields_for_alerts = 1
realtime_schedule = 1
request.ui_dispatch_app = SSPHP_RSD
request.ui_dispatch_view = search
restart_on_searchpeer_add = 1
run_n_times = 0
run_on_startup = 0
schedule_as = auto
schedule_priority = default
schedule_window = auto
search = index="ssphp_test" sourcetype="azure:resource:group"\
       ```[search index="ssphp_test" sourcetype="azure:resource:group" earliest=-3d@d latest=now | stats max(_time) as _time | return _time]```\
| dedup name\
\
| rename name as ssphp_resource_group, location as ssphp_location, "tags.Parent Business" as ssphp_parent_business, tags.Portfolio as ssphp_portfolio, tags.Product as ssphp_product, tags.Service as ssphp_service, "tags.Service Line" as ssphp_service_line, "tags.Service Offering" as ssphp_service_offering, tags.costcenter as ssphp_cost_centre, tags.environment as ssphp_environment\
| eval id=lower(id), ssphp_resource_group=lower(ssphp_resource_group)\
| rex field=id "^\/subscriptions\/(?<ssphp_subscription>[^\/]+)"\
| rex field=ssphp_resource_group "^(?<ssphp_business_service_index>s\d{3})(?<ssphp_environment>p|d|t)[^-]+-(?<ssphp_service_team>[\s\S]*)$"\
| eval ssphp_environment=case(ssphp_environment="t","Test",ssphp_environment="d","Development",ssphp_environment="p","Production",1==1,"Unknown")\
| fields ssphp_subscription, ssphp_resource_group, ssphp_business_service_index, ssphp_environment, ssphp_service_team, ssphp_location, ssphp_parent_business, ssphp_portfolio, ssphp_product, ssphp_service, ssphp_service_line, ssphp_service_offering\
\
| join type=outer ssphp_subscription\
    [search index="ssphp_test" sourcetype="azure:subscriptions" \
    | dedup subscriptionId\
       ```[search index="ssphp_test" sourcetype="azure:subscriptions" earliest=-3d@d latest=now | stats max(_time) as _time | return _time]```\
\
    | rename tenantId as ssphp_tenant, subscriptionId aS ssphp_subscription, displayName as ssphp_subscription_display_name\
    | fields ssphp_subscription, ssphp_tenant, ssphp_subscription_display_name]\
\
| lookup ssphp_business_service_index.csv "Service ID" as ssphp_business_service_index OUTPUT "Cost Centre" as ssphp_cost_centre, "DevOps Site" as ssphp_devops_site, SRO as ssphp_sro, "Service Name" as ssphp_service_name, "Tech Directorate Architect Partner" as ssphp_tech_dir_arch_partner, "Tech Directorate Service Management Contact" as ssphp_tech_dir_serv_mgmt_contact, "Technical Contact Email" as ssphp_tech_contact_email\
\
`ssphp_service_id_logic`\
\
| eval ssphp_service_shortname=case(ssphp_service_name="Regional Service Delivery","RSD",1==1,"Unknown"),\
       ssphp_tenant_name=case(ssphp_tenant="9c7d9dd3-840c-4b3f-818e-552865082e16","CIP",ssphp_tenant="fad277c9-c60a-4da1-b5f3-b3b8b34a82f9","T1",1==1,"SFA : ".substr(ssphp_tenant,0,8))\
\
| fillnull value="Unknown"\
| table ssphp_tenant, ssphp_tenant_name, ssphp_subscription, ssphp_subscription_display_name, ssphp_resource_group, ssphp_business_service_index, ssphp_service_name, ssphp_service_shortname, ssphp_environment, ssphp_service_team, ssphp_location, ssphp_parent_business, ssphp_portfolio, ssphp_product, ssphp_service, ssphp_service_line, ssphp_service_offering, ssphp_cost_centre, ssphp_devops_site, ssphp_sro, ssphp_tech_dir_arch_partner, ssphp_tech_dir_serv_mgmt_contact, ssphp_tech_contact_email\
\
| outputlookup createinapp=t append=f ssphp_resource_service_map.csv
skip_scheduled_realtime_idxc = 0
workload_pool = standard_perf

###############################################################################################################################################################
[ssphp_create_service_checkpoint_csv]
action.cryptolert.param.debug = 1
action.email = 0
action.email.show_password = 1
action.email.useNSSubject = 1
action.populate_lookup = 0
action.rss = 0
action.summary_index = 0
action.summary_index.force_realtime_schedule = 0
action.webhook.enable_allowlist = 1
alert.digest_mode = 1
alert.expires = 24h
alert.severity = 3
alert.track = 0
allow_skew = 12m
auto_summarize = 0
auto_summarize.command = | summarize override=partial timespan=$auto_summarize.timespan$ max_summary_size=$auto_summarize.max_summary_size$ max_summary_ratio=$auto_summarize.max_summary_ratio$ max_disabled_buckets=$auto_summarize.max_disabled_buckets$ max_time=$auto_summarize.max_time$ [ $search$ ]
auto_summarize.cron_schedule = */10 * * * *
auto_summarize.dispatch.time_format = %FT%T.%Q%:z
auto_summarize.dispatch.ttl = 60
auto_summarize.max_concurrent = 1
auto_summarize.max_disabled_buckets = 2
auto_summarize.max_summary_ratio = 0.1
auto_summarize.max_summary_size = 52428800
auto_summarize.max_time = 3600
auto_summarize.suspend_period = 24h
counttype = always
defer_scheduled_searchable_idxc = 0
disabled = 0
dispatch.allow_partial_results = 1
dispatch.auto_cancel = 0
dispatch.auto_pause = 0
dispatch.buckets = 0
dispatch.earliest_time = -30d@d
dispatch.latest_time = now
dispatch.lookups = 1
dispatch.max_count = 500000
dispatch.max_time = 0
dispatch.rate_limit_retry = 0
dispatch.reduce_freq = 10
dispatch.rt_backfill = 0
dispatch.sample_ratio = 1
dispatch.spawn_process = 1
dispatch.time_format = %FT%T.%Q%:z
dispatch.ttl = 2p
dispatchAs = owner
display.events.fields = ["host","source","sourcetype","callerIpAddress","category","correlationId","date_hour","date_mday","date_minute","date_month","date_second","date_wday","date_year","date_zone","durationMs","identity.authorization.action","identity.authorization.evidence.principalId","identity.authorization.evidence.principalType","identity.authorization.evidence.role","identity.authorization.evidence.roleAssignmentId","identity.authorization.evidence.roleAssignmentScope","identity.authorization.evidence.roleDefinitionId","identity.authorization.scope","identity.claims.aio","identity.claims.altsecid","identity.claims.appid","identity.claims.appidacr","identity.claims.aud","identity.claims.exp","identity.claims.groups","identity.claims.http://schemas.microsoft.com/claims/authnclassreference","identity.claims.http://schemas.microsoft.com/claims/authnmethodsreferences","identity.claims.http://schemas.microsoft.com/identity/claims/identityprovider","identity.claims.http://schemas.microsoft.com/identity/claims/objectidentifier","identity.claims.http://schemas.microsoft.com/identity/claims/scope","identity.claims.http://schemas.microsoft.com/identity/claims/tenantid","identity.claims.http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress","identity.claims.http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname","identity.claims.http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name","identity.claims.http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier","identity.claims.http://schemas.xmlsoap.org/ws/2005/05/identity/claims/surname","identity.claims.iat","identity.claims.idtyp","identity.claims.ipaddr","identity.claims.iss","identity.claims.name","identity.claims.nbf","identity.claims.puid","identity.claims.rh","identity.claims.uti","identity.claims.ver","identity.claims.wids","identity.claims.xms_cc","identity.claims.xms_tcdt","index","jobId","jobType","level","linecount","operationName","properties.entity","properties.eventCategory","properties.hierarchy","properties.message","properties.requestbody","properties.responseBody","properties.serviceRequestId","properties.statusCode","punct","ReleaseVersion","resourceId","resultSignature","resultType","RoleLocation","splunk_server","ssphp_contact","ssphp_cost_centre","ssphp_devops_site","ssphp_division","ssphp_division_name","ssphp_environment","ssphp_provider","ssphp_resource_category","ssphp_resource_group","ssphp_resource_id","ssphp_resource_name","ssphp_resource_type","ssphp_service","ssphp_service_id","ssphp_service_name","ssphp_sro","ssphp_subscription","ssphp_technical_contact_email","ssphp_tenant_name","tenantId","time","timeendpos","timestartpos","body.callerIpAddress","body.category","body.correlationId","body.durationMs","body.identity","body.identity.authorization.action","body.identity.authorization.evidence.principalId","body.identity.authorization.evidence.principalType","body.identity.authorization.evidence.role","body.identity.authorization.evidence.roleAssignmentId","body.identity.authorization.evidence.roleAssignmentScope","body.identity.authorization.evidence.roleDefinitionId","body.identity.authorization.scope","body.identity.claims.aio","body.identity.claims.appid","body.identity.claims.appidacr","body.identity.claims.aud","body.identity.claims.exp","body.identity.claims.http://schemas.microsoft.com/identity/claims/identityprovider","body.identity.claims.http://schemas.microsoft.com/identity/claims/objectidentifier","body.identity.claims.http://schemas.microsoft.com/identity/claims/tenantid","body.identity.claims.http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier","body.identity.claims.iat","body.identity.claims.idtyp","body.identity.claims.iss","body.identity.claims.nbf","body.identity.claims.rh","body.identity.claims.uti","body.identity.claims.ver","body.identity.claims.xms_tcdt","body.jobId","body.jobType","body.level","body.Level","body.operationName","body.operationVersion","body.properties.activityDateTime","body.properties.activityDisplayName","body.properties.additionalDetails{}.key","body.properties.additionalDetails{}.value","body.properties.category","body.properties.correlationId","body.properties.entity","body.properties.eventCategory","body.properties.hierarchy","body.properties.id","body.properties.initiatedBy.user.displayName","body.properties.initiatedBy.user.id","body.properties.initiatedBy.user.ipAddress","body.properties.initiatedBy.user.userPrincipalName","body.properties.loggedByService","body.properties.message","body.properties.operationType","body.properties.requestbody","body.properties.result","body.properties.resultReason","body.properties.serviceRequestId","body.properties.statusCode","body.properties.targetResources{}.displayName","body.properties.targetResources{}.groupType","body.properties.targetResources{}.id","body.properties.targetResources{}.modifiedProperties{}.displayName","body.properties.targetResources{}.modifiedProperties{}.newValue","body.properties.targetResources{}.modifiedProperties{}.oldValue","body.properties.targetResources{}.type","body.properties.targetResources{}.userPrincipalName","body.properties.userAgent","body.ReleaseVersion","body.resourceId","body.resultDescription","body.resultSignature","body.resultType","body.RoleLocation","body.tenantId","body.time","eventtype","identity","Level","operationVersion","properties.activityDateTime","properties.activityDisplayName","properties.additionalDetails{}.key","properties.additionalDetails{}.value","properties.category","properties.correlationId","properties.id","properties.initiatedBy.user.displayName","properties.initiatedBy.user.id","properties.initiatedBy.user.ipAddress","properties.initiatedBy.user.userPrincipalName","properties.loggedByService","properties.operationType","properties.result","properties.resultReason","properties.targetResources{}.displayName","properties.targetResources{}.groupType","properties.targetResources{}.id","properties.targetResources{}.modifiedProperties{}.displayName","properties.targetResources{}.modifiedProperties{}.newValue","properties.targetResources{}.modifiedProperties{}.oldValue","properties.targetResources{}.type","properties.targetResources{}.userPrincipalName","properties.userAgent","resultDescription","tag","tag::eventtype","x-opt-enqueued-time","x-opt-offset","x-opt-sequence-number","identity.claim.appid","identity.claim.appidacr","identity.claim.oid","identity.claim.xms_mirid","location","properties.algorithm","properties.appId","properties.appServicePrincipalId","properties.authenticationProcessingDetails{}.key","properties.authenticationProcessingDetails{}.value","properties.authenticationProtocol","properties.CIp","properties.clientCredentialType","properties.clientInfo","properties.ComputerName","properties.conditionalAccessStatus","properties.Cookie","properties.createdDateTime","properties.crossTenantAccessType","properties.CsBytes","properties.CsHost","properties.CsMethod","properties.CsUriQuery","properties.CsUriStem","properties.CsUsername","properties.flaggedForReview","properties.httpStatusCode","properties.incomingTokenType","properties.ipAddress","properties.isAccessPolicyMatch","properties.isInteractive","properties.isTenantRestricted","properties.keyProperties.type","properties.location.city","properties.location.countryOrRegion","properties.location.geoCoordinates.latitude","properties.location.geoCoordinates.longitude","properties.location.state","properties.processingTimeInMilliseconds","properties.Referer","properties.requestUri","properties.resourceDisplayName","properties.resourceId","properties.resourceServicePrincipalId","properties.Result","properties.riskDetail","properties.riskLevelAggregated","properties.riskLevelDuringSignIn","properties.riskState","properties.ScBytes","properties.ScStatus","properties.ScSubStatus","properties.ScWin32Status","properties.servicePrincipalCredentialKeyId","properties.servicePrincipalId","properties.servicePrincipalName","properties.SPort","properties.status.errorCode","properties.TimeTaken","properties.tlsVersion","properties.tokenIssuerType","properties.trustedService","properties.uniqueTokenIdentifier","properties.UserAgent","properties.userId","id","managedBy","name","properties.provisioningState","tags.AntiMalware_MetaData","tags.AntiMalware_PolicyMaster","tags.AntiMalware_PolicySecondary","tags.AntiMalware_Status","tags.app","tags.Build","tags.Contact","tags.Contact Service","tags.ContactTechnical","tags.CostCentre","tags.CreatedBy","tags.DAS Environment","tags.DateProvisioned","tags.Department","tags.Dependencies","tags.DeploymentRepo","tags.DeploymentScript","tags.displayName","tags.Environment","tags.environment","tags.Feature","tags.hidden-DevTestLabs-LabUId","tags.Impact","tags.ms-resource-usage","tags.Name","tags.Organisation","tags.Parent Business","tags.Portfolio","tags.Product","tags.Repository","tags.Role","tags.Service","tags.Service Line","tags.Service Offering","tags.ServiceType","tags.Solution","tags.Subscription","tags.Value","timestamp","type","properties.creationTimeUtc","properties.lastStateChangeTimeUtc","properties.securityTaskParameters.assessmentKey","properties.securityTaskParameters.category","properties.securityTaskParameters.details{}.name","properties.securityTaskParameters.details{}.value","properties.securityTaskParameters.name","properties.securityTaskParameters.policyDefinitionId","properties.securityTaskParameters.policyName","properties.securityTaskParameters.resourceId","properties.securityTaskParameters.resourceType","properties.securityTaskParameters.severity","properties.securityTaskParameters.uniqueKey","properties.state","properties.subState","properties.additionalData.assessedResourceType","properties.additionalData.data.resources","properties.description","properties.displayName","properties.impact","properties.remediation","properties.resourceDetails.id","properties.resourceDetails.source","properties.status.code","properties.status.severity","properties.timeGenerated","created_time_epoch","ssphp_business_service_index","ssphp_subscription_display_name","ssphp_tenant_id","assessment_id","assessment_name","assessment_properties.additionalData.Kind","assessment_properties.displayName","assessment_properties.resourceDetails.Id","assessment_properties.resourceDetails.Source","assessment_properties.status.code","assessment_type","metadata_id","metadata_name","metadata_properties.assessmentType","metadata_properties.categories{}","metadata_properties.description","metadata_properties.displayName","metadata_properties.implementationEffort","metadata_properties.policyDefinitionId","metadata_properties.preview","metadata_properties.remediationDescription","metadata_properties.severity","metadata_properties.threats{}","metadata_properties.userImpact","metadata_type","zz_ak","zz_rid","assessment.id","assessment.meta.assessment_sub_assessments_link","assessment.meta.sub_assessments","assessment.meta.sub_assessments_link_detected","assessment.metadata.id","assessment.metadata.name","assessment.metadata.properties.assessmentType","assessment.metadata.properties.categories{}","assessment.metadata.properties.description","assessment.metadata.properties.displayName","assessment.metadata.properties.implementationEffort","assessment.metadata.properties.policyDefinitionId","assessment.metadata.properties.preview","assessment.metadata.properties.remediationDescription","assessment.metadata.properties.severity","assessment.metadata.properties.threats{}","assessment.metadata.properties.userImpact","assessment.metadata.type","assessment.name","assessment.properties.additionalData.Kind","assessment.properties.additionalData.subAssessmentsLink","assessment.properties.displayName","assessment.properties.resourceDetails.Id","assessment.properties.resourceDetails.Source","assessment.properties.status.cause","assessment.properties.status.code","assessment.properties.status.description","assessment.type","assessments{}.id","assessments{}.meta.assessment_sub_assessments_link","assessments{}.meta.sub_assessments","assessments{}.meta.sub_assessments_link_detected","assessments{}.metadata.id","assessments{}.metadata.name","assessments{}.metadata.properties.assessmentType","assessments{}.metadata.properties.categories{}","assessments{}.metadata.properties.description","assessments{}.metadata.properties.displayName","assessments{}.metadata.properties.implementationEffort","assessments{}.metadata.properties.policyDefinitionId","assessments{}.metadata.properties.preview","assessments{}.metadata.properties.remediationDescription","assessments{}.metadata.properties.severity","assessments{}.metadata.properties.threats{}","assessments{}.metadata.properties.userImpact","assessments{}.metadata.type","assessments{}.name","assessments{}.properties.additionalData.Kind","assessments{}.properties.additionalData.OS Type","assessments{}.properties.additionalData.subAssessmentsLink","assessments{}.properties.displayName","assessments{}.properties.resourceDetails.Id","assessments{}.properties.resourceDetails.Source","assessments{}.properties.status.cause","assessments{}.properties.status.code","assessments{}.properties.status.description","assessments{}.type","ssphp_assessment_id","ssphp_assessment_metadata_id","ssphp_category","ssphp_creation_time","ssphp_creation_time_epoch","ssphp_event_time","ssphp_last_changed_time","ssphp_last_changed_time_epoch","ssphp_parent_business","ssphp_policy_name","ssphp_portfolio","ssphp_remediation_description","SSPHP_RUN","ssphp_run","ssphp_service_team","ssphp_severity","ssphp_state","ssphp_status_code","ssphp_task_id","ssphp_tech_contact_email","ssphp_threats","task.id","task.meta.details","task.meta.task_sub_assessments_link_detected","task.name","task.properties.creationTimeUtc","task.properties.lastStateChangeTimeUtc","task.properties.securityTaskParameters.assessmentKey","task.properties.securityTaskParameters.category","task.properties.securityTaskParameters.details{}.name","task.properties.securityTaskParameters.details{}.value","task.properties.securityTaskParameters.name","task.properties.securityTaskParameters.policyDefinitionId","task.properties.securityTaskParameters.policyName","task.properties.securityTaskParameters.resourceId","task.properties.securityTaskParameters.resourceType","task.properties.securityTaskParameters.severity","task.properties.securityTaskParameters.uniqueKey","task.properties.state","task.properties.subState","task.type","assessments{}.additional_data.Kind","assessments{}.additional_data.subAssessmentsLink","assessments{}.additional_data.usersWithNoMfaObjectIdList","assessments{}.display_name","assessments{}.status.cause","assessments{}.status.code","assessments{}.status.description","assessments{}.status.first_evaluation_date","assessments{}.status.status_change_date","meta.child_name_1","meta.child_name_2","meta.child_namespace_1","meta.child_namespace_2","meta.child_parent_1","meta.child_parent_2","meta.child_type_1","meta.child_type_2","meta.children","meta.last_child_num","meta.name","meta.namespace","meta.resource_group","meta.resource_name","meta.resource_namespace","meta.resource_parent","meta.resource_type","meta.subscription","meta.type","task.creation_time_utc","task.last_state_change_time_utc","task.security_task_parameters.assessmentKey","task.security_task_parameters.category","task.security_task_parameters.name","task.security_task_parameters.policyDefinitionId","task.security_task_parameters.policyName","task.security_task_parameters.resourceId","task.security_task_parameters.resourceType","task.security_task_parameters.severity","task.security_task_parameters.uniqueKey","task.state","task.sub_state","aa","assessment.properties.metadata.id","assessment.properties.metadata.name","assessment.properties.metadata.properties.assessmentType","assessment.properties.metadata.properties.categories{}","assessment.properties.metadata.properties.description","assessment.properties.metadata.properties.displayName","assessment.properties.metadata.properties.implementationEffort","assessment.properties.metadata.properties.policyDefinitionId","assessment.properties.metadata.properties.preview","assessment.properties.metadata.properties.publishDates.public","assessment.properties.metadata.properties.remediationDescription","assessment.properties.metadata.properties.severity","assessment.properties.metadata.properties.tactics{}","assessment.properties.metadata.properties.techniques{}","assessment.properties.metadata.properties.threats{}","assessment.properties.metadata.properties.userImpact","assessment.properties.metadata.type","assessment.properties.status.firstEvaluationDate","assessment.properties.status.statusChangeDate","meta.assessment.child_name_1","meta.assessment.child_name_2","meta.assessment.child_namespace_1","meta.assessment.child_namespace_2","meta.assessment.child_parent_1","meta.assessment.child_parent_2","meta.assessment.child_type_1","meta.assessment.child_type_2","meta.assessment.children","meta.assessment.last_child_num","meta.assessment.name","meta.assessment.namespace","meta.assessment.resource_group","meta.assessment.resource_name","meta.assessment.resource_namespace","meta.assessment.resource_parent","meta.assessment.resource_type","meta.assessment.subscription","meta.assessment.type","meta.task.child_name_1","meta.task.child_parent_1","meta.task.child_type_1","meta.task.children","meta.task.last_child_num","meta.task.name","meta.task.namespace","meta.task.resource_group","meta.task.resource_name","meta.task.resource_namespace","meta.task.resource_parent","meta.task.resource_type","meta.task.subscription","meta.task.type","ssphp_meta_affected_resource","task.properties.securityTaskParameters.baselineCceId","task.properties.securityTaskParameters.baselineName","task.properties.securityTaskParameters.baselineRuleId","task.properties.securityTaskParameters.osName","task.properties.securityTaskParameters.ruleType","task.properties.securityTaskParameters.subscriptionId","task.properties.securityTaskParameters.totalNumberOfDefectedMachines","task.properties.securityTaskParameters.workspaces{}.serverCount","task.properties.securityTaskParameters.workspaces{}.workspaceId"]
display.events.list.drilldown = full
display.events.list.wrap = 1
display.events.maxLines = 5
display.events.raw.drilldown = full
display.events.rowNumbers = 0
display.events.table.drilldown = 1
display.events.table.wrap = 1
display.events.type = list
display.general.enablePreview = 1
display.general.migratedFromViewState = 0
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.mode = verbose
display.page.search.patterns.sensitivity = 0.8
display.page.search.showFields = 1
display.page.search.tab = statistics
display.page.search.timeline.format = compact
display.page.search.timeline.scale = linear
display.statistics.drilldown = cell
display.statistics.overlay = none
display.statistics.percentagesRow = 0
display.statistics.rowNumbers = 0
display.statistics.show = 1
display.statistics.totalsRow = 0
display.statistics.wrap = 1
display.visualizations.chartHeight = 300
display.visualizations.charting.axisLabelsX.majorLabelStyle.overflowMode = ellipsisNone
display.visualizations.charting.axisLabelsX.majorLabelStyle.rotation = 0
display.visualizations.charting.axisTitleX.visibility = visible
display.visualizations.charting.axisTitleY.visibility = visible
display.visualizations.charting.axisTitleY2.visibility = visible
display.visualizations.charting.axisX.abbreviation = none
display.visualizations.charting.axisX.scale = linear
display.visualizations.charting.axisY.abbreviation = none
display.visualizations.charting.axisY.scale = linear
display.visualizations.charting.axisY2.abbreviation = none
display.visualizations.charting.axisY2.enabled = 0
display.visualizations.charting.axisY2.scale = inherit
display.visualizations.charting.chart = pie
display.visualizations.charting.chart.bubbleMaximumSize = 50
display.visualizations.charting.chart.bubbleMinimumSize = 10
display.visualizations.charting.chart.bubbleSizeBy = area
display.visualizations.charting.chart.nullValueMode = gaps
display.visualizations.charting.chart.showDataLabels = none
display.visualizations.charting.chart.sliceCollapsingThreshold = 0.01
display.visualizations.charting.chart.stackMode = default
display.visualizations.charting.chart.style = shiny
display.visualizations.charting.drilldown = all
display.visualizations.charting.layout.splitSeries = 0
display.visualizations.charting.layout.splitSeries.allowIndependentYRanges = 0
display.visualizations.charting.legend.labelStyle.overflowMode = ellipsisMiddle
display.visualizations.charting.legend.mode = standard
display.visualizations.charting.legend.placement = right
display.visualizations.charting.lineWidth = 2
display.visualizations.custom.drilldown = all
display.visualizations.mapHeight = 400
display.visualizations.mapping.choroplethLayer.colorBins = 5
display.visualizations.mapping.choroplethLayer.colorMode = auto
display.visualizations.mapping.choroplethLayer.maximumColor = 0xaf575a
display.visualizations.mapping.choroplethLayer.minimumColor = 0x62b3b2
display.visualizations.mapping.choroplethLayer.neutralPoint = 0
display.visualizations.mapping.choroplethLayer.shapeOpacity = 0.75
display.visualizations.mapping.choroplethLayer.showBorder = 1
display.visualizations.mapping.data.maxClusters = 100
display.visualizations.mapping.drilldown = all
display.visualizations.mapping.legend.placement = bottomright
display.visualizations.mapping.map.center = (0,0)
display.visualizations.mapping.map.panning = 1
display.visualizations.mapping.map.scrollZoom = 0
display.visualizations.mapping.map.zoom = 2
display.visualizations.mapping.markerLayer.markerMaxSize = 50
display.visualizations.mapping.markerLayer.markerMinSize = 10
display.visualizations.mapping.markerLayer.markerOpacity = 0.8
display.visualizations.mapping.showTiles = 1
display.visualizations.mapping.tileLayer.maxZoom = 7
display.visualizations.mapping.tileLayer.minZoom = 0
display.visualizations.mapping.tileLayer.tileOpacity = 1
display.visualizations.mapping.type = marker
display.visualizations.show = 0
display.visualizations.singlevalue.colorBy = value
display.visualizations.singlevalue.colorMode = none
display.visualizations.singlevalue.drilldown = none
display.visualizations.singlevalue.numberPrecision = 0
display.visualizations.singlevalue.rangeColors = ["0x53a051", "0x0877a6", "0xf8be34", "0xf1813f", "0xdc4e41"]
display.visualizations.singlevalue.rangeValues = [0,30,70,100]
display.visualizations.singlevalue.showSparkline = 1
display.visualizations.singlevalue.showTrendIndicator = 1
display.visualizations.singlevalue.trendColorInterpretation = standard
display.visualizations.singlevalue.trendDisplayMode = absolute
display.visualizations.singlevalue.unitPosition = after
display.visualizations.singlevalue.useColors = 0
display.visualizations.singlevalue.useThousandSeparators = 1
display.visualizations.singlevalueHeight = 115
display.visualizations.trellis.enabled = 0
display.visualizations.trellis.scales.shared = 1
display.visualizations.trellis.size = medium
display.visualizations.type = charting
durable.backfill_type = auto
durable.lag_time = 0
durable.max_backfill_intervals = 0
embed.enabled = 0
enableSched = 0
is_visible = 1
max_concurrent = 1
precalculate_required_fields_for_alerts = 1
realtime_schedule = 1
request.ui_dispatch_app = SSPHP_RSD
request.ui_dispatch_view = search
restart_on_searchpeer_add = 1
run_n_times = 0
run_on_startup = 0
schedule_as = auto
schedule_priority = default
schedule_window = auto
search = | makeresults\
| eval ssphp_business_service_index="s184",\
       checkpoint="1677508478",\
       checkpoint_file_name="ssphp_findings_checkpoint_".ssphp_business_service_index."_".checkpoint.".csv"\
| table ssphp_business_service_index, checkpoint, checkpoint_file_name\
| outputlookup createinapp=t append=f ssphp_service_checkpoints.csv
skip_scheduled_realtime_idxc = 0
workload_pool = standard_perf

###############################################################################################################################################################
[ssphp_create_service_findings_checkpoint_csv]
action.cryptolert.param.debug = 1
action.email = 0
action.email.show_password = 1
action.email.useNSSubject = 1
action.populate_lookup = 0
action.rss = 0
action.summary_index = 0
action.summary_index.force_realtime_schedule = 0
action.webhook.enable_allowlist = 1
alert.digest_mode = 1
alert.expires = 24h
alert.severity = 3
alert.track = 0
allow_skew = 12m
auto_summarize = 0
auto_summarize.command = | summarize override=partial timespan=$auto_summarize.timespan$ max_summary_size=$auto_summarize.max_summary_size$ max_summary_ratio=$auto_summarize.max_summary_ratio$ max_disabled_buckets=$auto_summarize.max_disabled_buckets$ max_time=$auto_summarize.max_time$ [ $search$ ]
auto_summarize.cron_schedule = */10 * * * *
auto_summarize.dispatch.time_format = %FT%T.%Q%:z
auto_summarize.dispatch.ttl = 60
auto_summarize.max_concurrent = 1
auto_summarize.max_disabled_buckets = 2
auto_summarize.max_summary_ratio = 0.1
auto_summarize.max_summary_size = 52428800
auto_summarize.max_time = 3600
auto_summarize.suspend_period = 24h
counttype = always
defer_scheduled_searchable_idxc = 0
disabled = 0
dispatch.allow_partial_results = 1
dispatch.auto_cancel = 0
dispatch.auto_pause = 0
dispatch.buckets = 0
dispatch.earliest_time = -30m@m
dispatch.latest_time = now
dispatch.lookups = 1
dispatch.max_count = 500000
dispatch.max_time = 0
dispatch.rate_limit_retry = 0
dispatch.reduce_freq = 10
dispatch.rt_backfill = 0
dispatch.sample_ratio = 1
dispatch.spawn_process = 1
dispatch.time_format = %FT%T.%Q%:z
dispatch.ttl = 2p
dispatchAs = owner
display.events.fields = ["host","source","sourcetype","callerIpAddress","category","correlationId","date_hour","date_mday","date_minute","date_month","date_second","date_wday","date_year","date_zone","durationMs","identity.authorization.action","identity.authorization.evidence.principalId","identity.authorization.evidence.principalType","identity.authorization.evidence.role","identity.authorization.evidence.roleAssignmentId","identity.authorization.evidence.roleAssignmentScope","identity.authorization.evidence.roleDefinitionId","identity.authorization.scope","identity.claims.aio","identity.claims.altsecid","identity.claims.appid","identity.claims.appidacr","identity.claims.aud","identity.claims.exp","identity.claims.groups","identity.claims.http://schemas.microsoft.com/claims/authnclassreference","identity.claims.http://schemas.microsoft.com/claims/authnmethodsreferences","identity.claims.http://schemas.microsoft.com/identity/claims/identityprovider","identity.claims.http://schemas.microsoft.com/identity/claims/objectidentifier","identity.claims.http://schemas.microsoft.com/identity/claims/scope","identity.claims.http://schemas.microsoft.com/identity/claims/tenantid","identity.claims.http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress","identity.claims.http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname","identity.claims.http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name","identity.claims.http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier","identity.claims.http://schemas.xmlsoap.org/ws/2005/05/identity/claims/surname","identity.claims.iat","identity.claims.idtyp","identity.claims.ipaddr","identity.claims.iss","identity.claims.name","identity.claims.nbf","identity.claims.puid","identity.claims.rh","identity.claims.uti","identity.claims.ver","identity.claims.wids","identity.claims.xms_cc","identity.claims.xms_tcdt","index","jobId","jobType","level","linecount","operationName","properties.entity","properties.eventCategory","properties.hierarchy","properties.message","properties.requestbody","properties.responseBody","properties.serviceRequestId","properties.statusCode","punct","ReleaseVersion","resourceId","resultSignature","resultType","RoleLocation","splunk_server","ssphp_contact","ssphp_cost_centre","ssphp_devops_site","ssphp_division","ssphp_division_name","ssphp_environment","ssphp_provider","ssphp_resource_category","ssphp_resource_group","ssphp_resource_id","ssphp_resource_name","ssphp_resource_type","ssphp_service","ssphp_service_id","ssphp_service_name","ssphp_sro","ssphp_subscription","ssphp_technical_contact_email","ssphp_tenant_name","tenantId","time","timeendpos","timestartpos","body.callerIpAddress","body.category","body.correlationId","body.durationMs","body.identity","body.identity.authorization.action","body.identity.authorization.evidence.principalId","body.identity.authorization.evidence.principalType","body.identity.authorization.evidence.role","body.identity.authorization.evidence.roleAssignmentId","body.identity.authorization.evidence.roleAssignmentScope","body.identity.authorization.evidence.roleDefinitionId","body.identity.authorization.scope","body.identity.claims.aio","body.identity.claims.appid","body.identity.claims.appidacr","body.identity.claims.aud","body.identity.claims.exp","body.identity.claims.http://schemas.microsoft.com/identity/claims/identityprovider","body.identity.claims.http://schemas.microsoft.com/identity/claims/objectidentifier","body.identity.claims.http://schemas.microsoft.com/identity/claims/tenantid","body.identity.claims.http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier","body.identity.claims.iat","body.identity.claims.idtyp","body.identity.claims.iss","body.identity.claims.nbf","body.identity.claims.rh","body.identity.claims.uti","body.identity.claims.ver","body.identity.claims.xms_tcdt","body.jobId","body.jobType","body.level","body.Level","body.operationName","body.operationVersion","body.properties.activityDateTime","body.properties.activityDisplayName","body.properties.additionalDetails{}.key","body.properties.additionalDetails{}.value","body.properties.category","body.properties.correlationId","body.properties.entity","body.properties.eventCategory","body.properties.hierarchy","body.properties.id","body.properties.initiatedBy.user.displayName","body.properties.initiatedBy.user.id","body.properties.initiatedBy.user.ipAddress","body.properties.initiatedBy.user.userPrincipalName","body.properties.loggedByService","body.properties.message","body.properties.operationType","body.properties.requestbody","body.properties.result","body.properties.resultReason","body.properties.serviceRequestId","body.properties.statusCode","body.properties.targetResources{}.displayName","body.properties.targetResources{}.groupType","body.properties.targetResources{}.id","body.properties.targetResources{}.modifiedProperties{}.displayName","body.properties.targetResources{}.modifiedProperties{}.newValue","body.properties.targetResources{}.modifiedProperties{}.oldValue","body.properties.targetResources{}.type","body.properties.targetResources{}.userPrincipalName","body.properties.userAgent","body.ReleaseVersion","body.resourceId","body.resultDescription","body.resultSignature","body.resultType","body.RoleLocation","body.tenantId","body.time","eventtype","identity","Level","operationVersion","properties.activityDateTime","properties.activityDisplayName","properties.additionalDetails{}.key","properties.additionalDetails{}.value","properties.category","properties.correlationId","properties.id","properties.initiatedBy.user.displayName","properties.initiatedBy.user.id","properties.initiatedBy.user.ipAddress","properties.initiatedBy.user.userPrincipalName","properties.loggedByService","properties.operationType","properties.result","properties.resultReason","properties.targetResources{}.displayName","properties.targetResources{}.groupType","properties.targetResources{}.id","properties.targetResources{}.modifiedProperties{}.displayName","properties.targetResources{}.modifiedProperties{}.newValue","properties.targetResources{}.modifiedProperties{}.oldValue","properties.targetResources{}.type","properties.targetResources{}.userPrincipalName","properties.userAgent","resultDescription","tag","tag::eventtype","x-opt-enqueued-time","x-opt-offset","x-opt-sequence-number","identity.claim.appid","identity.claim.appidacr","identity.claim.oid","identity.claim.xms_mirid","location","properties.algorithm","properties.appId","properties.appServicePrincipalId","properties.authenticationProcessingDetails{}.key","properties.authenticationProcessingDetails{}.value","properties.authenticationProtocol","properties.CIp","properties.clientCredentialType","properties.clientInfo","properties.ComputerName","properties.conditionalAccessStatus","properties.Cookie","properties.createdDateTime","properties.crossTenantAccessType","properties.CsBytes","properties.CsHost","properties.CsMethod","properties.CsUriQuery","properties.CsUriStem","properties.CsUsername","properties.flaggedForReview","properties.httpStatusCode","properties.incomingTokenType","properties.ipAddress","properties.isAccessPolicyMatch","properties.isInteractive","properties.isTenantRestricted","properties.keyProperties.type","properties.location.city","properties.location.countryOrRegion","properties.location.geoCoordinates.latitude","properties.location.geoCoordinates.longitude","properties.location.state","properties.processingTimeInMilliseconds","properties.Referer","properties.requestUri","properties.resourceDisplayName","properties.resourceId","properties.resourceServicePrincipalId","properties.Result","properties.riskDetail","properties.riskLevelAggregated","properties.riskLevelDuringSignIn","properties.riskState","properties.ScBytes","properties.ScStatus","properties.ScSubStatus","properties.ScWin32Status","properties.servicePrincipalCredentialKeyId","properties.servicePrincipalId","properties.servicePrincipalName","properties.SPort","properties.status.errorCode","properties.TimeTaken","properties.tlsVersion","properties.tokenIssuerType","properties.trustedService","properties.uniqueTokenIdentifier","properties.UserAgent","properties.userId","id","managedBy","name","properties.provisioningState","tags.AntiMalware_MetaData","tags.AntiMalware_PolicyMaster","tags.AntiMalware_PolicySecondary","tags.AntiMalware_Status","tags.app","tags.Build","tags.Contact","tags.Contact Service","tags.ContactTechnical","tags.CostCentre","tags.CreatedBy","tags.DAS Environment","tags.DateProvisioned","tags.Department","tags.Dependencies","tags.DeploymentRepo","tags.DeploymentScript","tags.displayName","tags.Environment","tags.environment","tags.Feature","tags.hidden-DevTestLabs-LabUId","tags.Impact","tags.ms-resource-usage","tags.Name","tags.Organisation","tags.Parent Business","tags.Portfolio","tags.Product","tags.Repository","tags.Role","tags.Service","tags.Service Line","tags.Service Offering","tags.ServiceType","tags.Solution","tags.Subscription","tags.Value","timestamp","type","properties.creationTimeUtc","properties.lastStateChangeTimeUtc","properties.securityTaskParameters.assessmentKey","properties.securityTaskParameters.category","properties.securityTaskParameters.details{}.name","properties.securityTaskParameters.details{}.value","properties.securityTaskParameters.name","properties.securityTaskParameters.policyDefinitionId","properties.securityTaskParameters.policyName","properties.securityTaskParameters.resourceId","properties.securityTaskParameters.resourceType","properties.securityTaskParameters.severity","properties.securityTaskParameters.uniqueKey","properties.state","properties.subState","properties.additionalData.assessedResourceType","properties.additionalData.data.resources","properties.description","properties.displayName","properties.impact","properties.remediation","properties.resourceDetails.id","properties.resourceDetails.source","properties.status.code","properties.status.severity","properties.timeGenerated","created_time_epoch","ssphp_business_service_index","ssphp_subscription_display_name","ssphp_tenant_id","assessment_id","assessment_name","assessment_properties.additionalData.Kind","assessment_properties.displayName","assessment_properties.resourceDetails.Id","assessment_properties.resourceDetails.Source","assessment_properties.status.code","assessment_type","metadata_id","metadata_name","metadata_properties.assessmentType","metadata_properties.categories{}","metadata_properties.description","metadata_properties.displayName","metadata_properties.implementationEffort","metadata_properties.policyDefinitionId","metadata_properties.preview","metadata_properties.remediationDescription","metadata_properties.severity","metadata_properties.threats{}","metadata_properties.userImpact","metadata_type","zz_ak","zz_rid","assessment.id","assessment.meta.assessment_sub_assessments_link","assessment.meta.sub_assessments","assessment.meta.sub_assessments_link_detected","assessment.metadata.id","assessment.metadata.name","assessment.metadata.properties.assessmentType","assessment.metadata.properties.categories{}","assessment.metadata.properties.description","assessment.metadata.properties.displayName","assessment.metadata.properties.implementationEffort","assessment.metadata.properties.policyDefinitionId","assessment.metadata.properties.preview","assessment.metadata.properties.remediationDescription","assessment.metadata.properties.severity","assessment.metadata.properties.threats{}","assessment.metadata.properties.userImpact","assessment.metadata.type","assessment.name","assessment.properties.additionalData.Kind","assessment.properties.additionalData.subAssessmentsLink","assessment.properties.displayName","assessment.properties.resourceDetails.Id","assessment.properties.resourceDetails.Source","assessment.properties.status.cause","assessment.properties.status.code","assessment.properties.status.description","assessment.type","assessments{}.id","assessments{}.meta.assessment_sub_assessments_link","assessments{}.meta.sub_assessments","assessments{}.meta.sub_assessments_link_detected","assessments{}.metadata.id","assessments{}.metadata.name","assessments{}.metadata.properties.assessmentType","assessments{}.metadata.properties.categories{}","assessments{}.metadata.properties.description","assessments{}.metadata.properties.displayName","assessments{}.metadata.properties.implementationEffort","assessments{}.metadata.properties.policyDefinitionId","assessments{}.metadata.properties.preview","assessments{}.metadata.properties.remediationDescription","assessments{}.metadata.properties.severity","assessments{}.metadata.properties.threats{}","assessments{}.metadata.properties.userImpact","assessments{}.metadata.type","assessments{}.name","assessments{}.properties.additionalData.Kind","assessments{}.properties.additionalData.OS Type","assessments{}.properties.additionalData.subAssessmentsLink","assessments{}.properties.displayName","assessments{}.properties.resourceDetails.Id","assessments{}.properties.resourceDetails.Source","assessments{}.properties.status.cause","assessments{}.properties.status.code","assessments{}.properties.status.description","assessments{}.type","ssphp_assessment_id","ssphp_assessment_metadata_id","ssphp_category","ssphp_creation_time","ssphp_creation_time_epoch","ssphp_event_time","ssphp_last_changed_time","ssphp_last_changed_time_epoch","ssphp_parent_business","ssphp_policy_name","ssphp_portfolio","ssphp_remediation_description","SSPHP_RUN","ssphp_run","ssphp_service_team","ssphp_severity","ssphp_state","ssphp_status_code","ssphp_task_id","ssphp_tech_contact_email","ssphp_threats","task.id","task.meta.details","task.meta.task_sub_assessments_link_detected","task.name","task.properties.creationTimeUtc","task.properties.lastStateChangeTimeUtc","task.properties.securityTaskParameters.assessmentKey","task.properties.securityTaskParameters.category","task.properties.securityTaskParameters.details{}.name","task.properties.securityTaskParameters.details{}.value","task.properties.securityTaskParameters.name","task.properties.securityTaskParameters.policyDefinitionId","task.properties.securityTaskParameters.policyName","task.properties.securityTaskParameters.resourceId","task.properties.securityTaskParameters.resourceType","task.properties.securityTaskParameters.severity","task.properties.securityTaskParameters.uniqueKey","task.properties.state","task.properties.subState","task.type","assessments{}.additional_data.Kind","assessments{}.additional_data.subAssessmentsLink","assessments{}.additional_data.usersWithNoMfaObjectIdList","assessments{}.display_name","assessments{}.status.cause","assessments{}.status.code","assessments{}.status.description","assessments{}.status.first_evaluation_date","assessments{}.status.status_change_date","meta.child_name_1","meta.child_name_2","meta.child_namespace_1","meta.child_namespace_2","meta.child_parent_1","meta.child_parent_2","meta.child_type_1","meta.child_type_2","meta.children","meta.last_child_num","meta.name","meta.namespace","meta.resource_group","meta.resource_name","meta.resource_namespace","meta.resource_parent","meta.resource_type","meta.subscription","meta.type","task.creation_time_utc","task.last_state_change_time_utc","task.security_task_parameters.assessmentKey","task.security_task_parameters.category","task.security_task_parameters.name","task.security_task_parameters.policyDefinitionId","task.security_task_parameters.policyName","task.security_task_parameters.resourceId","task.security_task_parameters.resourceType","task.security_task_parameters.severity","task.security_task_parameters.uniqueKey","task.state","task.sub_state","aa","assessment.properties.metadata.id","assessment.properties.metadata.name","assessment.properties.metadata.properties.assessmentType","assessment.properties.metadata.properties.categories{}","assessment.properties.metadata.properties.description","assessment.properties.metadata.properties.displayName","assessment.properties.metadata.properties.implementationEffort","assessment.properties.metadata.properties.policyDefinitionId","assessment.properties.metadata.properties.preview","assessment.properties.metadata.properties.publishDates.public","assessment.properties.metadata.properties.remediationDescription","assessment.properties.metadata.properties.severity","assessment.properties.metadata.properties.tactics{}","assessment.properties.metadata.properties.techniques{}","assessment.properties.metadata.properties.threats{}","assessment.properties.metadata.properties.userImpact","assessment.properties.metadata.type","assessment.properties.status.firstEvaluationDate","assessment.properties.status.statusChangeDate","meta.assessment.child_name_1","meta.assessment.child_name_2","meta.assessment.child_namespace_1","meta.assessment.child_namespace_2","meta.assessment.child_parent_1","meta.assessment.child_parent_2","meta.assessment.child_type_1","meta.assessment.child_type_2","meta.assessment.children","meta.assessment.last_child_num","meta.assessment.name","meta.assessment.namespace","meta.assessment.resource_group","meta.assessment.resource_name","meta.assessment.resource_namespace","meta.assessment.resource_parent","meta.assessment.resource_type","meta.assessment.subscription","meta.assessment.type","meta.task.child_name_1","meta.task.child_parent_1","meta.task.child_type_1","meta.task.children","meta.task.last_child_num","meta.task.name","meta.task.namespace","meta.task.resource_group","meta.task.resource_name","meta.task.resource_namespace","meta.task.resource_parent","meta.task.resource_type","meta.task.subscription","meta.task.type","ssphp_meta_affected_resource","task.properties.securityTaskParameters.baselineCceId","task.properties.securityTaskParameters.baselineName","task.properties.securityTaskParameters.baselineRuleId","task.properties.securityTaskParameters.osName","task.properties.securityTaskParameters.ruleType","task.properties.securityTaskParameters.subscriptionId","task.properties.securityTaskParameters.totalNumberOfDefectedMachines","task.properties.securityTaskParameters.workspaces{}.serverCount","task.properties.securityTaskParameters.workspaces{}.workspaceId"]
display.events.list.drilldown = full
display.events.list.wrap = 1
display.events.maxLines = 5
display.events.raw.drilldown = full
display.events.rowNumbers = 0
display.events.table.drilldown = 1
display.events.table.wrap = 1
display.events.type = list
display.general.enablePreview = 1
display.general.migratedFromViewState = 0
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.mode = verbose
display.page.search.patterns.sensitivity = 0.8
display.page.search.showFields = 1
display.page.search.tab = statistics
display.page.search.timeline.format = compact
display.page.search.timeline.scale = linear
display.statistics.drilldown = cell
display.statistics.overlay = none
display.statistics.percentagesRow = 0
display.statistics.rowNumbers = 0
display.statistics.show = 1
display.statistics.totalsRow = 0
display.statistics.wrap = 1
display.visualizations.chartHeight = 300
display.visualizations.charting.axisLabelsX.majorLabelStyle.overflowMode = ellipsisNone
display.visualizations.charting.axisLabelsX.majorLabelStyle.rotation = 0
display.visualizations.charting.axisTitleX.visibility = visible
display.visualizations.charting.axisTitleY.visibility = visible
display.visualizations.charting.axisTitleY2.visibility = visible
display.visualizations.charting.axisX.abbreviation = none
display.visualizations.charting.axisX.scale = linear
display.visualizations.charting.axisY.abbreviation = none
display.visualizations.charting.axisY.scale = linear
display.visualizations.charting.axisY2.abbreviation = none
display.visualizations.charting.axisY2.enabled = 0
display.visualizations.charting.axisY2.scale = inherit
display.visualizations.charting.chart = column
display.visualizations.charting.chart.bubbleMaximumSize = 50
display.visualizations.charting.chart.bubbleMinimumSize = 10
display.visualizations.charting.chart.bubbleSizeBy = area
display.visualizations.charting.chart.nullValueMode = gaps
display.visualizations.charting.chart.showDataLabels = none
display.visualizations.charting.chart.sliceCollapsingThreshold = 0.01
display.visualizations.charting.chart.stackMode = default
display.visualizations.charting.chart.style = shiny
display.visualizations.charting.drilldown = all
display.visualizations.charting.layout.splitSeries = 0
display.visualizations.charting.layout.splitSeries.allowIndependentYRanges = 0
display.visualizations.charting.legend.labelStyle.overflowMode = ellipsisMiddle
display.visualizations.charting.legend.mode = standard
display.visualizations.charting.legend.placement = right
display.visualizations.charting.lineWidth = 2
display.visualizations.custom.drilldown = all
display.visualizations.custom.type = treemap_app.treemap
display.visualizations.mapHeight = 400
display.visualizations.mapping.choroplethLayer.colorBins = 5
display.visualizations.mapping.choroplethLayer.colorMode = auto
display.visualizations.mapping.choroplethLayer.maximumColor = 0xaf575a
display.visualizations.mapping.choroplethLayer.minimumColor = 0x62b3b2
display.visualizations.mapping.choroplethLayer.neutralPoint = 0
display.visualizations.mapping.choroplethLayer.shapeOpacity = 0.75
display.visualizations.mapping.choroplethLayer.showBorder = 1
display.visualizations.mapping.data.maxClusters = 100
display.visualizations.mapping.drilldown = all
display.visualizations.mapping.legend.placement = bottomright
display.visualizations.mapping.map.center = (0,0)
display.visualizations.mapping.map.panning = 1
display.visualizations.mapping.map.scrollZoom = 0
display.visualizations.mapping.map.zoom = 2
display.visualizations.mapping.markerLayer.markerMaxSize = 50
display.visualizations.mapping.markerLayer.markerMinSize = 10
display.visualizations.mapping.markerLayer.markerOpacity = 0.8
display.visualizations.mapping.showTiles = 1
display.visualizations.mapping.tileLayer.maxZoom = 7
display.visualizations.mapping.tileLayer.minZoom = 0
display.visualizations.mapping.tileLayer.tileOpacity = 1
display.visualizations.mapping.type = marker
display.visualizations.show = 0
display.visualizations.singlevalue.colorBy = value
display.visualizations.singlevalue.colorMode = none
display.visualizations.singlevalue.drilldown = none
display.visualizations.singlevalue.numberPrecision = 0
display.visualizations.singlevalue.rangeColors = ["0x53a051", "0x0877a6", "0xf8be34", "0xf1813f", "0xdc4e41"]
display.visualizations.singlevalue.rangeValues = [0,30,70,100]
display.visualizations.singlevalue.showSparkline = 1
display.visualizations.singlevalue.showTrendIndicator = 1
display.visualizations.singlevalue.trendColorInterpretation = standard
display.visualizations.singlevalue.trendDisplayMode = absolute
display.visualizations.singlevalue.unitPosition = after
display.visualizations.singlevalue.useColors = 0
display.visualizations.singlevalue.useThousandSeparators = 1
display.visualizations.singlevalueHeight = 115
display.visualizations.trellis.enabled = 0
display.visualizations.trellis.scales.shared = 1
display.visualizations.trellis.size = medium
display.visualizations.type = charting
durable.backfill_type = auto
durable.lag_time = 0
durable.max_backfill_intervals = 0
embed.enabled = 0
enableSched = 0
is_visible = 1
max_concurrent = 1
precalculate_required_fields_for_alerts = 1
realtime_schedule = 1
request.ui_dispatch_app = SSPHP_RSD
request.ui_dispatch_view = search
restart_on_searchpeer_add = 1
run_n_times = 0
run_on_startup = 0
schedule_as = auto
schedule_priority = default
schedule_window = auto
search = index="ssphp_test" sourcetype="azure:security:finding" host="c113p01-splhf04" source="azure_cloud_defender"\
   ssphp_business_service_index="s184"\
   [| makeresults\
    | eval SSPHP_RUN="1677508478",\
           earliest=SSPHP_RUN-1000,\
           latest=SSPHP_RUN+2000,\
           search_text="SSPHP_RUN=\"".SSPHP_RUN."\" earliest=".earliest." latest=".latest." "\
    | return $search_text]\
\
| eval finding=coalesce(ssphp_sub_assessment_id,ssphp_assessment_id)\
| table finding, ssphp_status\
```| append\
    [makeresults\
    | eval finding="small test",ssphp_status="Healthy"\
    | table finding, ssphp_status]```\
| outputlookup createinapp=t append=f ssphp_findings_checkpoint_s184_1677508478.csv
skip_scheduled_realtime_idxc = 0
workload_pool = standard_perf